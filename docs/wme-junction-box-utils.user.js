// ==UserScript==
// @name WME Junction Box Utils
// @description Formerly known as "Roundabout JB". An enhancement add-on for the WME with a wide variety of capabilities for controlling and managing Junction Boxes.
// @version 2.1.0
// @author r0den
// @match https://*.waze.com/*editor*
// @match https://waze.com/*editor*
// @match https://*.wazestg.com/*editor*
// @connect distributions.crowdin.net
// @grant GM_setValue
// @grant GM_getValue
// @grant GM_deleteValue
// @grant GM_xmlhttpRequest
// ==/UserScript==

/*! For license information please see wme-junction-box-utils.user.js.LICENSE.txt */
(()=>{var webpackQueues,webpackExports,webpackError,resolveQueue,__webpack_modules__={73:(module,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,(async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{var _utils_get_wme_window__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(334);function waitForEvent(node,eventName,skip=!1){return skip?Promise.resolve():new Promise((resolve=>{node.addEventListener(eventName,(()=>resolve(void 0)),{once:!0})}))}await waitForEvent(document,"wme-initialized",(0,_utils_get_wme_window__WEBPACK_IMPORTED_MODULE_0__.B)().W?.userscripts?.state?.isInitialized),Promise.resolve().then(__webpack_require__.bind(__webpack_require__,179)).then((({default:bootstrap})=>bootstrap())),__webpack_async_result__()}catch(e){__webpack_async_result__(e)}}),1)},179:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>bootstrap});var common_utils_namespaceObject={};__webpack_require__.r(common_utils_namespaceObject),__webpack_require__.d(common_utils_namespaceObject,{hasBrowserEnv:()=>hasBrowserEnv,hasStandardBrowserEnv:()=>hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv:()=>hasStandardBrowserWebWorkerEnv});__webpack_require__(783);const external_window_ReactDOM_unsafeWindow_ReactDOM_namespaceObject=window.ReactDOM||unsafeWindow.ReactDOM;var external_window_ReactDOM_unsafeWindow_ReactDOM_default=__webpack_require__.n(external_window_ReactDOM_unsafeWindow_ReactDOM_namespaceObject);const defaultPreferences={master_disable:!1,prefs_location:"tab",roundabout:{clone_geometry:"ask",instruction_normalization:{applied_instruction_badge_type:"graphical"}},auto_backup:!1},PREFERENCES_LS_KEY="r0den.userscripts.jbu.prefs",KEY_DELIMITER=".";const ACTION_TYPE_TO_REDUCER_MAP={"set-preference":function(state,action){const newValue="function"==typeof action.value?action.value(state[action.key]):action.value;return function(obj,key,value){const keyComponents=key.split(KEY_DELIMITER);return obj=structuredClone(obj),keyComponents.reduce(((acc,keyComponent,index,array)=>(acc[keyComponent]=acc[keyComponent]||{},index===array.length-1&&(acc[keyComponent]=value),acc[keyComponent])),obj),obj}(state,action.key,newValue)}};function preferencesReducer(prevState,action){return function(actionType){if(!ACTION_TYPE_TO_REDUCER_MAP.hasOwnProperty(actionType))throw new Error(`Action type of "${actionType}" is not supported.`);return ACTION_TYPE_TO_REDUCER_MAP[actionType]}(action.type)(prevState,action)}function mergeDeep(target,source){const isObject=obj=>obj&&"object"==typeof obj;return isObject(target)&&isObject(source)?(Object.keys(source).forEach((key=>{const targetValue=target[key],sourceValue=source[key];Array.isArray(targetValue)&&Array.isArray(sourceValue)?target[key]=targetValue.concat(sourceValue):isObject(targetValue)&&isObject(sourceValue)?target[key]=mergeDeep(Object.assign({},targetValue),sourceValue):target[key]=sourceValue})),target):source}var external_window_React_unsafeWindow_React_=__webpack_require__(149),external_window_React_unsafeWindow_React_default=__webpack_require__.n(external_window_React_unsafeWindow_React_);__webpack_require__(889);var useIsomorphicLayoutEffect="undefined"!=typeof window?external_window_React_unsafeWindow_React_.useLayoutEffect:external_window_React_unsafeWindow_React_.useEffect;function useEventListener(eventName,handler,element,options){const savedHandler=(0,external_window_React_unsafeWindow_React_.useRef)(handler);useIsomorphicLayoutEffect((()=>{savedHandler.current=handler}),[handler]),(0,external_window_React_unsafeWindow_React_.useEffect)((()=>{const targetElement=(null==element?void 0:element.current)??window;if(!targetElement||!targetElement.addEventListener)return;const listener=event=>{savedHandler.current(event)};return targetElement.addEventListener(eventName,listener,options),()=>{targetElement.removeEventListener(eventName,listener,options)}}),[eventName,element,options])}function useEventCallback(fn){const ref=(0,external_window_React_unsafeWindow_React_.useRef)((()=>{throw new Error("Cannot call an event handler while rendering.")}));return useIsomorphicLayoutEffect((()=>{ref.current=fn}),[fn]),(0,external_window_React_unsafeWindow_React_.useCallback)(((...args)=>ref.current(...args)),[ref])}var IS_SERVER="undefined"==typeof window;function useLocalStorage(key,initialValue,options={}){const{initializeWithValue=!0}=options,serializer=(0,external_window_React_unsafeWindow_React_.useCallback)((value=>options.serializer?options.serializer(value):JSON.stringify(value)),[options]),deserializer=(0,external_window_React_unsafeWindow_React_.useCallback)((value=>{if(options.deserializer)return options.deserializer(value);if("undefined"===value)return;const defaultValue=initialValue instanceof Function?initialValue():initialValue;let parsed;try{parsed=JSON.parse(value)}catch(error){return console.error("Error parsing JSON:",error),defaultValue}return parsed}),[options,initialValue]),readValue=(0,external_window_React_unsafeWindow_React_.useCallback)((()=>{const initialValueToUse=initialValue instanceof Function?initialValue():initialValue;if(IS_SERVER)return initialValueToUse;try{const raw=window.localStorage.getItem(key);return raw?deserializer(raw):initialValueToUse}catch(error){return console.warn(`Error reading localStorage key “${key}”:`,error),initialValueToUse}}),[initialValue,key,deserializer]),[storedValue,setStoredValue]=(0,external_window_React_unsafeWindow_React_.useState)((()=>initializeWithValue?readValue():initialValue instanceof Function?initialValue():initialValue)),setValue=useEventCallback((value=>{IS_SERVER&&console.warn(`Tried setting localStorage key “${key}” even though environment is not a client`);try{const newValue=value instanceof Function?value(readValue()):value;window.localStorage.setItem(key,serializer(newValue)),setStoredValue(newValue),window.dispatchEvent(new StorageEvent("local-storage",{key}))}catch(error){console.warn(`Error setting localStorage key “${key}”:`,error)}}));(0,external_window_React_unsafeWindow_React_.useEffect)((()=>{setStoredValue(readValue())}),[key]);const handleStorageChange=(0,external_window_React_unsafeWindow_React_.useCallback)((event=>{(null==event?void 0:event.key)&&event.key!==key||setStoredValue(readValue())}),[key,readValue]);return useEventListener("storage",handleStorageChange),useEventListener("local-storage",handleStorageChange),[storedValue,setValue]}function useUnmount(func){const funcRef=(0,external_window_React_unsafeWindow_React_.useRef)(func);funcRef.current=func,(0,external_window_React_unsafeWindow_React_.useEffect)((()=>()=>{funcRef.current()}),[])}function usePreferences(){const[prefs,setRawPrefs]=useLocalStorage(PREFERENCES_LS_KEY,defaultPreferences,{serializer:value=>JSON.stringify(value),deserializer(rawValue){const value=JSON.parse(rawValue);return mergeDeep(structuredClone(defaultPreferences),value)}});return[prefs,action=>{setRawPrefs((prevState=>preferencesReducer(prevState,action)))}]}function usePreference(key){const[preferences,dispatch]=usePreferences(),preferenceValue=(0,external_window_React_unsafeWindow_React_.useMemo)((()=>function(obj,key){return key.split(KEY_DELIMITER).reduce(((nestedObj,keyComponent)=>{if(nestedObj&&nestedObj.hasOwnProperty(keyComponent))return nestedObj[keyComponent]}),obj)}(preferences,key)),[preferences,key]);return[preferenceValue,setStateAction=>dispatch(function(key,value){return{type:"set-preference",key,value}}(key,setStateAction))]}var get_wme_window=__webpack_require__(334);function useTranslate(){const{I18n}=(0,get_wme_window.B)();return I18n.t}function isAddBigJunctionAction(action){return"ADD_BIG_JUNCTION"===action.actionName}function getTurnSegmentsByBigJunction(bigJunction,turnToSegmentIdMapper){const segmentIds=function(arr,predicate){const cb="function"==typeof predicate?predicate:o=>o[predicate];return[...arr.reduce(((map,item)=>{const key=null==item?item:cb(item);return map.has(key)||map.set(key,item),map}),new Map).values()]}(bigJunction.getShortestTurns(bigJunction.model),turnToSegmentIdMapper).map(turnToSegmentIdMapper),segments=bigJunction.model.segments.getByIds(segmentIds);if(segments.length<segmentIds.length)throw new Error("One or more turn segments don't exist");return segments}const Action=(0,get_wme_window.B)().require("Waze/Action/UpdateObject").__proto__;(0,get_wme_window.B)().require("Waze/Action/CreateObject");function isCreateObjectAction(action){return"CREATE_OBJECT"===action.actionName}function getAllJunctionSegments(junction){return junction.model.getRepository("segment").getByIds(junction.getSegmentsIds())}let WazeMapEditorEntityType=function(WazeMapEditorEntityType){return WazeMapEditorEntityType.BigJunction="bigJunction",WazeMapEditorEntityType.City="city",WazeMapEditorEntityType.Country="country",WazeMapEditorEntityType.EditSuggestion="editSuggestion",WazeMapEditorEntityType.HouseNumber="houseNumber",WazeMapEditorEntityType.Junction="junction",WazeMapEditorEntityType.ManagedArea="managedArea",WazeMapEditorEntityType.MapComment="mapComment",WazeMapEditorEntityType.MapProblem="mapProblem",WazeMapEditorEntityType.MajorTrafficEvent="majorTrafficEvent",WazeMapEditorEntityType.Node="node",WazeMapEditorEntityType.OnlineEditor="onlineEditor",WazeMapEditorEntityType.PermanentHazard="permanentHazard",WazeMapEditorEntityType.ProblemDetails="problemDetail",WazeMapEditorEntityType.RailroadCrossing="railroadCrossing",WazeMapEditorEntityType.RestrictedDrivingArea="restrictedDrivingArea",WazeMapEditorEntityType.RestrictedEditingArea="restrictedEditingArea",WazeMapEditorEntityType.RoadClosure="roadClosure",WazeMapEditorEntityType.Segment="segment",WazeMapEditorEntityType.SegmentSuggestion="segmentSuggestion",WazeMapEditorEntityType.SignType="signType",WazeMapEditorEntityType.SpeedCamera="camera",WazeMapEditorEntityType.State="state",WazeMapEditorEntityType.Street="street",WazeMapEditorEntityType.TurnClosure="turnClosure",WazeMapEditorEntityType.UpdateRequest="mapUpdateRequest",WazeMapEditorEntityType.UpdateRequestSession="updateRequestSession",WazeMapEditorEntityType.User="user",WazeMapEditorEntityType.UserArea="userArea",WazeMapEditorEntityType.Venue="venue",WazeMapEditorEntityType}({});function getJunctionNodeFromSegmentDirection(segment,direction){const nodeId=segment.getAttribute("forward"===direction?"toNodeID":"fromNodeID");return segment.model.getRepository(WazeMapEditorEntityType.Node).getObjectById(nodeId)}function isSegmentConnectsToRoundabout(segment,direction="any"){if(segment.isInRoundabout())return!1;if("any"===direction)return isSegmentConnectsToRoundabout(segment,"forward")||isSegmentConnectsToRoundabout(segment,"reverse");return function(node){const segmentIds=node.getSegmentIds();return node.model.getRepository(WazeMapEditorEntityType.Segment).getByIds(segmentIds).some((segment=>segment.isInRoundabout()))}(getJunctionNodeFromSegmentDirection(segment,direction))}function isSegmentDirectionAllowed(segment,direction){return segment.getAttribute("forward"===direction?"fwdDirection":"revDirection")}function getSegmentGeometryForDirection(segment,direction){const{coordinates}=segment.getAttribute("geoJSONGeometry"),clonedCoordinates=structuredClone(coordinates);return"forward"===direction?clonedCoordinates:clonedCoordinates.reverse()}function getSegmentTravelDirection(segment){if(function(segment){return segment.getAttribute("fwdDirection")&&segment.getAttribute("revDirection")}(segment))throw new Error("Travel direction is not available for bidirectional segments");if(segment.getAttribute("fwdDirection"))return"forward";if(segment.getAttribute("revDirection"))return"reverse";throw new Error("Travel direction is not available probably due to a data model structure error")}function getSegmentGeometryInTravelDirection(segment){return getSegmentGeometryForDirection(segment,getSegmentTravelDirection(segment))}function getSegmentDestinationNodeInTravelDirection(segment){return getJunctionNodeFromSegmentDirection(segment,getSegmentTravelDirection(segment))}function getSegmentFromNodeInTravelDirection(segment){return getJunctionNodeFromSegmentDirection(segment,"forward"===getSegmentTravelDirection(segment)?"reverse":"forward")}var earthRadius=6371008.8,factors={centimeters:100*earthRadius,centimetres:100*earthRadius,degrees:earthRadius/111325,feet:3.28084*earthRadius,inches:39.37*earthRadius,kilometers:earthRadius/1e3,kilometres:earthRadius/1e3,meters:earthRadius,metres:earthRadius,miles:earthRadius/1609.344,millimeters:1e3*earthRadius,millimetres:1e3*earthRadius,nauticalmiles:earthRadius/1852,radians:1,yards:1.0936*earthRadius};function es_feature(geom,properties,options){void 0===options&&(options={});var feat={type:"Feature"};return(0===options.id||options.id)&&(feat.id=options.id),options.bbox&&(feat.bbox=options.bbox),feat.properties=properties||{},feat.geometry=geom,feat}function es_point(coordinates,properties,options){if(void 0===options&&(options={}),!coordinates)throw new Error("coordinates is required");if(!Array.isArray(coordinates))throw new Error("coordinates must be an Array");if(coordinates.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!es_isNumber(coordinates[0])||!es_isNumber(coordinates[1]))throw new Error("coordinates must contain numbers");return es_feature({type:"Point",coordinates},properties,options)}function polygon(coordinates,properties,options){void 0===options&&(options={});for(var _i=0,coordinates_1=coordinates;_i<coordinates_1.length;_i++){var ring=coordinates_1[_i];if(ring.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var j=0;j<ring[ring.length-1].length;j++)if(ring[ring.length-1][j]!==ring[0][j])throw new Error("First and last Position are not equivalent.")}return es_feature({type:"Polygon",coordinates},properties,options)}function lengthToRadians(distance,units){void 0===units&&(units="kilometers");var factor=factors[units];if(!factor)throw new Error(units+" units is invalid");return distance/factor}function radiansToDegrees(radians){return 180*(radians%(2*Math.PI))/Math.PI}function degreesToRadians(degrees){return degrees%360*Math.PI/180}function convertLength(length,originalUnit,finalUnit){if(void 0===originalUnit&&(originalUnit="kilometers"),void 0===finalUnit&&(finalUnit="kilometers"),!(length>=0))throw new Error("length must be a positive number");return function(radians,units){void 0===units&&(units="kilometers");var factor=factors[units];if(!factor)throw new Error(units+" units is invalid");return radians*factor}(lengthToRadians(length,originalUnit),finalUnit)}function es_isNumber(num){return!isNaN(num)&&null!==num&&!Array.isArray(num)}function extractRoundaboutPerimeterPolygon(junction){return function(segments){const coordinates=[];let segment=segments[0],visitedSegments=0;for(;visitedSegments++<segments.length;){const[firstGeometryNode,...restGeometryNodes]=getSegmentGeometryInTravelDirection(segment);coordinates.length||coordinates.push(firstGeometryNode),coordinates.push(...restGeometryNodes);const node=getSegmentDestinationNodeInTravelDirection(segment);segment=segments.find((segment=>getSegmentFromNodeInTravelDirection(segment)===node))}return coordinates[0][0]===coordinates[coordinates.length-1][0]&&coordinates[0][1]===coordinates[coordinates.length-1][1]||coordinates.push(coordinates[0]),polygon([coordinates]).geometry}(getAllJunctionSegments(junction))}function cloneFeature(geojson){var cloned={type:"Feature"};return Object.keys(geojson).forEach((function(key){switch(key){case"type":case"properties":case"geometry":return;default:cloned[key]=geojson[key]}})),cloned.properties=cloneProperties(geojson.properties),cloned.geometry=cloneGeometry(geojson.geometry),cloned}function cloneProperties(properties){var cloned={};return properties?(Object.keys(properties).forEach((function(key){var value=properties[key];"object"==typeof value?null===value?cloned[key]=null:Array.isArray(value)?cloned[key]=value.map((function(item){return item})):cloned[key]=cloneProperties(value):cloned[key]=value})),cloned):cloned}function cloneGeometry(geometry){var geom={type:geometry.type};return geometry.bbox&&(geom.bbox=geometry.bbox),"GeometryCollection"===geometry.type?(geom.geometries=geometry.geometries.map((function(g){return cloneGeometry(g)})),geom):(geom.coordinates=deepSlice(geometry.coordinates),geom)}function deepSlice(coords){var cloned=coords;return"object"!=typeof cloned[0]?cloned.slice():cloned.map((function(coord){return deepSlice(coord)}))}const es=function(geojson){if(!geojson)throw new Error("geojson is required");switch(geojson.type){case"Feature":return cloneFeature(geojson);case"FeatureCollection":return function(geojson){var cloned={type:"FeatureCollection"};return Object.keys(geojson).forEach((function(key){switch(key){case"type":case"features":return;default:cloned[key]=geojson[key]}})),cloned.features=geojson.features.map((function(feature){return cloneFeature(feature)})),cloned}(geojson);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return cloneGeometry(geojson);default:throw new Error("unknown GeoJSON type")}};function coordEach(geojson,callback,excludeWrapCoord){if(null!==geojson)for(var j,k,l,geometry,stopG,coords,geometryMaybeCollection,isGeometryCollection,wrapShrink=0,coordIndex=0,type=geojson.type,isFeatureCollection="FeatureCollection"===type,isFeature="Feature"===type,stop=isFeatureCollection?geojson.features.length:1,featureIndex=0;featureIndex<stop;featureIndex++){stopG=(isGeometryCollection=!!(geometryMaybeCollection=isFeatureCollection?geojson.features[featureIndex].geometry:isFeature?geojson.geometry:geojson)&&"GeometryCollection"===geometryMaybeCollection.type)?geometryMaybeCollection.geometries.length:1;for(var geomIndex=0;geomIndex<stopG;geomIndex++){var multiFeatureIndex=0,geometryIndex=0;if(null!==(geometry=isGeometryCollection?geometryMaybeCollection.geometries[geomIndex]:geometryMaybeCollection)){coords=geometry.coordinates;var geomType=geometry.type;switch(wrapShrink=!excludeWrapCoord||"Polygon"!==geomType&&"MultiPolygon"!==geomType?0:1,geomType){case null:break;case"Point":if(!1===callback(coords,coordIndex,featureIndex,multiFeatureIndex,geometryIndex))return!1;coordIndex++,multiFeatureIndex++;break;case"LineString":case"MultiPoint":for(j=0;j<coords.length;j++){if(!1===callback(coords[j],coordIndex,featureIndex,multiFeatureIndex,geometryIndex))return!1;coordIndex++,"MultiPoint"===geomType&&multiFeatureIndex++}"LineString"===geomType&&multiFeatureIndex++;break;case"Polygon":case"MultiLineString":for(j=0;j<coords.length;j++){for(k=0;k<coords[j].length-wrapShrink;k++){if(!1===callback(coords[j][k],coordIndex,featureIndex,multiFeatureIndex,geometryIndex))return!1;coordIndex++}"MultiLineString"===geomType&&multiFeatureIndex++,"Polygon"===geomType&&geometryIndex++}"Polygon"===geomType&&multiFeatureIndex++;break;case"MultiPolygon":for(j=0;j<coords.length;j++){for(geometryIndex=0,k=0;k<coords[j].length;k++){for(l=0;l<coords[j][k].length-wrapShrink;l++){if(!1===callback(coords[j][k][l],coordIndex,featureIndex,multiFeatureIndex,geometryIndex))return!1;coordIndex++}geometryIndex++}multiFeatureIndex++}break;case"GeometryCollection":for(j=0;j<geometry.geometries.length;j++)if(!1===coordEach(geometry.geometries[j],callback,excludeWrapCoord))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function featureEach(geojson,callback){if("Feature"===geojson.type)callback(geojson,0);else if("FeatureCollection"===geojson.type)for(var i=0;i<geojson.features.length&&!1!==callback(geojson.features[i],i);i++);}function bbox(geojson){var result=[1/0,1/0,-1/0,-1/0];return coordEach(geojson,(function(coord){result[0]>coord[0]&&(result[0]=coord[0]),result[1]>coord[1]&&(result[1]=coord[1]),result[2]<coord[0]&&(result[2]=coord[0]),result[3]<coord[1]&&(result[3]=coord[1])})),result}bbox.default=bbox;const dist_es=bbox;const center_dist_es=function(geojson,options){void 0===options&&(options={});var ext=dist_es(geojson);return es_point([(ext[0]+ext[2])/2,(ext[1]+ext[3])/2],options.properties,options)};const centroid_dist_es=function(geojson,options){void 0===options&&(options={});var xSum=0,ySum=0,len=0;return coordEach(geojson,(function(coord){xSum+=coord[0],ySum+=coord[1],len++}),!0),es_point([xSum/len,ySum/len],options.properties)};function getCoord(coord){if(!coord)throw new Error("coord is required");if(!Array.isArray(coord)){if("Feature"===coord.type&&null!==coord.geometry&&"Point"===coord.geometry.type)return coord.geometry.coordinates;if("Point"===coord.type)return coord.coordinates}if(Array.isArray(coord)&&coord.length>=2&&!Array.isArray(coord[0])&&!Array.isArray(coord[1]))return coord;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function getType(geojson,_name){return"FeatureCollection"===geojson.type?"FeatureCollection":"GeometryCollection"===geojson.type?"GeometryCollection":"Feature"===geojson.type&&null!==geojson.geometry?geojson.geometry.type:geojson.type}function calculateRhumbBearing(from,to){var phi1=degreesToRadians(from[1]),phi2=degreesToRadians(to[1]),deltaLambda=degreesToRadians(to[0]-from[0]);deltaLambda>Math.PI&&(deltaLambda-=2*Math.PI),deltaLambda<-Math.PI&&(deltaLambda+=2*Math.PI);var deltaPsi=Math.log(Math.tan(phi2/2+Math.PI/4)/Math.tan(phi1/2+Math.PI/4));return(radiansToDegrees(Math.atan2(deltaLambda,deltaPsi))+360)%360}const rhumb_bearing_dist_es=function(start,end,options){var bear360;return void 0===options&&(options={}),(bear360=options.final?calculateRhumbBearing(getCoord(end),getCoord(start)):calculateRhumbBearing(getCoord(start),getCoord(end)))>180?-(360-bear360):bear360};const rhumb_distance_dist_es=function(from,to,options){void 0===options&&(options={});var origin=getCoord(from),destination=getCoord(to);return destination[0]+=destination[0]-origin[0]>180?-360:origin[0]-destination[0]>180?360:0,convertLength(function(origin,destination,radius){var R=radius=void 0===radius?earthRadius:Number(radius),phi1=origin[1]*Math.PI/180,phi2=destination[1]*Math.PI/180,DeltaPhi=phi2-phi1,DeltaLambda=Math.abs(destination[0]-origin[0])*Math.PI/180;DeltaLambda>Math.PI&&(DeltaLambda-=2*Math.PI);var DeltaPsi=Math.log(Math.tan(phi2/2+Math.PI/4)/Math.tan(phi1/2+Math.PI/4)),q=Math.abs(DeltaPsi)>1e-11?DeltaPhi/DeltaPsi:Math.cos(phi1);return Math.sqrt(DeltaPhi*DeltaPhi+q*q*DeltaLambda*DeltaLambda)*R}(origin,destination),"meters",options.units)};const rhumb_destination_dist_es=function(origin,distance,bearing,options){void 0===options&&(options={});var wasNegativeDistance=distance<0,distanceInMeters=convertLength(Math.abs(distance),options.units,"meters");wasNegativeDistance&&(distanceInMeters=-Math.abs(distanceInMeters));var coords=getCoord(origin),destination=function(origin,distance,bearing,radius){radius=void 0===radius?earthRadius:Number(radius);var delta=distance/radius,lambda1=origin[0]*Math.PI/180,phi1=degreesToRadians(origin[1]),theta=degreesToRadians(bearing),DeltaPhi=delta*Math.cos(theta),phi2=phi1+DeltaPhi;Math.abs(phi2)>Math.PI/2&&(phi2=phi2>0?Math.PI-phi2:-Math.PI-phi2);var DeltaPsi=Math.log(Math.tan(phi2/2+Math.PI/4)/Math.tan(phi1/2+Math.PI/4)),q=Math.abs(DeltaPsi)>1e-11?DeltaPhi/DeltaPsi:Math.cos(phi1),DeltaLambda=delta*Math.sin(theta)/q;return[(180*(lambda1+DeltaLambda)/Math.PI+540)%360-180,180*phi2/Math.PI]}(coords,distanceInMeters,bearing);return destination[0]+=destination[0]-coords[0]>180?-360:coords[0]-destination[0]>180?360:0,es_point(destination,options.properties)};function scale(feature,factor,origin){var isPoint="Point"===getType(feature);return origin=function(geojson,origin){null==origin&&(origin="centroid");if(Array.isArray(origin)||"object"==typeof origin)return getCoord(origin);var bbox=geojson.bbox?geojson.bbox:dist_es(geojson),west=bbox[0],south=bbox[1],east=bbox[2],north=bbox[3];switch(origin){case"sw":case"southwest":case"westsouth":case"bottomleft":return es_point([west,south]);case"se":case"southeast":case"eastsouth":case"bottomright":return es_point([east,south]);case"nw":case"northwest":case"westnorth":case"topleft":return es_point([west,north]);case"ne":case"northeast":case"eastnorth":case"topright":return es_point([east,north]);case"center":return center_dist_es(geojson);case void 0:case null:case"centroid":return centroid_dist_es(geojson);default:throw new Error("invalid origin")}}(feature,origin),1===factor||isPoint||coordEach(feature,(function(coord){var originalDistance=rhumb_distance_dist_es(origin,coord),bearing=rhumb_bearing_dist_es(origin,coord),newCoord=function(coords){if(Array.isArray(coords))return coords;if("Feature"===coords.type){if(null!==coords.geometry)return coords.geometry.coordinates}else if(coords.coordinates)return coords.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(rhumb_destination_dist_es(origin,originalDistance*factor,bearing));coord[0]=newCoord[0],coord[1]=newCoord[1],3===coord.length&&(coord[2]*=factor)})),feature}const transform_scale_dist_es=function(geojson,factor,options){if(!(input=options=options||{})||input.constructor!==Object)throw new Error("options is invalid");var input,origin=options.origin,mutate=options.mutate;if(!geojson)throw new Error("geojson required");if("number"!=typeof factor||0===factor)throw new Error("invalid factor");var originIsPoint=Array.isArray(origin)||"object"==typeof origin;return!0!==mutate&&(geojson=es(geojson)),"FeatureCollection"!==geojson.type||originIsPoint?scale(geojson,factor,origin):(featureEach(geojson,(function(feature,index){geojson.features[index]=scale(feature,factor,origin)})),geojson)};class UpdateBigJunctionGeometryToRoundaboutAction extends Action{static DefaultSizeFactor=1.2;shouldSerialize=!1;constructor(addBigJunctionAction,dataModel,map,sizeFactor=UpdateBigJunctionGeometryToRoundaboutAction.DefaultSizeFactor,props){super(props),this.addBigJunctionAction=addBigJunctionAction,this.dataModel=dataModel,this.map=map,this._initialGeometry=(0,get_wme_window.B)().W.userscripts.toGeoJSONGeometry(addBigJunctionAction.initialGeometry),this._geometry=transform_scale_dist_es(this._getRoundaboutPerimeterGeometry(),sizeFactor)}_getBigJunction(){return this.addBigJunctionAction.bigJunction}_getBigJunctionSegments(){return this._getBigJunction().getShortSegments()}_getJunctionById(id){return this.dataModel.getRepository("junction").getObjectById(id)}_getRoundaboutJunction(){const[checkSegment,...segments]=this._getBigJunctionSegments(),getSegmentJunctionId=segment=>segment.getAttribute("junctionID"),junctionId=getSegmentJunctionId(checkSegment);return segments.every((segment=>getSegmentJunctionId(segment)===junctionId))?this._getJunctionById(junctionId):null}_getRoundaboutPerimeterGeometry(){return extractRoundaboutPerimeterPolygon(this._getRoundaboutJunction())}_updateBigJunctionGeometry(newGeometry){const createObjectAction=this.addBigJunctionAction.getSubActions().find(isCreateObjectAction),olGeometry=(0,get_wme_window.B)().W.userscripts.toOLGeometry(newGeometry);this.addBigJunctionAction.initialGeometry=olGeometry,this.addBigJunctionAction.bigJunction.attributes.geometry=olGeometry,this.addBigJunctionAction.bigJunction.attributes.geoJSONGeometry=newGeometry,createObjectAction&&(createObjectAction.attributes.geoJSONGeometry=newGeometry),this.dataModel.getRepository("bigJunction").trigger("objectschanged",[this._getBigJunction()])}getFocusFeatures(){return[this._getBigJunction()]}getAffectedUniqueIds(){return[this._getBigJunction().getUniqueID()]}doAction(){return this._updateBigJunctionGeometry(this._geometry),!0}undoAction(){this._updateBigJunctionGeometry(this._initialGeometry)}redoAction(){this.doAction()}generateDescription(){this._description=(0,get_wme_window.B)().I18n.t("jb_utils.save.changes_log.actions.UpdateBigJunctionGeometryToRoundabout")}}var concaveman=__webpack_require__(271);const center_of_mass_dist_es=function centerOfMass(geojson,options){switch(void 0===options&&(options={}),getType(geojson)){case"Point":return es_point(getCoord(geojson),options.properties);case"Polygon":var coords=[];coordEach(geojson,(function(coord){coords.push(coord)}));var i,pi,pj,xi,xj,yi,yj,a,centre=centroid_dist_es(geojson,{properties:options.properties}),translation=centre.geometry.coordinates,sx=0,sy=0,sArea=0,neutralizedPoints=coords.map((function(point){return[point[0]-translation[0],point[1]-translation[1]]}));for(i=0;i<coords.length-1;i++)xi=(pi=neutralizedPoints[i])[0],yi=pi[1],xj=(pj=neutralizedPoints[i+1])[0],sArea+=a=xi*(yj=pj[1])-xj*yi,sx+=(xi+xj)*a,sy+=(yi+yj)*a;if(0===sArea)return centre;var areaFactor=1/(6*(.5*sArea));return es_point([translation[0]+areaFactor*sx,translation[1]+areaFactor*sy],options.properties);default:var hull=function(geojson,options){void 0===options&&(options={}),options.concavity=options.concavity||1/0;var points=[];if(coordEach(geojson,(function(coord){points.push([coord[0],coord[1]])})),!points.length)return null;var convexHull=concaveman(points,options.concavity);return convexHull.length>3?polygon([convexHull]):null}(geojson);return hull?centerOfMass(hull,{properties:options.properties}):centroid_dist_es(geojson,{properties:options.properties})}};function createTippyDisplayName(wrapperName){return`${wrapperName}(Tippy)`}function getWindow(node){if(null==node)return window;if("[object Window]"!==node.toString()){var ownerDocument=node.ownerDocument;return ownerDocument&&ownerDocument.defaultView||window}return node}function isElement(node){return node instanceof getWindow(node).Element||node instanceof Element}function isHTMLElement(node){return node instanceof getWindow(node).HTMLElement||node instanceof HTMLElement}function isShadowRoot(node){return"undefined"!=typeof ShadowRoot&&(node instanceof getWindow(node).ShadowRoot||node instanceof ShadowRoot)}var math_max=Math.max,math_min=Math.min,math_round=Math.round;function getUAString(){var uaData=navigator.userAgentData;return null!=uaData&&uaData.brands&&Array.isArray(uaData.brands)?uaData.brands.map((function(item){return item.brand+"/"+item.version})).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(element,includeScale,isFixedStrategy){void 0===includeScale&&(includeScale=!1),void 0===isFixedStrategy&&(isFixedStrategy=!1);var clientRect=element.getBoundingClientRect(),scaleX=1,scaleY=1;includeScale&&isHTMLElement(element)&&(scaleX=element.offsetWidth>0&&math_round(clientRect.width)/element.offsetWidth||1,scaleY=element.offsetHeight>0&&math_round(clientRect.height)/element.offsetHeight||1);var visualViewport=(isElement(element)?getWindow(element):window).visualViewport,addVisualOffsets=!isLayoutViewport()&&isFixedStrategy,x=(clientRect.left+(addVisualOffsets&&visualViewport?visualViewport.offsetLeft:0))/scaleX,y=(clientRect.top+(addVisualOffsets&&visualViewport?visualViewport.offsetTop:0))/scaleY,width=clientRect.width/scaleX,height=clientRect.height/scaleY;return{width,height,top:y,right:x+width,bottom:y+height,left:x,x,y}}function getWindowScroll(node){var win=getWindow(node);return{scrollLeft:win.pageXOffset,scrollTop:win.pageYOffset}}function getNodeName(element){return element?(element.nodeName||"").toLowerCase():null}function getDocumentElement(element){return((isElement(element)?element.ownerDocument:element.document)||window.document).documentElement}function getWindowScrollBarX(element){return getBoundingClientRect(getDocumentElement(element)).left+getWindowScroll(element).scrollLeft}function getComputedStyle(element){return getWindow(element).getComputedStyle(element)}function isScrollParent(element){var _getComputedStyle=getComputedStyle(element),overflow=_getComputedStyle.overflow,overflowX=_getComputedStyle.overflowX,overflowY=_getComputedStyle.overflowY;return/auto|scroll|overlay|hidden/.test(overflow+overflowY+overflowX)}function getCompositeRect(elementOrVirtualElement,offsetParent,isFixed){void 0===isFixed&&(isFixed=!1);var isOffsetParentAnElement=isHTMLElement(offsetParent),offsetParentIsScaled=isHTMLElement(offsetParent)&&function(element){var rect=element.getBoundingClientRect(),scaleX=math_round(rect.width)/element.offsetWidth||1,scaleY=math_round(rect.height)/element.offsetHeight||1;return 1!==scaleX||1!==scaleY}(offsetParent),documentElement=getDocumentElement(offsetParent),rect=getBoundingClientRect(elementOrVirtualElement,offsetParentIsScaled,isFixed),scroll={scrollLeft:0,scrollTop:0},offsets={x:0,y:0};return(isOffsetParentAnElement||!isOffsetParentAnElement&&!isFixed)&&(("body"!==getNodeName(offsetParent)||isScrollParent(documentElement))&&(scroll=function(node){return node!==getWindow(node)&&isHTMLElement(node)?{scrollLeft:(element=node).scrollLeft,scrollTop:element.scrollTop}:getWindowScroll(node);var element}(offsetParent)),isHTMLElement(offsetParent)?((offsets=getBoundingClientRect(offsetParent,!0)).x+=offsetParent.clientLeft,offsets.y+=offsetParent.clientTop):documentElement&&(offsets.x=getWindowScrollBarX(documentElement))),{x:rect.left+scroll.scrollLeft-offsets.x,y:rect.top+scroll.scrollTop-offsets.y,width:rect.width,height:rect.height}}function getLayoutRect(element){var clientRect=getBoundingClientRect(element),width=element.offsetWidth,height=element.offsetHeight;return Math.abs(clientRect.width-width)<=1&&(width=clientRect.width),Math.abs(clientRect.height-height)<=1&&(height=clientRect.height),{x:element.offsetLeft,y:element.offsetTop,width,height}}function getParentNode(element){return"html"===getNodeName(element)?element:element.assignedSlot||element.parentNode||(isShadowRoot(element)?element.host:null)||getDocumentElement(element)}function getScrollParent(node){return["html","body","#document"].indexOf(getNodeName(node))>=0?node.ownerDocument.body:isHTMLElement(node)&&isScrollParent(node)?node:getScrollParent(getParentNode(node))}function listScrollParents(element,list){var _element$ownerDocumen;void 0===list&&(list=[]);var scrollParent=getScrollParent(element),isBody=scrollParent===(null==(_element$ownerDocumen=element.ownerDocument)?void 0:_element$ownerDocumen.body),win=getWindow(scrollParent),target=isBody?[win].concat(win.visualViewport||[],isScrollParent(scrollParent)?scrollParent:[]):scrollParent,updatedList=list.concat(target);return isBody?updatedList:updatedList.concat(listScrollParents(getParentNode(target)))}function isTableElement(element){return["table","td","th"].indexOf(getNodeName(element))>=0}function getTrueOffsetParent(element){return isHTMLElement(element)&&"fixed"!==getComputedStyle(element).position?element.offsetParent:null}function getOffsetParent(element){for(var window=getWindow(element),offsetParent=getTrueOffsetParent(element);offsetParent&&isTableElement(offsetParent)&&"static"===getComputedStyle(offsetParent).position;)offsetParent=getTrueOffsetParent(offsetParent);return offsetParent&&("html"===getNodeName(offsetParent)||"body"===getNodeName(offsetParent)&&"static"===getComputedStyle(offsetParent).position)?window:offsetParent||function(element){var isFirefox=/firefox/i.test(getUAString());if(/Trident/i.test(getUAString())&&isHTMLElement(element)&&"fixed"===getComputedStyle(element).position)return null;var currentNode=getParentNode(element);for(isShadowRoot(currentNode)&&(currentNode=currentNode.host);isHTMLElement(currentNode)&&["html","body"].indexOf(getNodeName(currentNode))<0;){var css=getComputedStyle(currentNode);if("none"!==css.transform||"none"!==css.perspective||"paint"===css.contain||-1!==["transform","perspective"].indexOf(css.willChange)||isFirefox&&"filter"===css.willChange||isFirefox&&css.filter&&"none"!==css.filter)return currentNode;currentNode=currentNode.parentNode}return null}(element)||window}var enums_top="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[enums_top,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce((function(acc,placement){return acc.concat([placement+"-"+start,placement+"-"+end])}),[]),enums_placements=[].concat(basePlacements,[auto]).reduce((function(acc,placement){return acc.concat([placement,placement+"-"+start,placement+"-"+end])}),[]),modifierPhases=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function order(modifiers){var map=new Map,visited=new Set,result=[];function sort(modifier){visited.add(modifier.name),[].concat(modifier.requires||[],modifier.requiresIfExists||[]).forEach((function(dep){if(!visited.has(dep)){var depModifier=map.get(dep);depModifier&&sort(depModifier)}})),result.push(modifier)}return modifiers.forEach((function(modifier){map.set(modifier.name,modifier)})),modifiers.forEach((function(modifier){visited.has(modifier.name)||sort(modifier)})),result}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return!args.some((function(element){return!(element&&"function"==typeof element.getBoundingClientRect)}))}function popperGenerator(generatorOptions){void 0===generatorOptions&&(generatorOptions={});var _generatorOptions=generatorOptions,_generatorOptions$def=_generatorOptions.defaultModifiers,defaultModifiers=void 0===_generatorOptions$def?[]:_generatorOptions$def,_generatorOptions$def2=_generatorOptions.defaultOptions,defaultOptions=void 0===_generatorOptions$def2?DEFAULT_OPTIONS:_generatorOptions$def2;return function(reference,popper,options){void 0===options&&(options=defaultOptions);var fn,pending,state={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,defaultOptions),modifiersData:{},elements:{reference,popper},attributes:{},styles:{}},effectCleanupFns=[],isDestroyed=!1,instance={state,setOptions:function(setOptionsAction){var options="function"==typeof setOptionsAction?setOptionsAction(state.options):setOptionsAction;cleanupModifierEffects(),state.options=Object.assign({},defaultOptions,state.options,options),state.scrollParents={reference:isElement(reference)?listScrollParents(reference):reference.contextElement?listScrollParents(reference.contextElement):[],popper:listScrollParents(popper)};var modifiers,merged,orderedModifiers=function(modifiers){var orderedModifiers=order(modifiers);return modifierPhases.reduce((function(acc,phase){return acc.concat(orderedModifiers.filter((function(modifier){return modifier.phase===phase})))}),[])}((modifiers=[].concat(defaultModifiers,state.options.modifiers),merged=modifiers.reduce((function(merged,current){var existing=merged[current.name];return merged[current.name]=existing?Object.assign({},existing,current,{options:Object.assign({},existing.options,current.options),data:Object.assign({},existing.data,current.data)}):current,merged}),{}),Object.keys(merged).map((function(key){return merged[key]}))));return state.orderedModifiers=orderedModifiers.filter((function(m){return m.enabled})),state.orderedModifiers.forEach((function(_ref){var name=_ref.name,_ref$options=_ref.options,options=void 0===_ref$options?{}:_ref$options,effect=_ref.effect;if("function"==typeof effect){var cleanupFn=effect({state,name,instance,options}),noopFn=function(){};effectCleanupFns.push(cleanupFn||noopFn)}})),instance.update()},forceUpdate:function(){if(!isDestroyed){var _state$elements=state.elements,reference=_state$elements.reference,popper=_state$elements.popper;if(areValidElements(reference,popper)){state.rects={reference:getCompositeRect(reference,getOffsetParent(popper),"fixed"===state.options.strategy),popper:getLayoutRect(popper)},state.reset=!1,state.placement=state.options.placement,state.orderedModifiers.forEach((function(modifier){return state.modifiersData[modifier.name]=Object.assign({},modifier.data)}));for(var index=0;index<state.orderedModifiers.length;index++)if(!0!==state.reset){var _state$orderedModifie=state.orderedModifiers[index],fn=_state$orderedModifie.fn,_state$orderedModifie2=_state$orderedModifie.options,_options=void 0===_state$orderedModifie2?{}:_state$orderedModifie2,name=_state$orderedModifie.name;"function"==typeof fn&&(state=fn({state,options:_options,name,instance})||state)}else state.reset=!1,index=-1}}},update:(fn=function(){return new Promise((function(resolve){instance.forceUpdate(),resolve(state)}))},function(){return pending||(pending=new Promise((function(resolve){Promise.resolve().then((function(){pending=void 0,resolve(fn())}))}))),pending}),destroy:function(){cleanupModifierEffects(),isDestroyed=!0}};if(!areValidElements(reference,popper))return instance;function cleanupModifierEffects(){effectCleanupFns.forEach((function(fn){return fn()})),effectCleanupFns=[]}return instance.setOptions(options).then((function(state){!isDestroyed&&options.onFirstUpdate&&options.onFirstUpdate(state)})),instance}}var passive={passive:!0};function getBasePlacement(placement){return placement.split("-")[0]}function getVariation(placement){return placement.split("-")[1]}function getMainAxisFromPlacement(placement){return["top","bottom"].indexOf(placement)>=0?"x":"y"}function computeOffsets(_ref){var offsets,reference=_ref.reference,element=_ref.element,placement=_ref.placement,basePlacement=placement?getBasePlacement(placement):null,variation=placement?getVariation(placement):null,commonX=reference.x+reference.width/2-element.width/2,commonY=reference.y+reference.height/2-element.height/2;switch(basePlacement){case enums_top:offsets={x:commonX,y:reference.y-element.height};break;case bottom:offsets={x:commonX,y:reference.y+reference.height};break;case right:offsets={x:reference.x+reference.width,y:commonY};break;case left:offsets={x:reference.x-element.width,y:commonY};break;default:offsets={x:reference.x,y:reference.y}}var mainAxis=basePlacement?getMainAxisFromPlacement(basePlacement):null;if(null!=mainAxis){var len="y"===mainAxis?"height":"width";switch(variation){case start:offsets[mainAxis]=offsets[mainAxis]-(reference[len]/2-element[len]/2);break;case end:offsets[mainAxis]=offsets[mainAxis]+(reference[len]/2-element[len]/2)}}return offsets}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function mapToStyles(_ref2){var _Object$assign2,popper=_ref2.popper,popperRect=_ref2.popperRect,placement=_ref2.placement,variation=_ref2.variation,offsets=_ref2.offsets,position=_ref2.position,gpuAcceleration=_ref2.gpuAcceleration,adaptive=_ref2.adaptive,roundOffsets=_ref2.roundOffsets,isFixed=_ref2.isFixed,_offsets$x=offsets.x,x=void 0===_offsets$x?0:_offsets$x,_offsets$y=offsets.y,y=void 0===_offsets$y?0:_offsets$y,_ref3="function"==typeof roundOffsets?roundOffsets({x,y}):{x,y};x=_ref3.x,y=_ref3.y;var hasX=offsets.hasOwnProperty("x"),hasY=offsets.hasOwnProperty("y"),sideX=left,sideY=enums_top,win=window;if(adaptive){var offsetParent=getOffsetParent(popper),heightProp="clientHeight",widthProp="clientWidth";if(offsetParent===getWindow(popper)&&"static"!==getComputedStyle(offsetParent=getDocumentElement(popper)).position&&"absolute"===position&&(heightProp="scrollHeight",widthProp="scrollWidth"),placement===enums_top||(placement===left||placement===right)&&variation===end)sideY=bottom,y-=(isFixed&&offsetParent===win&&win.visualViewport?win.visualViewport.height:offsetParent[heightProp])-popperRect.height,y*=gpuAcceleration?1:-1;if(placement===left||(placement===enums_top||placement===bottom)&&variation===end)sideX=right,x-=(isFixed&&offsetParent===win&&win.visualViewport?win.visualViewport.width:offsetParent[widthProp])-popperRect.width,x*=gpuAcceleration?1:-1}var _Object$assign,commonStyles=Object.assign({position},adaptive&&unsetSides),_ref4=!0===roundOffsets?function(_ref,win){var x=_ref.x,y=_ref.y,dpr=win.devicePixelRatio||1;return{x:math_round(x*dpr)/dpr||0,y:math_round(y*dpr)/dpr||0}}({x,y},getWindow(popper)):{x,y};return x=_ref4.x,y=_ref4.y,gpuAcceleration?Object.assign({},commonStyles,((_Object$assign={})[sideY]=hasY?"0":"",_Object$assign[sideX]=hasX?"0":"",_Object$assign.transform=(win.devicePixelRatio||1)<=1?"translate("+x+"px, "+y+"px)":"translate3d("+x+"px, "+y+"px, 0)",_Object$assign)):Object.assign({},commonStyles,((_Object$assign2={})[sideY]=hasY?y+"px":"",_Object$assign2[sideX]=hasX?x+"px":"",_Object$assign2.transform="",_Object$assign2))}const modifiers_applyStyles={name:"applyStyles",enabled:!0,phase:"write",fn:function(_ref){var state=_ref.state;Object.keys(state.elements).forEach((function(name){var style=state.styles[name]||{},attributes=state.attributes[name]||{},element=state.elements[name];isHTMLElement(element)&&getNodeName(element)&&(Object.assign(element.style,style),Object.keys(attributes).forEach((function(name){var value=attributes[name];!1===value?element.removeAttribute(name):element.setAttribute(name,!0===value?"":value)})))}))},effect:function(_ref2){var state=_ref2.state,initialStyles={popper:{position:state.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(state.elements.popper.style,initialStyles.popper),state.styles=initialStyles,state.elements.arrow&&Object.assign(state.elements.arrow.style,initialStyles.arrow),function(){Object.keys(state.elements).forEach((function(name){var element=state.elements[name],attributes=state.attributes[name]||{},style=Object.keys(state.styles.hasOwnProperty(name)?state.styles[name]:initialStyles[name]).reduce((function(style,property){return style[property]="",style}),{});isHTMLElement(element)&&getNodeName(element)&&(Object.assign(element.style,style),Object.keys(attributes).forEach((function(attribute){element.removeAttribute(attribute)})))}))}},requires:["computeStyles"]};const modifiers_offset={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(_ref2){var state=_ref2.state,options=_ref2.options,name=_ref2.name,_options$offset=options.offset,offset=void 0===_options$offset?[0,0]:_options$offset,data=enums_placements.reduce((function(acc,placement){return acc[placement]=function(placement,rects,offset){var basePlacement=getBasePlacement(placement),invertDistance=[left,enums_top].indexOf(basePlacement)>=0?-1:1,_ref="function"==typeof offset?offset(Object.assign({},rects,{placement})):offset,skidding=_ref[0],distance=_ref[1];return skidding=skidding||0,distance=(distance||0)*invertDistance,[left,right].indexOf(basePlacement)>=0?{x:distance,y:skidding}:{x:skidding,y:distance}}(placement,state.rects,offset),acc}),{}),_data$state$placement=data[state.placement],x=_data$state$placement.x,y=_data$state$placement.y;null!=state.modifiersData.popperOffsets&&(state.modifiersData.popperOffsets.x+=x,state.modifiersData.popperOffsets.y+=y),state.modifiersData[name]=data}};var hash={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(placement){return placement.replace(/left|right|bottom|top/g,(function(matched){return hash[matched]}))}var getOppositeVariationPlacement_hash={start:"end",end:"start"};function getOppositeVariationPlacement(placement){return placement.replace(/start|end/g,(function(matched){return getOppositeVariationPlacement_hash[matched]}))}function contains(parent,child){var rootNode=child.getRootNode&&child.getRootNode();if(parent.contains(child))return!0;if(rootNode&&isShadowRoot(rootNode)){var next=child;do{if(next&&parent.isSameNode(next))return!0;next=next.parentNode||next.host}while(next)}return!1}function rectToClientRect(rect){return Object.assign({},rect,{left:rect.x,top:rect.y,right:rect.x+rect.width,bottom:rect.y+rect.height})}function getClientRectFromMixedType(element,clippingParent,strategy){return clippingParent===viewport?rectToClientRect(function(element,strategy){var win=getWindow(element),html=getDocumentElement(element),visualViewport=win.visualViewport,width=html.clientWidth,height=html.clientHeight,x=0,y=0;if(visualViewport){width=visualViewport.width,height=visualViewport.height;var layoutViewport=isLayoutViewport();(layoutViewport||!layoutViewport&&"fixed"===strategy)&&(x=visualViewport.offsetLeft,y=visualViewport.offsetTop)}return{width,height,x:x+getWindowScrollBarX(element),y}}(element,strategy)):isElement(clippingParent)?function(element,strategy){var rect=getBoundingClientRect(element,!1,"fixed"===strategy);return rect.top=rect.top+element.clientTop,rect.left=rect.left+element.clientLeft,rect.bottom=rect.top+element.clientHeight,rect.right=rect.left+element.clientWidth,rect.width=element.clientWidth,rect.height=element.clientHeight,rect.x=rect.left,rect.y=rect.top,rect}(clippingParent,strategy):rectToClientRect(function(element){var _element$ownerDocumen,html=getDocumentElement(element),winScroll=getWindowScroll(element),body=null==(_element$ownerDocumen=element.ownerDocument)?void 0:_element$ownerDocumen.body,width=math_max(html.scrollWidth,html.clientWidth,body?body.scrollWidth:0,body?body.clientWidth:0),height=math_max(html.scrollHeight,html.clientHeight,body?body.scrollHeight:0,body?body.clientHeight:0),x=-winScroll.scrollLeft+getWindowScrollBarX(element),y=-winScroll.scrollTop;return"rtl"===getComputedStyle(body||html).direction&&(x+=math_max(html.clientWidth,body?body.clientWidth:0)-width),{width,height,x,y}}(getDocumentElement(element)))}function getClippingRect(element,boundary,rootBoundary,strategy){var mainClippingParents="clippingParents"===boundary?function(element){var clippingParents=listScrollParents(getParentNode(element)),clipperElement=["absolute","fixed"].indexOf(getComputedStyle(element).position)>=0&&isHTMLElement(element)?getOffsetParent(element):element;return isElement(clipperElement)?clippingParents.filter((function(clippingParent){return isElement(clippingParent)&&contains(clippingParent,clipperElement)&&"body"!==getNodeName(clippingParent)})):[]}(element):[].concat(boundary),clippingParents=[].concat(mainClippingParents,[rootBoundary]),firstClippingParent=clippingParents[0],clippingRect=clippingParents.reduce((function(accRect,clippingParent){var rect=getClientRectFromMixedType(element,clippingParent,strategy);return accRect.top=math_max(rect.top,accRect.top),accRect.right=math_min(rect.right,accRect.right),accRect.bottom=math_min(rect.bottom,accRect.bottom),accRect.left=math_max(rect.left,accRect.left),accRect}),getClientRectFromMixedType(element,firstClippingParent,strategy));return clippingRect.width=clippingRect.right-clippingRect.left,clippingRect.height=clippingRect.bottom-clippingRect.top,clippingRect.x=clippingRect.left,clippingRect.y=clippingRect.top,clippingRect}function mergePaddingObject(paddingObject){return Object.assign({},{top:0,right:0,bottom:0,left:0},paddingObject)}function expandToHashMap(value,keys){return keys.reduce((function(hashMap,key){return hashMap[key]=value,hashMap}),{})}function detectOverflow(state,options){void 0===options&&(options={});var _options=options,_options$placement=_options.placement,placement=void 0===_options$placement?state.placement:_options$placement,_options$strategy=_options.strategy,strategy=void 0===_options$strategy?state.strategy:_options$strategy,_options$boundary=_options.boundary,boundary=void 0===_options$boundary?clippingParents:_options$boundary,_options$rootBoundary=_options.rootBoundary,rootBoundary=void 0===_options$rootBoundary?viewport:_options$rootBoundary,_options$elementConte=_options.elementContext,elementContext=void 0===_options$elementConte?popper:_options$elementConte,_options$altBoundary=_options.altBoundary,altBoundary=void 0!==_options$altBoundary&&_options$altBoundary,_options$padding=_options.padding,padding=void 0===_options$padding?0:_options$padding,paddingObject=mergePaddingObject("number"!=typeof padding?padding:expandToHashMap(padding,basePlacements)),altContext=elementContext===popper?reference:popper,popperRect=state.rects.popper,element=state.elements[altBoundary?altContext:elementContext],clippingClientRect=getClippingRect(isElement(element)?element:element.contextElement||getDocumentElement(state.elements.popper),boundary,rootBoundary,strategy),referenceClientRect=getBoundingClientRect(state.elements.reference),popperOffsets=computeOffsets({reference:referenceClientRect,element:popperRect,strategy:"absolute",placement}),popperClientRect=rectToClientRect(Object.assign({},popperRect,popperOffsets)),elementClientRect=elementContext===popper?popperClientRect:referenceClientRect,overflowOffsets={top:clippingClientRect.top-elementClientRect.top+paddingObject.top,bottom:elementClientRect.bottom-clippingClientRect.bottom+paddingObject.bottom,left:clippingClientRect.left-elementClientRect.left+paddingObject.left,right:elementClientRect.right-clippingClientRect.right+paddingObject.right},offsetData=state.modifiersData.offset;if(elementContext===popper&&offsetData){var offset=offsetData[placement];Object.keys(overflowOffsets).forEach((function(key){var multiply=[right,bottom].indexOf(key)>=0?1:-1,axis=[enums_top,bottom].indexOf(key)>=0?"y":"x";overflowOffsets[key]+=offset[axis]*multiply}))}return overflowOffsets}function within(min,value,max){return math_max(min,math_min(value,max))}const modifiers_preventOverflow={name:"preventOverflow",enabled:!0,phase:"main",fn:function(_ref){var state=_ref.state,options=_ref.options,name=_ref.name,_options$mainAxis=options.mainAxis,checkMainAxis=void 0===_options$mainAxis||_options$mainAxis,_options$altAxis=options.altAxis,checkAltAxis=void 0!==_options$altAxis&&_options$altAxis,boundary=options.boundary,rootBoundary=options.rootBoundary,altBoundary=options.altBoundary,padding=options.padding,_options$tether=options.tether,tether=void 0===_options$tether||_options$tether,_options$tetherOffset=options.tetherOffset,tetherOffset=void 0===_options$tetherOffset?0:_options$tetherOffset,overflow=detectOverflow(state,{boundary,rootBoundary,padding,altBoundary}),basePlacement=getBasePlacement(state.placement),variation=getVariation(state.placement),isBasePlacement=!variation,mainAxis=getMainAxisFromPlacement(basePlacement),altAxis="x"===mainAxis?"y":"x",popperOffsets=state.modifiersData.popperOffsets,referenceRect=state.rects.reference,popperRect=state.rects.popper,tetherOffsetValue="function"==typeof tetherOffset?tetherOffset(Object.assign({},state.rects,{placement:state.placement})):tetherOffset,normalizedTetherOffsetValue="number"==typeof tetherOffsetValue?{mainAxis:tetherOffsetValue,altAxis:tetherOffsetValue}:Object.assign({mainAxis:0,altAxis:0},tetherOffsetValue),offsetModifierState=state.modifiersData.offset?state.modifiersData.offset[state.placement]:null,data={x:0,y:0};if(popperOffsets){if(checkMainAxis){var _offsetModifierState$,mainSide="y"===mainAxis?enums_top:left,altSide="y"===mainAxis?bottom:right,len="y"===mainAxis?"height":"width",offset=popperOffsets[mainAxis],min=offset+overflow[mainSide],max=offset-overflow[altSide],additive=tether?-popperRect[len]/2:0,minLen=variation===start?referenceRect[len]:popperRect[len],maxLen=variation===start?-popperRect[len]:-referenceRect[len],arrowElement=state.elements.arrow,arrowRect=tether&&arrowElement?getLayoutRect(arrowElement):{width:0,height:0},arrowPaddingObject=state.modifiersData["arrow#persistent"]?state.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},arrowPaddingMin=arrowPaddingObject[mainSide],arrowPaddingMax=arrowPaddingObject[altSide],arrowLen=within(0,referenceRect[len],arrowRect[len]),minOffset=isBasePlacement?referenceRect[len]/2-additive-arrowLen-arrowPaddingMin-normalizedTetherOffsetValue.mainAxis:minLen-arrowLen-arrowPaddingMin-normalizedTetherOffsetValue.mainAxis,maxOffset=isBasePlacement?-referenceRect[len]/2+additive+arrowLen+arrowPaddingMax+normalizedTetherOffsetValue.mainAxis:maxLen+arrowLen+arrowPaddingMax+normalizedTetherOffsetValue.mainAxis,arrowOffsetParent=state.elements.arrow&&getOffsetParent(state.elements.arrow),clientOffset=arrowOffsetParent?"y"===mainAxis?arrowOffsetParent.clientTop||0:arrowOffsetParent.clientLeft||0:0,offsetModifierValue=null!=(_offsetModifierState$=null==offsetModifierState?void 0:offsetModifierState[mainAxis])?_offsetModifierState$:0,tetherMax=offset+maxOffset-offsetModifierValue,preventedOffset=within(tether?math_min(min,offset+minOffset-offsetModifierValue-clientOffset):min,offset,tether?math_max(max,tetherMax):max);popperOffsets[mainAxis]=preventedOffset,data[mainAxis]=preventedOffset-offset}if(checkAltAxis){var _offsetModifierState$2,_mainSide="x"===mainAxis?enums_top:left,_altSide="x"===mainAxis?bottom:right,_offset=popperOffsets[altAxis],_len="y"===altAxis?"height":"width",_min=_offset+overflow[_mainSide],_max=_offset-overflow[_altSide],isOriginSide=-1!==[enums_top,left].indexOf(basePlacement),_offsetModifierValue=null!=(_offsetModifierState$2=null==offsetModifierState?void 0:offsetModifierState[altAxis])?_offsetModifierState$2:0,_tetherMin=isOriginSide?_min:_offset-referenceRect[_len]-popperRect[_len]-_offsetModifierValue+normalizedTetherOffsetValue.altAxis,_tetherMax=isOriginSide?_offset+referenceRect[_len]+popperRect[_len]-_offsetModifierValue-normalizedTetherOffsetValue.altAxis:_max,_preventedOffset=tether&&isOriginSide?function(min,value,max){var v=within(min,value,max);return v>max?max:v}(_tetherMin,_offset,_tetherMax):within(tether?_tetherMin:_min,_offset,tether?_tetherMax:_max);popperOffsets[altAxis]=_preventedOffset,data[altAxis]=_preventedOffset-_offset}state.modifiersData[name]=data}},requiresIfExists:["offset"]};const modifiers_arrow={name:"arrow",enabled:!0,phase:"main",fn:function(_ref){var _state$modifiersData$,state=_ref.state,name=_ref.name,options=_ref.options,arrowElement=state.elements.arrow,popperOffsets=state.modifiersData.popperOffsets,basePlacement=getBasePlacement(state.placement),axis=getMainAxisFromPlacement(basePlacement),len=[left,right].indexOf(basePlacement)>=0?"height":"width";if(arrowElement&&popperOffsets){var paddingObject=function(padding,state){return mergePaddingObject("number"!=typeof(padding="function"==typeof padding?padding(Object.assign({},state.rects,{placement:state.placement})):padding)?padding:expandToHashMap(padding,basePlacements))}(options.padding,state),arrowRect=getLayoutRect(arrowElement),minProp="y"===axis?enums_top:left,maxProp="y"===axis?bottom:right,endDiff=state.rects.reference[len]+state.rects.reference[axis]-popperOffsets[axis]-state.rects.popper[len],startDiff=popperOffsets[axis]-state.rects.reference[axis],arrowOffsetParent=getOffsetParent(arrowElement),clientSize=arrowOffsetParent?"y"===axis?arrowOffsetParent.clientHeight||0:arrowOffsetParent.clientWidth||0:0,centerToReference=endDiff/2-startDiff/2,min=paddingObject[minProp],max=clientSize-arrowRect[len]-paddingObject[maxProp],center=clientSize/2-arrowRect[len]/2+centerToReference,offset=within(min,center,max),axisProp=axis;state.modifiersData[name]=((_state$modifiersData$={})[axisProp]=offset,_state$modifiersData$.centerOffset=offset-center,_state$modifiersData$)}},effect:function(_ref2){var state=_ref2.state,_options$element=_ref2.options.element,arrowElement=void 0===_options$element?"[data-popper-arrow]":_options$element;null!=arrowElement&&("string"!=typeof arrowElement||(arrowElement=state.elements.popper.querySelector(arrowElement)))&&contains(state.elements.popper,arrowElement)&&(state.elements.arrow=arrowElement)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getSideOffsets(overflow,rect,preventedOffsets){return void 0===preventedOffsets&&(preventedOffsets={x:0,y:0}),{top:overflow.top-rect.height-preventedOffsets.y,right:overflow.right-rect.width+preventedOffsets.x,bottom:overflow.bottom-rect.height+preventedOffsets.y,left:overflow.left-rect.width-preventedOffsets.x}}function isAnySideFullyClipped(overflow){return[enums_top,right,bottom,left].some((function(side){return overflow[side]>=0}))}var popper_createPopper=popperGenerator({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(_ref){var state=_ref.state,instance=_ref.instance,options=_ref.options,_options$scroll=options.scroll,scroll=void 0===_options$scroll||_options$scroll,_options$resize=options.resize,resize=void 0===_options$resize||_options$resize,window=getWindow(state.elements.popper),scrollParents=[].concat(state.scrollParents.reference,state.scrollParents.popper);return scroll&&scrollParents.forEach((function(scrollParent){scrollParent.addEventListener("scroll",instance.update,passive)})),resize&&window.addEventListener("resize",instance.update,passive),function(){scroll&&scrollParents.forEach((function(scrollParent){scrollParent.removeEventListener("scroll",instance.update,passive)})),resize&&window.removeEventListener("resize",instance.update,passive)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(_ref){var state=_ref.state,name=_ref.name;state.modifiersData[name]=computeOffsets({reference:state.rects.reference,element:state.rects.popper,strategy:"absolute",placement:state.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(_ref5){var state=_ref5.state,options=_ref5.options,_options$gpuAccelerat=options.gpuAcceleration,gpuAcceleration=void 0===_options$gpuAccelerat||_options$gpuAccelerat,_options$adaptive=options.adaptive,adaptive=void 0===_options$adaptive||_options$adaptive,_options$roundOffsets=options.roundOffsets,roundOffsets=void 0===_options$roundOffsets||_options$roundOffsets,commonStyles={placement:getBasePlacement(state.placement),variation:getVariation(state.placement),popper:state.elements.popper,popperRect:state.rects.popper,gpuAcceleration,isFixed:"fixed"===state.options.strategy};null!=state.modifiersData.popperOffsets&&(state.styles.popper=Object.assign({},state.styles.popper,mapToStyles(Object.assign({},commonStyles,{offsets:state.modifiersData.popperOffsets,position:state.options.strategy,adaptive,roundOffsets})))),null!=state.modifiersData.arrow&&(state.styles.arrow=Object.assign({},state.styles.arrow,mapToStyles(Object.assign({},commonStyles,{offsets:state.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets})))),state.attributes.popper=Object.assign({},state.attributes.popper,{"data-popper-placement":state.placement})},data:{}},modifiers_applyStyles,modifiers_offset,{name:"flip",enabled:!0,phase:"main",fn:function(_ref){var state=_ref.state,options=_ref.options,name=_ref.name;if(!state.modifiersData[name]._skip){for(var _options$mainAxis=options.mainAxis,checkMainAxis=void 0===_options$mainAxis||_options$mainAxis,_options$altAxis=options.altAxis,checkAltAxis=void 0===_options$altAxis||_options$altAxis,specifiedFallbackPlacements=options.fallbackPlacements,padding=options.padding,boundary=options.boundary,rootBoundary=options.rootBoundary,altBoundary=options.altBoundary,_options$flipVariatio=options.flipVariations,flipVariations=void 0===_options$flipVariatio||_options$flipVariatio,allowedAutoPlacements=options.allowedAutoPlacements,preferredPlacement=state.options.placement,basePlacement=getBasePlacement(preferredPlacement),fallbackPlacements=specifiedFallbackPlacements||(basePlacement===preferredPlacement||!flipVariations?[getOppositePlacement(preferredPlacement)]:function(placement){if(getBasePlacement(placement)===auto)return[];var oppositePlacement=getOppositePlacement(placement);return[getOppositeVariationPlacement(placement),oppositePlacement,getOppositeVariationPlacement(oppositePlacement)]}(preferredPlacement)),placements=[preferredPlacement].concat(fallbackPlacements).reduce((function(acc,placement){return acc.concat(getBasePlacement(placement)===auto?function(state,options){void 0===options&&(options={});var _options=options,placement=_options.placement,boundary=_options.boundary,rootBoundary=_options.rootBoundary,padding=_options.padding,flipVariations=_options.flipVariations,_options$allowedAutoP=_options.allowedAutoPlacements,allowedAutoPlacements=void 0===_options$allowedAutoP?enums_placements:_options$allowedAutoP,variation=getVariation(placement),placements=variation?flipVariations?variationPlacements:variationPlacements.filter((function(placement){return getVariation(placement)===variation})):basePlacements,allowedPlacements=placements.filter((function(placement){return allowedAutoPlacements.indexOf(placement)>=0}));0===allowedPlacements.length&&(allowedPlacements=placements);var overflows=allowedPlacements.reduce((function(acc,placement){return acc[placement]=detectOverflow(state,{placement,boundary,rootBoundary,padding})[getBasePlacement(placement)],acc}),{});return Object.keys(overflows).sort((function(a,b){return overflows[a]-overflows[b]}))}(state,{placement,boundary,rootBoundary,padding,flipVariations,allowedAutoPlacements}):placement)}),[]),referenceRect=state.rects.reference,popperRect=state.rects.popper,checksMap=new Map,makeFallbackChecks=!0,firstFittingPlacement=placements[0],i=0;i<placements.length;i++){var placement=placements[i],_basePlacement=getBasePlacement(placement),isStartVariation=getVariation(placement)===start,isVertical=[enums_top,bottom].indexOf(_basePlacement)>=0,len=isVertical?"width":"height",overflow=detectOverflow(state,{placement,boundary,rootBoundary,altBoundary,padding}),mainVariationSide=isVertical?isStartVariation?right:left:isStartVariation?bottom:enums_top;referenceRect[len]>popperRect[len]&&(mainVariationSide=getOppositePlacement(mainVariationSide));var altVariationSide=getOppositePlacement(mainVariationSide),checks=[];if(checkMainAxis&&checks.push(overflow[_basePlacement]<=0),checkAltAxis&&checks.push(overflow[mainVariationSide]<=0,overflow[altVariationSide]<=0),checks.every((function(check){return check}))){firstFittingPlacement=placement,makeFallbackChecks=!1;break}checksMap.set(placement,checks)}if(makeFallbackChecks)for(var _loop=function(_i){var fittingPlacement=placements.find((function(placement){var checks=checksMap.get(placement);if(checks)return checks.slice(0,_i).every((function(check){return check}))}));if(fittingPlacement)return firstFittingPlacement=fittingPlacement,"break"},_i=flipVariations?3:1;_i>0;_i--){if("break"===_loop(_i))break}state.placement!==firstFittingPlacement&&(state.modifiersData[name]._skip=!0,state.placement=firstFittingPlacement,state.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},modifiers_preventOverflow,modifiers_arrow,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(_ref){var state=_ref.state,name=_ref.name,referenceRect=state.rects.reference,popperRect=state.rects.popper,preventedOffsets=state.modifiersData.preventOverflow,referenceOverflow=detectOverflow(state,{elementContext:"reference"}),popperAltOverflow=detectOverflow(state,{altBoundary:!0}),referenceClippingOffsets=getSideOffsets(referenceOverflow,referenceRect),popperEscapeOffsets=getSideOffsets(popperAltOverflow,popperRect,preventedOffsets),isReferenceHidden=isAnySideFullyClipped(referenceClippingOffsets),hasPopperEscaped=isAnySideFullyClipped(popperEscapeOffsets);state.modifiersData[name]={referenceClippingOffsets,popperEscapeOffsets,isReferenceHidden,hasPopperEscaped},state.attributes.popper=Object.assign({},state.attributes.popper,{"data-popper-reference-hidden":isReferenceHidden,"data-popper-escaped":hasPopperEscaped})}}]}),CONTENT_CLASS="tippy-content",BACKDROP_CLASS="tippy-backdrop",ARROW_CLASS="tippy-arrow",SVG_ARROW_CLASS="tippy-svg-arrow",TOUCH_OPTIONS={passive:!0,capture:!0},TIPPY_DEFAULT_APPEND_TO=function(){return document.body};function getValueAtIndexOrReturn(value,index,defaultValue){if(Array.isArray(value)){var v=value[index];return null==v?Array.isArray(defaultValue)?defaultValue[index]:defaultValue:v}return value}function isType(value,type){var str={}.toString.call(value);return 0===str.indexOf("[object")&&str.indexOf(type+"]")>-1}function invokeWithArgsOrReturn(value,args){return"function"==typeof value?value.apply(void 0,args):value}function tippy_esm_debounce(fn,ms){return 0===ms?fn:function(arg){clearTimeout(timeout),timeout=setTimeout((function(){fn(arg)}),ms)};var timeout}function normalizeToArray(value){return[].concat(value)}function pushIfUnique(arr,value){-1===arr.indexOf(value)&&arr.push(value)}function tippy_esm_getBasePlacement(placement){return placement.split("-")[0]}function arrayFrom(value){return[].slice.call(value)}function removeUndefinedProps(obj){return Object.keys(obj).reduce((function(acc,key){return void 0!==obj[key]&&(acc[key]=obj[key]),acc}),{})}function div(){return document.createElement("div")}function tippy_esm_isElement(value){return["Element","Fragment"].some((function(type){return isType(value,type)}))}function isMouseEvent(value){return isType(value,"MouseEvent")}function isReferenceElement(value){return!(!value||!value._tippy||value._tippy.reference!==value)}function getArrayOfElements(value){return tippy_esm_isElement(value)?[value]:function(value){return isType(value,"NodeList")}(value)?arrayFrom(value):Array.isArray(value)?value:arrayFrom(document.querySelectorAll(value))}function setTransitionDuration(els,value){els.forEach((function(el){el&&(el.style.transitionDuration=value+"ms")}))}function setVisibilityState(els,state){els.forEach((function(el){el&&el.setAttribute("data-state",state)}))}function getOwnerDocument(elementOrElements){var _element$ownerDocumen,element=normalizeToArray(elementOrElements)[0];return null!=element&&null!=(_element$ownerDocumen=element.ownerDocument)&&_element$ownerDocumen.body?element.ownerDocument:document}function updateTransitionEndListener(box,action,listener){var method=action+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(event){box[method](event,listener)}))}function actualContains(parent,child){for(var target=child;target;){var _target$getRootNode;if(parent.contains(target))return!0;target=null==target.getRootNode||null==(_target$getRootNode=target.getRootNode())?void 0:_target$getRootNode.host}return!1}var currentInput={isTouch:!1},lastMouseMoveTime=0;function onDocumentTouchStart(){currentInput.isTouch||(currentInput.isTouch=!0,window.performance&&document.addEventListener("mousemove",onDocumentMouseMove))}function onDocumentMouseMove(){var now=performance.now();now-lastMouseMoveTime<20&&(currentInput.isTouch=!1,document.removeEventListener("mousemove",onDocumentMouseMove)),lastMouseMoveTime=now}function onWindowBlur(){var activeElement=document.activeElement;if(isReferenceElement(activeElement)){var instance=activeElement._tippy;activeElement.blur&&!instance.state.isVisible&&activeElement.blur()}}var isIE11=!!("undefined"!=typeof window&&"undefined"!=typeof document)&&!!window.msCrypto;var pluginProps={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},defaultProps=Object.assign({appendTo:TIPPY_DEFAULT_APPEND_TO,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},pluginProps,{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),defaultKeys=Object.keys(defaultProps);function getExtendedPassedProps(passedProps){var pluginProps=(passedProps.plugins||[]).reduce((function(acc,plugin){var _name,name=plugin.name,defaultValue=plugin.defaultValue;name&&(acc[name]=void 0!==passedProps[name]?passedProps[name]:null!=(_name=defaultProps[name])?_name:defaultValue);return acc}),{});return Object.assign({},passedProps,pluginProps)}function evaluateProps(reference,props){var out=Object.assign({},props,{content:invokeWithArgsOrReturn(props.content,[reference])},props.ignoreAttributes?{}:function(reference,plugins){return(plugins?Object.keys(getExtendedPassedProps(Object.assign({},defaultProps,{plugins}))):defaultKeys).reduce((function(acc,key){var valueAsString=(reference.getAttribute("data-tippy-"+key)||"").trim();if(!valueAsString)return acc;if("content"===key)acc[key]=valueAsString;else try{acc[key]=JSON.parse(valueAsString)}catch(e){acc[key]=valueAsString}return acc}),{})}(reference,props.plugins));return out.aria=Object.assign({},defaultProps.aria,out.aria),out.aria={expanded:"auto"===out.aria.expanded?props.interactive:out.aria.expanded,content:"auto"===out.aria.content?props.interactive?null:"describedby":out.aria.content},out}var innerHTML=function(){return"innerHTML"};function dangerouslySetInnerHTML(element,html){element[innerHTML()]=html}function createArrowElement(value){var arrow=div();return!0===value?arrow.className=ARROW_CLASS:(arrow.className=SVG_ARROW_CLASS,tippy_esm_isElement(value)?arrow.appendChild(value):dangerouslySetInnerHTML(arrow,value)),arrow}function setContent(content,props){tippy_esm_isElement(props.content)?(dangerouslySetInnerHTML(content,""),content.appendChild(props.content)):"function"!=typeof props.content&&(props.allowHTML?dangerouslySetInnerHTML(content,props.content):content.textContent=props.content)}function getChildren(popper){var box=popper.firstElementChild,boxChildren=arrayFrom(box.children);return{box,content:boxChildren.find((function(node){return node.classList.contains(CONTENT_CLASS)})),arrow:boxChildren.find((function(node){return node.classList.contains(ARROW_CLASS)||node.classList.contains(SVG_ARROW_CLASS)})),backdrop:boxChildren.find((function(node){return node.classList.contains(BACKDROP_CLASS)}))}}function render(instance){var popper=div(),box=div();box.className="tippy-box",box.setAttribute("data-state","hidden"),box.setAttribute("tabindex","-1");var content=div();function onUpdate(prevProps,nextProps){var _getChildren=getChildren(popper),box=_getChildren.box,content=_getChildren.content,arrow=_getChildren.arrow;nextProps.theme?box.setAttribute("data-theme",nextProps.theme):box.removeAttribute("data-theme"),"string"==typeof nextProps.animation?box.setAttribute("data-animation",nextProps.animation):box.removeAttribute("data-animation"),nextProps.inertia?box.setAttribute("data-inertia",""):box.removeAttribute("data-inertia"),box.style.maxWidth="number"==typeof nextProps.maxWidth?nextProps.maxWidth+"px":nextProps.maxWidth,nextProps.role?box.setAttribute("role",nextProps.role):box.removeAttribute("role"),prevProps.content===nextProps.content&&prevProps.allowHTML===nextProps.allowHTML||setContent(content,instance.props),nextProps.arrow?arrow?prevProps.arrow!==nextProps.arrow&&(box.removeChild(arrow),box.appendChild(createArrowElement(nextProps.arrow))):box.appendChild(createArrowElement(nextProps.arrow)):arrow&&box.removeChild(arrow)}return content.className=CONTENT_CLASS,content.setAttribute("data-state","hidden"),setContent(content,instance.props),popper.appendChild(box),box.appendChild(content),onUpdate(instance.props,instance.props),{popper,onUpdate}}render.$$tippy=!0;var idCounter=1,mouseMoveListeners=[],mountedInstances=[];function createTippy(reference,passedProps){var showTimeout,hideTimeout,scheduleHideAnimationFrame,lastTriggerEvent,currentTransitionEndListener,onFirstUpdate,currentTarget,arr,props=evaluateProps(reference,Object.assign({},defaultProps,getExtendedPassedProps(removeUndefinedProps(passedProps)))),isVisibleFromClick=!1,didHideDueToDocumentMouseDown=!1,didTouchMove=!1,ignoreOnFirstUpdate=!1,listeners=[],debouncedOnMouseMove=tippy_esm_debounce(onMouseMove,props.interactiveDebounce),id=idCounter++,plugins=(arr=props.plugins).filter((function(item,index){return arr.indexOf(item)===index})),instance={id,reference,popper:div(),popperInstance:null,props,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins,clearDelayTimeouts:function(){clearTimeout(showTimeout),clearTimeout(hideTimeout),cancelAnimationFrame(scheduleHideAnimationFrame)},setProps:function(partialProps){0;if(instance.state.isDestroyed)return;invokeHook("onBeforeUpdate",[instance,partialProps]),removeListeners();var prevProps=instance.props,nextProps=evaluateProps(reference,Object.assign({},prevProps,removeUndefinedProps(partialProps),{ignoreAttributes:!0}));instance.props=nextProps,addListeners(),prevProps.interactiveDebounce!==nextProps.interactiveDebounce&&(cleanupInteractiveMouseListeners(),debouncedOnMouseMove=tippy_esm_debounce(onMouseMove,nextProps.interactiveDebounce));prevProps.triggerTarget&&!nextProps.triggerTarget?normalizeToArray(prevProps.triggerTarget).forEach((function(node){node.removeAttribute("aria-expanded")})):nextProps.triggerTarget&&reference.removeAttribute("aria-expanded");handleAriaExpandedAttribute(),handleStyles(),onUpdate&&onUpdate(prevProps,nextProps);instance.popperInstance&&(createPopperInstance(),getNestedPopperTree().forEach((function(nestedPopper){requestAnimationFrame(nestedPopper._tippy.popperInstance.forceUpdate)})));invokeHook("onAfterUpdate",[instance,partialProps])},setContent:function(content){instance.setProps({content})},show:function(){0;var isAlreadyVisible=instance.state.isVisible,isDestroyed=instance.state.isDestroyed,isDisabled=!instance.state.isEnabled,isTouchAndTouchDisabled=currentInput.isTouch&&!instance.props.touch,duration=getValueAtIndexOrReturn(instance.props.duration,0,defaultProps.duration);if(isAlreadyVisible||isDestroyed||isDisabled||isTouchAndTouchDisabled)return;if(getCurrentTarget().hasAttribute("disabled"))return;if(invokeHook("onShow",[instance],!1),!1===instance.props.onShow(instance))return;instance.state.isVisible=!0,getIsDefaultRenderFn()&&(popper.style.visibility="visible");handleStyles(),addDocumentPress(),instance.state.isMounted||(popper.style.transition="none");if(getIsDefaultRenderFn()){var _getDefaultTemplateCh2=getDefaultTemplateChildren();setTransitionDuration([_getDefaultTemplateCh2.box,_getDefaultTemplateCh2.content],0)}onFirstUpdate=function(){var _instance$popperInsta2;if(instance.state.isVisible&&!ignoreOnFirstUpdate){if(ignoreOnFirstUpdate=!0,popper.offsetHeight,popper.style.transition=instance.props.moveTransition,getIsDefaultRenderFn()&&instance.props.animation){var _getDefaultTemplateCh3=getDefaultTemplateChildren(),_box=_getDefaultTemplateCh3.box,_content=_getDefaultTemplateCh3.content;setTransitionDuration([_box,_content],duration),setVisibilityState([_box,_content],"visible")}handleAriaContentAttribute(),handleAriaExpandedAttribute(),pushIfUnique(mountedInstances,instance),null==(_instance$popperInsta2=instance.popperInstance)||_instance$popperInsta2.forceUpdate(),invokeHook("onMount",[instance]),instance.props.animation&&getIsDefaultRenderFn()&&function(duration,callback){onTransitionEnd(duration,callback)}(duration,(function(){instance.state.isShown=!0,invokeHook("onShown",[instance])}))}},function(){var parentNode,appendTo=instance.props.appendTo,node=getCurrentTarget();parentNode=instance.props.interactive&&appendTo===TIPPY_DEFAULT_APPEND_TO||"parent"===appendTo?node.parentNode:invokeWithArgsOrReturn(appendTo,[node]);parentNode.contains(popper)||parentNode.appendChild(popper);instance.state.isMounted=!0,createPopperInstance(),!1}()},hide:function(){0;var isAlreadyHidden=!instance.state.isVisible,isDestroyed=instance.state.isDestroyed,isDisabled=!instance.state.isEnabled,duration=getValueAtIndexOrReturn(instance.props.duration,1,defaultProps.duration);if(isAlreadyHidden||isDestroyed||isDisabled)return;if(invokeHook("onHide",[instance],!1),!1===instance.props.onHide(instance))return;instance.state.isVisible=!1,instance.state.isShown=!1,ignoreOnFirstUpdate=!1,isVisibleFromClick=!1,getIsDefaultRenderFn()&&(popper.style.visibility="hidden");if(cleanupInteractiveMouseListeners(),removeDocumentPress(),handleStyles(!0),getIsDefaultRenderFn()){var _getDefaultTemplateCh4=getDefaultTemplateChildren(),box=_getDefaultTemplateCh4.box,content=_getDefaultTemplateCh4.content;instance.props.animation&&(setTransitionDuration([box,content],duration),setVisibilityState([box,content],"hidden"))}handleAriaContentAttribute(),handleAriaExpandedAttribute(),instance.props.animation?getIsDefaultRenderFn()&&function(duration,callback){onTransitionEnd(duration,(function(){!instance.state.isVisible&&popper.parentNode&&popper.parentNode.contains(popper)&&callback()}))}(duration,instance.unmount):instance.unmount()},hideWithInteractivity:function(event){0;getDocument().addEventListener("mousemove",debouncedOnMouseMove),pushIfUnique(mouseMoveListeners,debouncedOnMouseMove),debouncedOnMouseMove(event)},enable:function(){instance.state.isEnabled=!0},disable:function(){instance.hide(),instance.state.isEnabled=!1},unmount:function(){0;instance.state.isVisible&&instance.hide();if(!instance.state.isMounted)return;destroyPopperInstance(),getNestedPopperTree().forEach((function(nestedPopper){nestedPopper._tippy.unmount()})),popper.parentNode&&popper.parentNode.removeChild(popper);mountedInstances=mountedInstances.filter((function(i){return i!==instance})),instance.state.isMounted=!1,invokeHook("onHidden",[instance])},destroy:function(){0;if(instance.state.isDestroyed)return;instance.clearDelayTimeouts(),instance.unmount(),removeListeners(),delete reference._tippy,instance.state.isDestroyed=!0,invokeHook("onDestroy",[instance])}};if(!props.render)return instance;var _props$render=props.render(instance),popper=_props$render.popper,onUpdate=_props$render.onUpdate;popper.setAttribute("data-tippy-root",""),popper.id="tippy-"+instance.id,instance.popper=popper,reference._tippy=instance,popper._tippy=instance;var pluginsHooks=plugins.map((function(plugin){return plugin.fn(instance)})),hasAriaExpanded=reference.hasAttribute("aria-expanded");return addListeners(),handleAriaExpandedAttribute(),handleStyles(),invokeHook("onCreate",[instance]),props.showOnCreate&&scheduleShow(),popper.addEventListener("mouseenter",(function(){instance.props.interactive&&instance.state.isVisible&&instance.clearDelayTimeouts()})),popper.addEventListener("mouseleave",(function(){instance.props.interactive&&instance.props.trigger.indexOf("mouseenter")>=0&&getDocument().addEventListener("mousemove",debouncedOnMouseMove)})),instance;function getNormalizedTouchSettings(){var touch=instance.props.touch;return Array.isArray(touch)?touch:[touch,0]}function getIsCustomTouchBehavior(){return"hold"===getNormalizedTouchSettings()[0]}function getIsDefaultRenderFn(){var _instance$props$rende;return!(null==(_instance$props$rende=instance.props.render)||!_instance$props$rende.$$tippy)}function getCurrentTarget(){return currentTarget||reference}function getDocument(){var parent=getCurrentTarget().parentNode;return parent?getOwnerDocument(parent):document}function getDefaultTemplateChildren(){return getChildren(popper)}function getDelay(isShow){return instance.state.isMounted&&!instance.state.isVisible||currentInput.isTouch||lastTriggerEvent&&"focus"===lastTriggerEvent.type?0:getValueAtIndexOrReturn(instance.props.delay,isShow?0:1,defaultProps.delay)}function handleStyles(fromHide){void 0===fromHide&&(fromHide=!1),popper.style.pointerEvents=instance.props.interactive&&!fromHide?"":"none",popper.style.zIndex=""+instance.props.zIndex}function invokeHook(hook,args,shouldInvokePropsHook){var _instance$props;(void 0===shouldInvokePropsHook&&(shouldInvokePropsHook=!0),pluginsHooks.forEach((function(pluginHooks){pluginHooks[hook]&&pluginHooks[hook].apply(pluginHooks,args)})),shouldInvokePropsHook)&&(_instance$props=instance.props)[hook].apply(_instance$props,args)}function handleAriaContentAttribute(){var aria=instance.props.aria;if(aria.content){var attr="aria-"+aria.content,id=popper.id;normalizeToArray(instance.props.triggerTarget||reference).forEach((function(node){var currentValue=node.getAttribute(attr);if(instance.state.isVisible)node.setAttribute(attr,currentValue?currentValue+" "+id:id);else{var nextValue=currentValue&&currentValue.replace(id,"").trim();nextValue?node.setAttribute(attr,nextValue):node.removeAttribute(attr)}}))}}function handleAriaExpandedAttribute(){!hasAriaExpanded&&instance.props.aria.expanded&&normalizeToArray(instance.props.triggerTarget||reference).forEach((function(node){instance.props.interactive?node.setAttribute("aria-expanded",instance.state.isVisible&&node===getCurrentTarget()?"true":"false"):node.removeAttribute("aria-expanded")}))}function cleanupInteractiveMouseListeners(){getDocument().removeEventListener("mousemove",debouncedOnMouseMove),mouseMoveListeners=mouseMoveListeners.filter((function(listener){return listener!==debouncedOnMouseMove}))}function onDocumentPress(event){if(!currentInput.isTouch||!didTouchMove&&"mousedown"!==event.type){var actualTarget=event.composedPath&&event.composedPath()[0]||event.target;if(!instance.props.interactive||!actualContains(popper,actualTarget)){if(normalizeToArray(instance.props.triggerTarget||reference).some((function(el){return actualContains(el,actualTarget)}))){if(currentInput.isTouch)return;if(instance.state.isVisible&&instance.props.trigger.indexOf("click")>=0)return}else invokeHook("onClickOutside",[instance,event]);!0===instance.props.hideOnClick&&(instance.clearDelayTimeouts(),instance.hide(),didHideDueToDocumentMouseDown=!0,setTimeout((function(){didHideDueToDocumentMouseDown=!1})),instance.state.isMounted||removeDocumentPress())}}}function onTouchMove(){didTouchMove=!0}function onTouchStart(){didTouchMove=!1}function addDocumentPress(){var doc=getDocument();doc.addEventListener("mousedown",onDocumentPress,!0),doc.addEventListener("touchend",onDocumentPress,TOUCH_OPTIONS),doc.addEventListener("touchstart",onTouchStart,TOUCH_OPTIONS),doc.addEventListener("touchmove",onTouchMove,TOUCH_OPTIONS)}function removeDocumentPress(){var doc=getDocument();doc.removeEventListener("mousedown",onDocumentPress,!0),doc.removeEventListener("touchend",onDocumentPress,TOUCH_OPTIONS),doc.removeEventListener("touchstart",onTouchStart,TOUCH_OPTIONS),doc.removeEventListener("touchmove",onTouchMove,TOUCH_OPTIONS)}function onTransitionEnd(duration,callback){var box=getDefaultTemplateChildren().box;function listener(event){event.target===box&&(updateTransitionEndListener(box,"remove",listener),callback())}if(0===duration)return callback();updateTransitionEndListener(box,"remove",currentTransitionEndListener),updateTransitionEndListener(box,"add",listener),currentTransitionEndListener=listener}function on(eventType,handler,options){void 0===options&&(options=!1),normalizeToArray(instance.props.triggerTarget||reference).forEach((function(node){node.addEventListener(eventType,handler,options),listeners.push({node,eventType,handler,options})}))}function addListeners(){var value;getIsCustomTouchBehavior()&&(on("touchstart",onTrigger,{passive:!0}),on("touchend",onMouseLeave,{passive:!0})),(value=instance.props.trigger,value.split(/\s+/).filter(Boolean)).forEach((function(eventType){if("manual"!==eventType)switch(on(eventType,onTrigger),eventType){case"mouseenter":on("mouseleave",onMouseLeave);break;case"focus":on(isIE11?"focusout":"blur",onBlurOrFocusOut);break;case"focusin":on("focusout",onBlurOrFocusOut)}}))}function removeListeners(){listeners.forEach((function(_ref){var node=_ref.node,eventType=_ref.eventType,handler=_ref.handler,options=_ref.options;node.removeEventListener(eventType,handler,options)})),listeners=[]}function onTrigger(event){var _lastTriggerEvent,shouldScheduleClickHide=!1;if(instance.state.isEnabled&&!isEventListenerStopped(event)&&!didHideDueToDocumentMouseDown){var wasFocused="focus"===(null==(_lastTriggerEvent=lastTriggerEvent)?void 0:_lastTriggerEvent.type);lastTriggerEvent=event,currentTarget=event.currentTarget,handleAriaExpandedAttribute(),!instance.state.isVisible&&isMouseEvent(event)&&mouseMoveListeners.forEach((function(listener){return listener(event)})),"click"===event.type&&(instance.props.trigger.indexOf("mouseenter")<0||isVisibleFromClick)&&!1!==instance.props.hideOnClick&&instance.state.isVisible?shouldScheduleClickHide=!0:scheduleShow(event),"click"===event.type&&(isVisibleFromClick=!shouldScheduleClickHide),shouldScheduleClickHide&&!wasFocused&&scheduleHide(event)}}function onMouseMove(event){var target=event.target,isCursorOverReferenceOrPopper=getCurrentTarget().contains(target)||popper.contains(target);if("mousemove"!==event.type||!isCursorOverReferenceOrPopper){var popperTreeData=getNestedPopperTree().concat(popper).map((function(popper){var _instance$popperInsta,state=null==(_instance$popperInsta=popper._tippy.popperInstance)?void 0:_instance$popperInsta.state;return state?{popperRect:popper.getBoundingClientRect(),popperState:state,props}:null})).filter(Boolean);(function(popperTreeData,event){var clientX=event.clientX,clientY=event.clientY;return popperTreeData.every((function(_ref){var popperRect=_ref.popperRect,popperState=_ref.popperState,interactiveBorder=_ref.props.interactiveBorder,basePlacement=tippy_esm_getBasePlacement(popperState.placement),offsetData=popperState.modifiersData.offset;if(!offsetData)return!0;var topDistance="bottom"===basePlacement?offsetData.top.y:0,bottomDistance="top"===basePlacement?offsetData.bottom.y:0,leftDistance="right"===basePlacement?offsetData.left.x:0,rightDistance="left"===basePlacement?offsetData.right.x:0,exceedsTop=popperRect.top-clientY+topDistance>interactiveBorder,exceedsBottom=clientY-popperRect.bottom-bottomDistance>interactiveBorder,exceedsLeft=popperRect.left-clientX+leftDistance>interactiveBorder,exceedsRight=clientX-popperRect.right-rightDistance>interactiveBorder;return exceedsTop||exceedsBottom||exceedsLeft||exceedsRight}))})(popperTreeData,event)&&(cleanupInteractiveMouseListeners(),scheduleHide(event))}}function onMouseLeave(event){isEventListenerStopped(event)||instance.props.trigger.indexOf("click")>=0&&isVisibleFromClick||(instance.props.interactive?instance.hideWithInteractivity(event):scheduleHide(event))}function onBlurOrFocusOut(event){instance.props.trigger.indexOf("focusin")<0&&event.target!==getCurrentTarget()||instance.props.interactive&&event.relatedTarget&&popper.contains(event.relatedTarget)||scheduleHide(event)}function isEventListenerStopped(event){return!!currentInput.isTouch&&getIsCustomTouchBehavior()!==event.type.indexOf("touch")>=0}function createPopperInstance(){destroyPopperInstance();var _instance$props2=instance.props,popperOptions=_instance$props2.popperOptions,placement=_instance$props2.placement,offset=_instance$props2.offset,getReferenceClientRect=_instance$props2.getReferenceClientRect,moveTransition=_instance$props2.moveTransition,arrow=getIsDefaultRenderFn()?getChildren(popper).arrow:null,computedReference=getReferenceClientRect?{getBoundingClientRect:getReferenceClientRect,contextElement:getReferenceClientRect.contextElement||getCurrentTarget()}:reference,tippyModifier={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(_ref2){var state=_ref2.state;if(getIsDefaultRenderFn()){var box=getDefaultTemplateChildren().box;["placement","reference-hidden","escaped"].forEach((function(attr){"placement"===attr?box.setAttribute("data-placement",state.placement):state.attributes.popper["data-popper-"+attr]?box.setAttribute("data-"+attr,""):box.removeAttribute("data-"+attr)})),state.attributes.popper={}}}},modifiers=[{name:"offset",options:{offset}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!moveTransition}},tippyModifier];getIsDefaultRenderFn()&&arrow&&modifiers.push({name:"arrow",options:{element:arrow,padding:3}}),modifiers.push.apply(modifiers,(null==popperOptions?void 0:popperOptions.modifiers)||[]),instance.popperInstance=popper_createPopper(computedReference,popper,Object.assign({},popperOptions,{placement,onFirstUpdate,modifiers}))}function destroyPopperInstance(){instance.popperInstance&&(instance.popperInstance.destroy(),instance.popperInstance=null)}function getNestedPopperTree(){return arrayFrom(popper.querySelectorAll("[data-tippy-root]"))}function scheduleShow(event){instance.clearDelayTimeouts(),event&&invokeHook("onTrigger",[instance,event]),addDocumentPress();var delay=getDelay(!0),_getNormalizedTouchSe=getNormalizedTouchSettings(),touchValue=_getNormalizedTouchSe[0],touchDelay=_getNormalizedTouchSe[1];currentInput.isTouch&&"hold"===touchValue&&touchDelay&&(delay=touchDelay),delay?showTimeout=setTimeout((function(){instance.show()}),delay):instance.show()}function scheduleHide(event){if(instance.clearDelayTimeouts(),invokeHook("onUntrigger",[instance,event]),instance.state.isVisible){if(!(instance.props.trigger.indexOf("mouseenter")>=0&&instance.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(event.type)>=0&&isVisibleFromClick)){var delay=getDelay(!1);delay?hideTimeout=setTimeout((function(){instance.state.isVisible&&instance.hide()}),delay):scheduleHideAnimationFrame=requestAnimationFrame((function(){instance.hide()}))}}else removeDocumentPress()}}function tippy(targets,optionalProps){void 0===optionalProps&&(optionalProps={});var plugins=defaultProps.plugins.concat(optionalProps.plugins||[]);document.addEventListener("touchstart",onDocumentTouchStart,TOUCH_OPTIONS),window.addEventListener("blur",onWindowBlur);var passedProps=Object.assign({},optionalProps,{plugins}),instances=getArrayOfElements(targets).reduce((function(acc,reference){var instance=reference&&createTippy(reference,passedProps);return instance&&acc.push(instance),acc}),[]);return tippy_esm_isElement(targets)?instances[0]:instances}tippy.defaultProps=defaultProps,tippy.setDefaultProps=function(partialProps){Object.keys(partialProps).forEach((function(key){defaultProps[key]=partialProps[key]}))},tippy.currentInput=currentInput;Object.assign({},modifiers_applyStyles,{effect:function(_ref){var state=_ref.state,initialStyles={popper:{position:state.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(state.elements.popper.style,initialStyles.popper),state.styles=initialStyles,state.elements.arrow&&Object.assign(state.elements.arrow.style,initialStyles.arrow)}});tippy.setDefaultProps({render});const tippy_esm=tippy;function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}var tippy_react_esm_isBrowser="undefined"!=typeof window&&"undefined"!=typeof document;function preserveRef(ref,node){ref&&("function"==typeof ref&&ref(node),{}.hasOwnProperty.call(ref,"current")&&(ref.current=node))}function ssrSafeCreateDiv(){return tippy_react_esm_isBrowser&&document.createElement("div")}function deepEqual(x,y){if(x===y)return!0;if("object"==typeof x&&null!=x&&"object"==typeof y&&null!=y){if(Object.keys(x).length!==Object.keys(y).length)return!1;for(var prop in x){if(!y.hasOwnProperty(prop))return!1;if(!deepEqual(x[prop],y[prop]))return!1}return!0}return!1}function uniqueByShape(arr){var output=[];return arr.forEach((function(item){output.find((function(outputItem){return deepEqual(item,outputItem)}))||output.push(item)})),output}function deepPreserveProps(instanceProps,componentProps){var _instanceProps$popper,_componentProps$poppe;return Object.assign({},componentProps,{popperOptions:Object.assign({},instanceProps.popperOptions,componentProps.popperOptions,{modifiers:uniqueByShape([].concat((null==(_instanceProps$popper=instanceProps.popperOptions)?void 0:_instanceProps$popper.modifiers)||[],(null==(_componentProps$poppe=componentProps.popperOptions)?void 0:_componentProps$poppe.modifiers)||[]))})})}var tippy_react_esm_useIsomorphicLayoutEffect=tippy_react_esm_isBrowser?external_window_React_unsafeWindow_React_.useLayoutEffect:external_window_React_unsafeWindow_React_.useEffect;function useMutableBox(initialValue){var ref=(0,external_window_React_unsafeWindow_React_.useRef)();return ref.current||(ref.current="function"==typeof initialValue?initialValue():initialValue),ref.current}function updateClassName(box,action,classNames){classNames.split(/\s+/).forEach((function(name){name&&box.classList[action](name)}))}var classNamePlugin={name:"className",defaultValue:"",fn:function(instance){var box=instance.popper.firstElementChild,isDefaultRenderFn=function(){var _instance$props$rende;return!!(null==(_instance$props$rende=instance.props.render)?void 0:_instance$props$rende.$$tippy)};function add(){instance.props.className&&!isDefaultRenderFn()||updateClassName(box,"add",instance.props.className)}return{onCreate:add,onBeforeUpdate:function(){isDefaultRenderFn()&&updateClassName(box,"remove",instance.props.className)},onAfterUpdate:add}}};function TippyGenerator(tippy){return function(_ref){var children=_ref.children,content=_ref.content,visible=_ref.visible,singleton=_ref.singleton,render=_ref.render,reference=_ref.reference,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,_ref$ignoreAttributes=_ref.ignoreAttributes,ignoreAttributes=void 0===_ref$ignoreAttributes||_ref$ignoreAttributes,restOfNativeProps=(_ref.__source,_ref.__self,_objectWithoutPropertiesLoose(_ref,["children","content","visible","singleton","render","reference","disabled","ignoreAttributes","__source","__self"])),isControlledMode=void 0!==visible,isSingletonMode=void 0!==singleton,_useState=(0,external_window_React_unsafeWindow_React_.useState)(!1),mounted=_useState[0],setMounted=_useState[1],_useState2=(0,external_window_React_unsafeWindow_React_.useState)({}),attrs=_useState2[0],setAttrs=_useState2[1],_useState3=(0,external_window_React_unsafeWindow_React_.useState)(),singletonContent=_useState3[0],setSingletonContent=_useState3[1],mutableBox=useMutableBox((function(){return{container:ssrSafeCreateDiv(),renders:1}})),props=Object.assign({ignoreAttributes},restOfNativeProps,{content:mutableBox.container});isControlledMode&&(props.trigger="manual",props.hideOnClick=!1),isSingletonMode&&(disabled=!0);var computedProps=props,plugins=props.plugins||[];render&&(computedProps=Object.assign({},props,{plugins:isSingletonMode&&null!=singleton.data?[].concat(plugins,[{fn:function(){return{onTrigger:function(instance,event){var node=singleton.data.children.find((function(_ref2){return _ref2.instance.reference===event.currentTarget}));instance.state.$$activeSingletonInstance=node.instance,setSingletonContent(node.content)}}}}]):plugins,render:function(){return{popper:mutableBox.container}}}));var deps=[reference].concat(children?[children.type]:[]);return tippy_react_esm_useIsomorphicLayoutEffect((function(){var element=reference;reference&&reference.hasOwnProperty("current")&&(element=reference.current);var instance=tippy(element||mutableBox.ref||ssrSafeCreateDiv(),Object.assign({},computedProps,{plugins:[classNamePlugin].concat(props.plugins||[])}));return mutableBox.instance=instance,disabled&&instance.disable(),visible&&instance.show(),isSingletonMode&&singleton.hook({instance,content,props:computedProps,setSingletonContent}),setMounted(!0),function(){instance.destroy(),null==singleton||singleton.cleanup(instance)}}),deps),tippy_react_esm_useIsomorphicLayoutEffect((function(){var _instance$popperInsta;if(1!==mutableBox.renders){var instance=mutableBox.instance;instance.setProps(deepPreserveProps(instance.props,computedProps)),null==(_instance$popperInsta=instance.popperInstance)||_instance$popperInsta.forceUpdate(),disabled?instance.disable():instance.enable(),isControlledMode&&(visible?instance.show():instance.hide()),isSingletonMode&&singleton.hook({instance,content,props:computedProps,setSingletonContent})}else mutableBox.renders++})),tippy_react_esm_useIsomorphicLayoutEffect((function(){var _instance$props$poppe;if(render){var instance=mutableBox.instance;instance.setProps({popperOptions:Object.assign({},instance.props.popperOptions,{modifiers:[].concat(((null==(_instance$props$poppe=instance.props.popperOptions)?void 0:_instance$props$poppe.modifiers)||[]).filter((function(_ref3){return"$$tippyReact"!==_ref3.name})),[{name:"$$tippyReact",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(_ref4){var _state$modifiersData,state=_ref4.state,hideData=null==(_state$modifiersData=state.modifiersData)?void 0:_state$modifiersData.hide;attrs.placement===state.placement&&attrs.referenceHidden===(null==hideData?void 0:hideData.isReferenceHidden)&&attrs.escaped===(null==hideData?void 0:hideData.hasPopperEscaped)||setAttrs({placement:state.placement,referenceHidden:null==hideData?void 0:hideData.isReferenceHidden,escaped:null==hideData?void 0:hideData.hasPopperEscaped}),state.attributes.popper={}}}])})})}}),[attrs.placement,attrs.referenceHidden,attrs.escaped].concat(deps)),external_window_React_unsafeWindow_React_default().createElement(external_window_React_unsafeWindow_React_default().Fragment,null,children?(0,external_window_React_unsafeWindow_React_.cloneElement)(children,{ref:function(node){mutableBox.ref=node,preserveRef(children.ref,node)}}):null,mounted&&(0,external_window_ReactDOM_unsafeWindow_ReactDOM_namespaceObject.createPortal)(render?render(function(attrs){var dataAttrs={"data-placement":attrs.placement};return attrs.referenceHidden&&(dataAttrs["data-reference-hidden"]=""),attrs.escaped&&(dataAttrs["data-escaped"]=""),dataAttrs}(attrs),singletonContent,mutableBox.instance):content,mutableBox.container))}}var forwardRef=function(Tippy,defaultProps){return(0,external_window_React_unsafeWindow_React_.forwardRef)((function(_ref,_ref2){var children=_ref.children,props=_objectWithoutPropertiesLoose(_ref,["children"]);return external_window_React_unsafeWindow_React_default().createElement(Tippy,Object.assign({},defaultProps,props),children?(0,external_window_React_unsafeWindow_React_.cloneElement)(children,{ref:function(node){preserveRef(_ref2,node),preserveRef(children.ref,node)}}):null)}))};const tippy_react_esm=forwardRef(TippyGenerator(tippy_esm));function TippyModal_extends(){return TippyModal_extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},TippyModal_extends.apply(this,arguments)}function TippyModal({children,...rest}){return React.createElement(tippy_react_esm,TippyModal_extends({content:children},rest))}function TippyAtPoint_extends(){return TippyAtPoint_extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},TippyAtPoint_extends.apply(this,arguments)}function TippyAtPoint(props){const{point,map=(0,get_wme_window.B)().W.map,...restProps}=props,getRefClientRect=(0,external_window_React_unsafeWindow_React_.useCallback)((()=>{const mapBoundingRect=map.getViewport().getBoundingClientRect(),rectangle=function(coords,map=(0,get_wme_window.B)().W.map){const[lon,lat]=coords.coordinates,pixel=map.getPixelFromLonLat({lon,lat});return new DOMRect(pixel.x,pixel.y,1,1)}("function"==typeof point?point():point,map);return{...rectangle.toJSON(),left:rectangle.left+mapBoundingRect.x,top:rectangle.top+mapBoundingRect.y}}),[map,point]);return React.createElement(TippyModal,TippyAtPoint_extends({getReferenceClientRect:getRefClientRect},restProps))}function TippyAtMapEntity_extends(){return TippyAtMapEntity_extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},TippyAtMapEntity_extends.apply(this,arguments)}function TippyAtMapEntity(props){const{entity,centerType="mass",...restProps}=props,getCenterFn={mass:center_of_mass_dist_es,normal:center_dist_es}[centerType],getEntityCenterPoint=(0,external_window_React_unsafeWindow_React_.useCallback)((()=>{const geometry=entity.getAttribute("geoJSONGeometry");return getCenterFn(geometry).geometry}),[entity,getCenterFn]);return React.createElement(TippyAtPoint,TippyAtMapEntity_extends({point:getEntityCenterPoint},restProps))}TippyModal.displayName=createTippyDisplayName("Modal"),TippyAtPoint.displayName=createTippyDisplayName("AtPoint"),TippyAtMapEntity.displayName=createTippyDisplayName("AtMapEntity");var wz_intrinsic_element_components_Waze,jsx_runtime=__webpack_require__(274);function camelToDashCase(value){return value.replace(/([A-Z])/g,(capitalLetter=>`-${capitalLetter.toLowerCase()}`))}function attachPropsToDOMElement(element,newProps,oldProps){const modifiedClassName=function(classList,newProps,oldProps){const includeClassNames=newProps.className||newProps.class,excludeClassNames=oldProps.className||oldProps.class,classListTokenSet=new Set(classList),includeClassNamesSet=new Set(includeClassNames?.split?.(" ")??[]),excludeClassNamesSet=new Set(excludeClassNames?.split?.(" ")??[]),classNamesToJoin=[];return classListTokenSet.forEach((token=>{includeClassNamesSet.has(token)?(classNamesToJoin.push(token),includeClassNamesSet.delete(token)):excludeClassNamesSet.has(token)||classNamesToJoin.push(token)})),includeClassNamesSet.forEach((className=>classNamesToJoin.push(className))),classNamesToJoin.join(" ")}(element.classList,newProps,oldProps);modifiedClassName&&(element.className=modifiedClassName),Object.keys(newProps).forEach((propKey=>{if("children"===propKey||"style"===propKey||"ref"===propKey||"class"===propKey||"className"===propKey||"forwardedRef"===propKey)return;const propValue=newProps[propKey];if(propKey.startsWith("on")&&propKey[2]===propKey[2].toUpperCase()){const eventName=propKey.substring(2),normalizedEventName=eventName.charAt(0).toLowerCase()+eventName.substring(1);isEventCoveredByReact(normalizedEventName)||function(element,eventName,eventHandler){const eventsRepository=element.__events||(element.__events={}),registeredEventHandler=eventsRepository[eventName];registeredEventHandler&&element.removeEventListener(eventName,registeredEventHandler);const newEventHandler=function(event){eventHandler?.call(this,event)};eventsRepository[eventName]=newEventHandler,element.addEventListener(eventName,newEventHandler)}(element,normalizedEventName,propValue)}else if(element[propKey]=propValue,"string"==typeof propValue){const attributeName=camelToDashCase(propKey);element.setAttribute(attributeName,propValue)}}))}function isEventCoveredByReact(eventName){if("undefined"==typeof document)return!0;const properEventName=function(eventName){return"doubleclick"===eventName?"dblclick":eventName}(eventName),properEventPropertyName="on"+properEventName;if(properEventPropertyName in document)return!0;const dummyElement=document.createElement("div");return dummyElement.setAttribute(properEventPropertyName,"return;"),"function"==typeof dummyElement[properEventPropertyName]}function mergeRefs(...refs){return newValue=>{refs.forEach((ref=>function(ref,value){if(ref)return"function"==typeof ref?ref(value):void(ref.current=value)}(ref,newValue)))}}function getReactDisplayName(component){return"string"==typeof component?component:"function"==typeof component?component.displayName?component.displayName:component.name?component.name:void 0:component.render?getReactDisplayName(component.render):void 0}function createForwardRef(component){const render=(props,ref)=>(0,external_window_React_unsafeWindow_React_.createElement)(component,{...props,forwardedRef:ref});return render.displayName=getReactDisplayName(component),(0,external_window_React_unsafeWindow_React_.forwardRef)(render)}function createReactComponent(elementTag){const componentName=elementTag.toLowerCase().split("-").map((component=>component.charAt(0).toUpperCase()+component.slice(1))).join("");const ElementComponent=class extends external_window_React_unsafeWindow_React_.Component{componentElement=null;setComponentElement=element=>this.componentElement=element;componentDidMount(){this.componentDidUpdate?.(this.props)}componentDidUpdate(prevProps){this.componentElement&&attachPropsToDOMElement(this.componentElement,this.props,prevProps)}render(){const{children,forwardedRef,style,className,ref,...otherProps}=this.props,slotsContent=new Map,processedProps=Object.keys(otherProps).reduce(((accumulatedProps,propName)=>{const propValue=otherProps[propName];if(0===propName.indexOf("on")&&propName[2]===propName[2].toUpperCase()){const eventName=propName.substring(2).toLowerCase();"undefined"!=typeof document&&isEventCoveredByReact(eventName)&&(accumulatedProps[propName]=propValue)}else if("slot"!==propName.toLowerCase()&&propName.startsWith("slot")&&propName[4]===propName[4].toUpperCase()){const originalSlotName=function(value){return camelToDashCase(value[0].toLowerCase()+value.substring(1))}(propName.substring(4));slotsContent.set(originalSlotName,propValue)}else{const valueType=typeof propValue;"string"!==valueType&&"boolean"!==valueType&&"number"!==valueType||(accumulatedProps[camelToDashCase(propName)]=propValue)}return accumulatedProps}),{}),finalProps={...processedProps,style,ref:mergeRefs(forwardedRef,this.setComponentElement)},elementChildren=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[children,Array.from(slotsContent.keys()).map((slotName=>{const slotValue=slotsContent.get(slotName);return slotValue?external_window_React_unsafeWindow_React_default().cloneElement(slotValue,{...slotValue?.props,slot:slotName}):null}))]});return external_window_React_unsafeWindow_React_default().createElement(elementTag,finalProps,elementChildren)}static get displayName(){return componentName}};return createForwardRef(ElementComponent)}!function(Waze){!function(IntrinsicElements){IntrinsicElements.WzAnchor=createReactComponent("wz-a"),IntrinsicElements.WzAlert=createReactComponent("wz-alert"),IntrinsicElements.WzAlertDismiss=createReactComponent("wz-alert-dismiss"),IntrinsicElements.WzAlertPagination=createReactComponent("wz-alert-pagination"),IntrinsicElements.WzAlertsGroup=createReactComponent("wz-alerts-group"),IntrinsicElements.WzBadge=createReactComponent("wz-badge"),IntrinsicElements.WzButton=createReactComponent("wz-button"),IntrinsicElements.WzCaption=createReactComponent("wz-caption"),IntrinsicElements.WzOverline=createReactComponent("wz-overline"),IntrinsicElements.WzLabel=createReactComponent("wz-label"),IntrinsicElements.WzCard=createReactComponent("wz-card"),IntrinsicElements.WzCheckableChip=createReactComponent("wz-checkable-chip"),IntrinsicElements.WzChipSelect=createReactComponent("wz-chip-select"),IntrinsicElements.WzChipMultiSelect=createReactComponent("wz-chip-multi-select"),IntrinsicElements.WzCheckbox=createReactComponent("wz-checkbox"),IntrinsicElements.WzIcon=createReactComponent("wz-icon"),IntrinsicElements.WzSectionHeader=createReactComponent("wz-section-header")}(Waze.IntrinsicElements||(Waze.IntrinsicElements={}))}(wz_intrinsic_element_components_Waze||(wz_intrinsic_element_components_Waze={}));wz_intrinsic_element_components_Waze.IntrinsicElements.WzAnchor;function WzAlert(props){const directAlertProps=function(obj,keysToExtract){const extractedObject={};return keysToExtract.forEach((key=>{extractedObject[key]=obj[key]})),extractedObject}(props,["variant","level","multiline"]);return(0,jsx_runtime.jsx)(wz_intrinsic_element_components_Waze.IntrinsicElements.WzAlert,{...directAlertProps,slotIcon:props.customIcon,slotDismiss:props.dismissText?(0,jsx_runtime.jsx)("span",{children:props.dismissText}):void 0,slotAction:props.actionText?(0,jsx_runtime.jsx)("span",{children:props.actionText}):void 0,onAlertDismissed:props.onDismiss,onActionClicked:props.onAction,children:(0,jsx_runtime.jsx)("div",{className:"sidebar-alert-content",children:props.children})})}wz_intrinsic_element_components_Waze.IntrinsicElements.WzAlertDismiss,wz_intrinsic_element_components_Waze.IntrinsicElements.WzAlertPagination,wz_intrinsic_element_components_Waze.IntrinsicElements.WzAlertsGroup;function supportReactEvents(component){const componentWithEvents=class extends external_window_React_unsafeWindow_React_.Component{handleOnChange=this.createEventHandler("change");handleOnClick=this.createEventHandler("click");elementRef=(0,external_window_React_unsafeWindow_React_.createRef)();constructor(props){super(props)}createEventHandler(eventName){return event=>{const propName=`on${value=eventName,value[0].toUpperCase()+value.slice(1)}`;var value;"function"==typeof this.props[propName]&&this.props[propName]?.(event)}}get elementFromRef(){return this.elementRef.current}componentDidMount(){this.elementFromRef&&(this.elementFromRef.addEventListener("change",this.handleOnChange),this.elementFromRef.addEventListener("click",this.handleOnClick))}componentWillUnmount(){this.elementFromRef&&(this.elementFromRef.removeEventListener("change",this.handleOnChange),this.elementFromRef.removeEventListener("click",this.handleOnClick))}render(){const nonReactiveProps=function(obj,keysToOmit){const keysToOmitSet=new Set(keysToOmit),omittedObject={};return Object.keys(obj).forEach((key=>{keysToOmitSet.has(key)||(omittedObject[key]=obj[key])})),omittedObject}(this.props,["onChange","onClick","children"]);return(0,external_window_React_unsafeWindow_React_.createElement)(component,{ref:mergeRefs(this.elementRef,this.props.forwardedRef),...nonReactiveProps},this.props.children)}};return componentWithEvents.displayName=`WithReactEvents(${getReactDisplayName(component)})`,createForwardRef(componentWithEvents)}const WzButton=supportReactEvents(wz_intrinsic_element_components_Waze.IntrinsicElements.WzButton),WzCaption=supportReactEvents(wz_intrinsic_element_components_Waze.IntrinsicElements.WzCaption),WzCard=(wz_intrinsic_element_components_Waze.IntrinsicElements.WzOverline,wz_intrinsic_element_components_Waze.IntrinsicElements.WzLabel,wz_intrinsic_element_components_Waze.IntrinsicElements.WzCard);function WzTooltip({children,tooltipContent}){return(0,jsx_runtime.jsxs)("wz-basic-tooltip",{children:[(0,jsx_runtime.jsx)("wz-tooltip-source",{children}),(0,jsx_runtime.jsx)("wz-tooltip-target",{}),(0,jsx_runtime.jsx)("wz-tooltip-content",{children:tooltipContent})]})}wz_intrinsic_element_components_Waze.IntrinsicElements.WzCheckableChip,wz_intrinsic_element_components_Waze.IntrinsicElements.WzChipSelect,wz_intrinsic_element_components_Waze.IntrinsicElements.WzChipMultiSelect;const WzCheckbox=supportReactEvents(wz_intrinsic_element_components_Waze.IntrinsicElements.WzCheckbox),WzSectionHeader=(wz_intrinsic_element_components_Waze.IntrinsicElements.WzIcon,wz_intrinsic_element_components_Waze.IntrinsicElements.WzSectionHeader);function ConfirmBalloon(props){const t=useTranslate(),dontShowAgainRef=(0,external_window_React_unsafeWindow_React_.useRef)(),{TippyComponent,tippyProps,title,details,alarming=!1,disableDontShowAgainCheckbox=!1,confirmButtonText=t("edit.apply"),cancelButtonText=t("edit.cancel"),onConfirmClick,onCancelClick}=props,createUserResponseHandler=(callback,overridenDontShowAgain)=>()=>callback?.(!disableDontShowAgainCheckbox&&(overridenDontShowAgain??dontShowAgainRef.current.checked));return(0,external_window_React_unsafeWindow_React_.createElement)(TippyComponent,{theme:"light",trigger:"manual",appendTo:document.body,arrow:!0,interactive:!0,showOnCreate:!0,hideOnClick:!1,onClickOutside:createUserResponseHandler(onCancelClick,!1),ignoreAttributes:!0,...tippyProps},React.createElement("div",{className:"map-balloon-confirm"},React.createElement("wz-h4",null,title),React.createElement("wz-body2",null,details),!disableDontShowAgainCheckbox&&React.createElement(WzCheckbox,{ref:dontShowAgainRef},t("edit.dont_show_again")),React.createElement("div",{className:"controls-container"},React.createElement(WzButton,{color:"secondary",onClick:createUserResponseHandler(onCancelClick),alarming},cancelButtonText),React.createElement(WzButton,{onClick:createUserResponseHandler(onConfirmClick),alarming},confirmButtonText))))}function ConfirmMapBalloon_extends(){return ConfirmMapBalloon_extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},ConfirmMapBalloon_extends.apply(this,arguments)}function ConfirmMapBalloon(props){const{mapEntity,...restProps}=props;return React.createElement(ConfirmBalloon,ConfirmMapBalloon_extends({TippyComponent:TippyAtMapEntity,tippyProps:{entity:mapEntity}},restProps))}function roundaboutizeBigJunctionByAction(action){const dataModel=(0,get_wme_window.B)().W.model,map=(0,get_wme_window.B)().W.map;dataModel.actionManager.add(new UpdateBigJunctionGeometryToRoundaboutAction(action,dataModel,map))}function AutoCloneRoundaboutGeometryBackgroundAction(){const[pref,setPref]=usePreference("roundabout.clone_geometry"),t=useTranslate(),[actionToAskFor,setActionToAskFor]=(0,external_window_React_unsafeWindow_React_.useState)(),isEnabled=!1!==pref,askBeforePerforming="ask"===pref;!function(handler,deps){const savedHandler=(0,external_window_React_unsafeWindow_React_.useRef)(handler);(0,external_window_React_unsafeWindow_React_.useEffect)((()=>{savedHandler.current=handler}),[handler]),(0,external_window_React_unsafeWindow_React_.useEffect)((()=>{const listener=({action})=>savedHandler.current(action),actionManager=(0,get_wme_window.B)().W.model.actionManager;return actionManager.events.on("afteraction",listener),()=>actionManager.events.off("afteraction",listener)}),deps)}((action=>{if(isAddBigJunctionAction(action)&&function(bigJunction){const segments=bigJunction.getShortSegments(bigJunction);return!!segments.length&&!segments.some((segment=>!segment.isInRoundabout()))}(action.bigJunction)&&!action.__jbuSkipAutoRoundaboutize&&isEnabled)return askBeforePerforming?void setActionToAskFor(action):roundaboutizeBigJunctionByAction(action)}),[pref,setPref]);const handleButtonClick=(applyGeometry,dontShowAgain)=>{((preferenceValue,dontShowAgain)=>{dontShowAgain&&setPref(preferenceValue)})(applyGeometry,dontShowAgain),applyGeometry&&roundaboutizeBigJunctionByAction(actionToAskFor),setActionToAskFor(null)};return actionToAskFor?React.createElement(ConfirmMapBalloon,{mapEntity:actionToAskFor.bigJunction,title:t("jb_utils.big_junction.auto_clone_roundabout_geom_confirm.title"),details:t("jb_utils.big_junction.auto_clone_roundabout_geom_confirm.details"),confirmButtonText:t("formats.boolean.is_true"),cancelButtonText:t("formats.boolean.is_false"),onConfirmClick:dsa=>handleButtonClick(!0,dsa),onCancelClick:dsa=>handleButtonClick(!1,dsa)}):null}function compareArrays(array1,array2,valueExtractor){if(array1.length!==array2.length)return!1;const testArray=array1.map(valueExtractor),subjectArray=array2.map(valueExtractor);for(const testItem of testArray){const itemIndexInSubject=subjectArray.indexOf(testItem);if(-1===itemIndexInSubject)return!1;subjectArray.splice(itemIndexInSubject,1)}return!0}function findTargetIdByIdChangelist(targetId,changeList){if(!changeList.has(targetId))return[targetId];const changes=changeList.get(targetId);if(!changes)return[targetId];const result=changes.flatMap((change=>findTargetIdByIdChangelist(change,changeList))),duplicateFilteredResult=[];return result.forEach((value=>{duplicateFilteredResult.length&&duplicateFilteredResult[duplicateFilteredResult.length-1]===value||duplicateFilteredResult.push(value)})),duplicateFilteredResult}function createIdChangelist(objects,currentIdExtractor,originalIdsExtractor){const map=new Map;return objects.forEach((item=>{const originalIds=originalIdsExtractor(item);if(!originalIds?.length)return;const currentId=currentIdExtractor(item);originalIds.forEach((originalId=>{if(map.has(originalId)){const ids=map.get(originalId);map.set(originalId,ids.concat([currentId]))}else map.set(originalId,[currentId])}))})),map}class BigJunctionSignature{constructor(entranceSegments,exitSegments,containedSegments){this._entranceSegments=entranceSegments,this._exitSegments=exitSegments,this._containedSegments=containedSegments}static fromBigJunction(bigJunction){const entranceSegments=function(bigJunction){return getTurnSegmentsByBigJunction(bigJunction,(turn=>turn.getFromVertex().getSegmentID()))}(bigJunction),exitSegments=function(bigJunction){return getTurnSegmentsByBigJunction(bigJunction,(turn=>turn.getToVertex().getSegmentID()))}(bigJunction),innerSegments=bigJunction.getShortSegments(bigJunction.model);return new BigJunctionSignature(entranceSegments,exitSegments,innerSegments)}compareTo(signature){return this.compareEntranceSegmentsTo(signature)&&this.compareExitSegmentsTo(signature)&&this.compareContainedSegmentsTo(signature)}compareEntranceSegmentsTo(signature){return compareArrays(this._entranceSegments,signature._entranceSegments,(segment=>segment.getAttribute("id")))}compareExitSegmentsTo(signature){return compareArrays(this._exitSegments,signature._exitSegments,(segment=>segment.getAttribute("id")))}compareContainedSegmentsTo(signature){return compareArrays(this._containedSegments,signature._containedSegments,(segment=>segment.getAttribute("id")))}getEntranceSegments(){return this._entranceSegments}getExitSegments(){return this._exitSegments}getContainedSegments(){return this._containedSegments}upgradeSignatureSegmentsLineage(){const segmentsLineage=createIdChangelist((0,get_wme_window.B)().W.model.segments.getObjectArray(),(segment=>segment.getAttribute("id")),(segment=>segment.getAttribute("origIDs"))),upgradedContainedSegments=this._containedSegments.flatMap((segment=>{const segmentId=segment.getAttribute("id"),newSegmentIds=[segmentId].flatMap((segmentId=>findTargetIdByIdChangelist(segmentId,segmentsLineage)));return(0,get_wme_window.B)().W.model.segments.getByIds(newSegmentIds)})).filter(((item,pos,arr)=>0===pos||arr.indexOf(item)===pos));return new BigJunctionSignature(this._entranceSegments,this._exitSegments,upgradedContainedSegments)}}function createVertex(segmentId,direction){return new((0,get_wme_window.B)().require("Waze/Model/Graph/Vertex"))(segmentId,function(direction){switch(direction){case"forward":return"fwd";case"reverse":return"rev";default:throw new Error("Unsupported direction")}}(direction))}function createVertexFromSegment(segment,direction){return createVertex(segment.getAttribute("id"),direction)}function createForwardVertexFromSegment(segment){return createVertexFromSegment(segment,"forward")}function createReverseVertexFromSegment(segment){return createVertexFromSegment(segment,"reverse")}function createBackupSnapshotFromBigJunction(bigJunction){const address=bigJunction.getAddress(bigJunction.model),bjSignature=BigJunctionSignature.fromBigJunction(bigJunction);return{address:{city:address.getCity().isEmpty()?null:address.getCityName(),state:address.hasState()?address.getStateName():null,country:address.getCountryName()},name:bigJunction.getAttribute("name"),turns:bjSignature.getEntranceSegments().flatMap((entranceSegment=>{const entranceDirection=entranceSegment.getAttribute("toCrossroads").includes(bigJunction.getAttribute("id"))?"forward":"reverse";return bigJunction.getTurnsFrom(bigJunction.model,createVertexFromSegment(entranceSegment,entranceDirection))})),signature:bjSignature,isRestored:!1,createdFrom:bigJunction}}function updateSnapshotWithSegmentLineage(snapshot){const segmentsLineage=createIdChangelist((0,get_wme_window.B)().W.model.segments.getObjectArray(),(segment=>segment.getAttribute("id")),(segment=>segment.getAttribute("origIDs"))),turns=snapshot.turns.map((turn=>{const turnData=turn.getTurnData();if(!turnData.hasSegmentPath())return turn;const originalSegmentPath=turnData.getSegmentPath(),updatedSegmentPath=originalSegmentPath.flatMap((segmentId=>findTargetIdByIdChangelist(segmentId,segmentsLineage))).filter(((item,pos,arr)=>0===pos||item!==arr[pos-1]));const updatedTurnData=turnData.withSegmentPath(updatedSegmentPath);return turn.withTurnData(updatedTurnData)}));return{...snapshot,signature:snapshot.signature.upgradeSignatureSegmentsLineage(),turns}}const BigJunctionEditPanelButton=function(component,defaultProps){const ComponentWithDefaultProps=(props,ref)=>{const mergedProps={...defaultProps,...props};return mergedProps.ref=ref,(0,external_window_React_unsafeWindow_React_.createElement)(component,mergedProps)},componentName=component.displayName||component.name||component.render?.displayName||component.render?.name||"Component";return ComponentWithDefaultProps.displayName=`WithDefaultProps(${componentName})`,(0,external_window_React_unsafeWindow_React_.forwardRef)(ComponentWithDefaultProps)}(WzButton,{color:"text"}),BigJunctionBackupContext=(0,external_window_React_unsafeWindow_React_.createContext)(null);function BigJunctionBackupContextProvider({children,backupStrategies}){const[,forceUpdate]=(0,external_window_React_unsafeWindow_React_.useReducer)((x=>x+1),0),suitableStrategy=backupStrategies[0],backupContextImpl={get:()=>suitableStrategy.getSnapshot(),set:snapshot=>{suitableStrategy.saveSnapshot(snapshot),forceUpdate()}};return React.createElement(BigJunctionBackupContext.Provider,{value:backupContextImpl},children)}function useBigJunctionBackupContext(){const backupContext=(0,external_window_React_unsafeWindow_React_.useContext)(BigJunctionBackupContext);if(!backupContext)throw new Error("useBigJunctionBackupContext can only be used with the Provider");return backupContext}function BackupBigJunctionPropsButton(props){const buttonRef=(0,external_window_React_unsafeWindow_React_.useRef)(),t=useTranslate(),backupStrategy=useBigJunctionBackupContext(),[overrideConfirmationShown,setOverrideConfirmationShown]=(0,external_window_React_unsafeWindow_React_.useState)(!1),shouldAskForUserConfirmation=null!==backupStrategy.get(),backupCurrentBigJunction=()=>{const backup=createBackupSnapshotFromBigJunction(props.bigJunction);backupStrategy.set(backup),setOverrideConfirmationShown(!1)};return React.createElement(React.Fragment,null,React.createElement(BigJunctionEditPanelButton,{onClick:()=>{shouldAskForUserConfirmation?setOverrideConfirmationShown(!0):backupCurrentBigJunction()},ref:buttonRef},t("jb_utils.big_junction.actions.backup_props")),overrideConfirmationShown&&React.createElement(ConfirmBalloon,{TippyComponent:TippyModal,tippyProps:{getReferenceClientRect:()=>buttonRef.current.getBoundingClientRect(),theme:"light-border"},alarming:!0,disableDontShowAgainCheckbox:!0,title:t("jb_utils.big_junction.backup_restore.confirm_overwrite_backup.title"),details:t("jb_utils.big_junction.backup_restore.confirm_overwrite_backup.details"),onConfirmClick:backupCurrentBigJunction,onCancelClick:()=>setOverrideConfirmationShown(!1)}))}function ConditionalTooltip({show,children,...rest}){return show?React.createElement(WzTooltip,rest,children):React.createElement(React.Fragment,null,children)}function getLineDirectionInDegrees(line){const deltaX=line.endX-line.startX,deltaY=line.endY-line.startY,directionInRadians=Math.atan2(deltaY,deltaX);return 180*directionInRadians/Math.PI}function getCityByStreet(dataModel,street){const cityId=street.getAttribute("cityID");return dataModel.cities.getObjectById(cityId)}function getCountryByCity(dataModel,city){const countryId=city.getCountryID();return dataModel.countries.getObjectById(countryId)}function getSegmentByVertex(dataModel,vertex){const segmentId=vertex.getSegmentID();return dataModel.segments.getObjectById(segmentId)}function get_street_getStreetBySegment(dataModel,segment){const streetId=segment.getAttribute("primaryStreetID");return dataModel.streets.getObjectById(streetId)}function getToStreetByTurn(dataModel,turn){const segment=function(dataModel,turn){return getSegmentByVertex(dataModel,turn.getToVertex())}(dataModel,turn);return get_street_getStreetBySegment(dataModel,segment)}function getSegmentGeometryFromVertex(vertex){const segment=function(vertex){return(0,get_wme_window.B)().W.model.getRepository("segment").getObjectById(vertex.getSegmentID())}(vertex);return getSegmentGeometryForDirection(segment,vertex.isForward()?"forward":"reverse")}function getAbsoluteTurnAngleInDegrees(turn){const{fromLine,toLine}=function(turn){const fromGeometry=getSegmentGeometryFromVertex(turn.fromVertex),toGeometry=getSegmentGeometryFromVertex(turn.toVertex),fromLine={startY:fromGeometry[fromGeometry.length-2][0],startX:fromGeometry[fromGeometry.length-2][1],endY:fromGeometry[fromGeometry.length-1][0],endX:fromGeometry[fromGeometry.length-1][1]},toLine={startY:toGeometry[0][0],startX:toGeometry[0][1],endY:toGeometry[1][0],endX:toGeometry[1][1]};return{fromLine,toLine}}(turn),angle=function(line1,line2){const relativeAngle=getLineDirectionInDegrees(line1)-getLineDirectionInDegrees(line2);if(relativeAngle<0){const absoluteAngle=Math.abs(relativeAngle);return relativeAngle+360*(Math.floor(absoluteAngle/360)+1)}return relativeAngle}(fromLine,toLine);return Math.abs(angle)}function canUserEditTurnGuidanceForTurn(dataModel,user,turn){const country=function(dataModel,street){return getCountryByCity(dataModel,getCityByStreet(dataModel,street))}(dataModel,getToStreetByTurn(dataModel,turn)),rankToEditTG=country.getAttribute("allowEditingTurnGuidanceRank");if(user.getRank()<rankToEditTG)return!1;if(turn.isJunctionBoxTurn()){const rankToEditBigJunction=country.getAttribute("updateJunctionBoxRank");return user.getRank()>=rankToEditBigJunction}return!0}const MultiAction=(0,get_wme_window.B)().require("Waze/Action/MultiAction");MultiAction.Base=MultiAction.__proto__;const SetTurnAction=(0,get_wme_window.B)().require("Waze/Model/Graph/Actions/SetTurn"),UpdateObjectAction=(0,get_wme_window.B)().require("Waze/Action/UpdateObject"),UpdateFeatureAddressAction=(0,get_wme_window.B)().require("Waze/Action/UpdateFeatureAddress");class UpdateBigJunctionAction extends MultiAction.Base{actionName="JBU_UPDATE_BIG_JUNCTION_ACTION";constructor(_dataModel,_bigJunction,_newAttributes){super(),this._dataModel=_dataModel,this._bigJunction=_bigJunction,this._newAttributes=_newAttributes,this.subActions=[this._createUpdateObjectAction(),this._createUpdateAddressAction(),...this._newAttributes.turns.map((turn=>new SetTurnAction(_dataModel.turnGraph,turn)))]}_createUpdateObjectAction(){return new UpdateObjectAction(this._bigJunction,{name:this._newAttributes.name},null)}_createUpdateAddressAction(){return new UpdateFeatureAddressAction(this._bigJunction,{countryID:this._getCountryByAttributes().getAttribute("id"),stateID:this._getStateByAttributes().getAttribute("id"),cityName:this._newAttributes.cityName,emptyCity:null===this._newAttributes.cityName,emptyStreet:!0},{updateStreet:!1,shouldGetCityFromDataModel:!1})}_getCountryByAttributes(){const country=this._dataModel.countries.getObjectArray().find((country=>country.getName()===this._newAttributes.countryName));if(!country)throw new Error(`Country '${this._newAttributes.countryName}' not found.`);return country}_getStateByAttributes(){if(!this._newAttributes.stateName)return this._getDefaultState();const countryId=this._getCountryByAttributes().getAttribute("id"),state=this._dataModel.states.getObjectArray().find((state=>state.getAttribute("countryID")===countryId&&state.getName()===this._newAttributes.stateName));if(!state)throw new Error(`State '${this._newAttributes.stateName}' not found in country ID ${countryId}.`);return state}_getDefaultState(){return this._dataModel.states.getObjectArray().find((state=>state.getAttribute("isDefault")))}generateDescription(){this._description=(0,get_wme_window.B)().I18n.t("jb_utils.save.changes_log.actions.UpdateBigJunction")}getFocusFeatures(dataModel){return this.getSubActions().flatMap((action=>action.getFocusFeatures(dataModel)))}getAffectedUniqueIds(dataModel){return this.getSubActions().flatMap((action=>action.getAffectedUniqueIds(dataModel)))}}const WAS_RESTORED_METADATA_SYMBOL=Symbol("__was_restored__");class RestoreBigJunctionSnapshotAction extends UpdateBigJunctionAction{constructor(dataModel,bigJunction,_snapshot){const upgradedSnapshot=updateSnapshotWithSegmentLineage(_snapshot);super(dataModel,bigJunction,{turns:upgradedSnapshot.turns.filter((turn=>dataModel.turnGraph.hasTurn(turn))),name:upgradedSnapshot.name,cityName:upgradedSnapshot.address.city,stateName:upgradedSnapshot.address.state,countryName:upgradedSnapshot.address.country}),this._snapshot=_snapshot}setSnapshotRestoredState(state){Reflect.defineMetadata(WAS_RESTORED_METADATA_SYMBOL,state,this._snapshot)}getSnapshotRestoredState(){return Reflect.getMetadata(WAS_RESTORED_METADATA_SYMBOL,this._snapshot)||!1}doAction(dataModel){super.doAction(dataModel),this._previousSnapshotRestoredState=this.getSnapshotRestoredState(),this.setSnapshotRestoredState(!0)}undoAction(dataModel){super.undoAction(dataModel),this.setSnapshotRestoredState(this._previousSnapshotRestoredState)}redoAction(dataModel){super.redoAction(dataModel),this.setSnapshotRestoredState(!0)}}function RestoreBigJunctionPropsButton(props){const t=useTranslate(),snapshot=useBigJunctionBackupContext().get(),restorer=function(destBigJunction,backupSnapshot){const[isRestored,setIsRestored]=(0,external_window_React_unsafeWindow_React_.useState)(!1),upgradedLineageSignature=(0,external_window_React_unsafeWindow_React_.useMemo)((()=>backupSnapshot?.signature?.upgradeSignatureSegmentsLineage?.()),[backupSnapshot?.signature]),dataModel=destBigJunction.model,isBigJunctionSignatureMatch=(0,external_window_React_unsafeWindow_React_.useMemo)((()=>destBigJunction&&upgradedLineageSignature&&BigJunctionSignature.fromBigJunction(destBigJunction).compareTo(upgradedLineageSignature)),[upgradedLineageSignature,destBigJunction]),canEditBigJunction=(0,external_window_React_unsafeWindow_React_.useMemo)((()=>destBigJunction?.isAllowed?.(destBigJunction.permissionFlags.EDIT_PROPERTIES)&&destBigJunction?.canEditTurns?.()),[destBigJunction]),canEditTurnGuidance=(0,external_window_React_unsafeWindow_React_.useMemo)((()=>{const turns=destBigJunction?.getShortestTurns?.(dataModel),user=(0,get_wme_window.B)().W.loginManager.user;return turns?.every?.((turn=>canUserEditTurnGuidanceForTurn(dataModel,user,turn)))}),[dataModel,destBigJunction]),hasTurnsWithGuidance=(0,external_window_React_unsafeWindow_React_.useMemo)((()=>backupSnapshot?.turns?.some?.((turn=>turn.turnData.hasTurnGuidance()))),[backupSnapshot?.turns]);return{available:Boolean(destBigJunction&&backupSnapshot),isBigJunctionSignatureMatch,canEditBigJunction,canEditTurnGuidance,hasTurnsWithGuidance,isRestored,restore(){(0,get_wme_window.B)().W.model.actionManager.add(new RestoreBigJunctionSnapshotAction(dataModel,destBigJunction,backupSnapshot)),setIsRestored(!0)},restorationUnavailableReason:canEditBigJunction?!canEditTurnGuidance&&hasTurnsWithGuidance?"TURN_GUIDANCE_EDITING_DISALLOWED":null:"BIG_JUNCTION_EDITING_DISALLOWED"}}(props.bigJunction,snapshot),hasRestoredMistmatchingSig=restorer.isRestored&&!restorer.isBigJunctionSignatureMatch;return React.createElement(React.Fragment,null,hasRestoredMistmatchingSig&&(0,external_window_ReactDOM_unsafeWindow_ReactDOM_namespaceObject.createPortal)(React.createElement(WzAlert,{level:"page",variant:"warning"},t("jb_utils.big_junction.backup_restore.mistmatch_signature_snapshot_restored_alert")),document.getElementById("edit-panel").querySelector(".big-junction .tab-content wz-alerts-group")),React.createElement(ConditionalTooltip,{show:restorer.available&&!!restorer.restorationUnavailableReason,tooltipContent:t(`jb_utils.big_junction.backup_restore.restoration_disabled_reasons.${restorer?.restorationUnavailableReason}`)},React.createElement(BigJunctionEditPanelButton,{disabled:!restorer.available||!!restorer.restorationUnavailableReason,onClick:()=>restorer.restore()},t("jb_utils.big_junction.actions.restore_props"))))}function BigJunctionPropsBackup(props){return React.createElement(BigJunctionBackupContextProvider,{backupStrategies:props.backupStrategies},React.createElement(BackupBigJunctionPropsButton,{bigJunction:props.bigJunction}),React.createElement(RestoreBigJunctionPropsButton,{bigJunction:props.bigJunction}))}class MethodInterceptor{constructor(object,fnPropName,interceptionFn){this._object=object,this._fnPropName=fnPropName,this._interceptionFn=interceptionFn,this._isEnabled=!1,this._originalFn=this.getRefreshedOriginalFn()}getRefreshedOriginalFn(){if(this._isEnabled)return this._originalFn;const propValue=this._object[this._fnPropName];if("function"!=typeof propValue)throw new Error("Unable to refresh the original function, type of property is incompatible ("+typeof propValue+")");return propValue}restoreOriginalFn(){if(!this._isEnabled)return;const propValue=this._object[this._fnPropName];if("function"!=typeof propValue)throw new Error("Unable to restore original function, type of property is incompatible ("+typeof propValue+")");this._object[this._fnPropName]=this._originalFn}enable(){this._isEnabled||(this._originalFn=this.getRefreshedOriginalFn(),this._object[this._fnPropName]=this._interceptCb.bind(this),this._isEnabled=!0)}disable(){this._isEnabled&&(this.restoreOriginalFn(),this._isEnabled=!1)}get isEnabled(){return this._isEnabled}_executeOriginalFn(...args){return this._originalFn.apply(this._object,args)}_executeInterceptionFn(...args){return this._interceptionFn.apply(this._object,args)}}class BeforeMethodInvocationInterceptor extends MethodInterceptor{static CONTINUE_EXECUTION=Symbol("__CONTINUE_EXECUTION__");constructor(object,fnPropName,interceptionFn){super(object,fnPropName,interceptionFn)}static _isContinueExecutionSymbol(symbol){return symbol===BeforeMethodInvocationInterceptor.CONTINUE_EXECUTION}_interceptCb(...args){const returnValue=this._executeInterceptionFn(...args);return BeforeMethodInvocationInterceptor._isContinueExecutionSymbol(returnValue)?this._executeOriginalFn(...args):returnValue}}class ManualMethodInvocationInterceptor extends MethodInterceptor{constructor(object,fnPropName,interceptionFn){super(object,fnPropName,interceptionFn)}_interceptCb(...args){return this._executeInterceptionFn(this._executeOriginalFn.bind(this),...args)}}let _postFeaturesInterceptor,_nextLockId=1;const _locks=new Map;function putImmideateSaveErrorResponse(locks){if(!locks?.length)return;const target=(0,get_wme_window.B)(),originalFetch=target.fetch;target.fetch=request=>(target.fetch=originalFetch,new Promise((resolve=>{const hasHardLock=locks.some((lock=>"hard"===lock._type));resolve(function(url,errorLevel,errorList){const errorData={errorLevel,errorList},response=new Response(JSON.stringify(errorData),{status:403,statusText:"Forbidden",headers:{"Content-Type":"application/json"}});return Object.defineProperty(response,"url",{value:url}),response}(request instanceof URL?request.toString():request.url,hasHardLock?"ERROR":"WARNING",locks))})))}function getOrCreatePostFeaturesInterceptor(){if(_postFeaturesInterceptor)return _postFeaturesInterceptor;const descartesClient=(0,get_wme_window.B)().W.controller.descartesClient;return _postFeaturesInterceptor=new BeforeMethodInvocationInterceptor(descartesClient,"postFeatures",((_data,ignoreWarnings)=>{if(!ignoreWarnings&&_locks.size){const activeLocks=Array.from(_locks.values()).filter((lock=>!lock._precondition||lock._precondition(lock)));activeLocks.length&&putImmideateSaveErrorResponse(activeLocks)}return BeforeMethodInvocationInterceptor.CONTINUE_EXECUTION})),_postFeaturesInterceptor}const SaveLock_addSoftLock=(lock,precondition)=>{const lockId=_nextLockId++;return _locks.set(lockId,{_type:"soft",_precondition:precondition,...lock}),getOrCreatePostFeaturesInterceptor().enable(),lockId};const BACKUP_STRATEGIES=[new class{_storedSnapshot=null;_unrestoredSnapshotSaveLockSet=!1;_setUnrestoredSnapshotSaveLock(){this._unrestoredSnapshotSaveLockSet||(SaveLock_addSoftLock({code:"jbu101"},(()=>"DELETE"===this._storedSnapshot.createdFrom?.state&&(0,get_wme_window.B)().W.model.bigJunctions.getObjectById(this._storedSnapshot.createdFrom?.getAttribute("id"))&&!Reflect.getMetadata(WAS_RESTORED_METADATA_SYMBOL,this._storedSnapshot))),this._unrestoredSnapshotSaveLockSet=!0)}canSaveSnapshot(){return!0}saveSnapshot(snapshot){this._storedSnapshot=snapshot,this._setUnrestoredSnapshotSaveLock()}getSnapshot(){return this._storedSnapshot}}],BigJunctionPropsBackupTemplate=class{constructor(bigJunctions){this._bigJunction=bigJunctions[0]}static getSupportedElementTypes(){return[WazeMapEditorEntityType.BigJunction]}static isEnabledForElements(){return!0}static getBackupStrategyForAutoBackup(){return BACKUP_STRATEGIES[0]}getTargetElement(){return document.querySelector("#edit-panel .big-junction.sidebar-column .tab-content .form-group .controls.junction-actions")}render(){return React.createElement(BigJunctionPropsBackup,{bigJunction:this._bigJunction,backupStrategies:BACKUP_STRATEGIES})}};class Logger{static get displayName(){return"Junction Box Utils"}static addDisplayNameToDataComponent(message){const prefix=`[${Logger.displayName}]`;return message?`${prefix} ${message}`:prefix}static formatData(...args){if(0===args.length)return null;if("string"==typeof args[0]){const[textArgument,...rest]=args;return[this.addDisplayNameToDataComponent(textArgument),...rest]}return[this.addDisplayNameToDataComponent(null),...args]}static logLevel(level,...data){if("function"!=typeof console[level])throw new Error(`Logging level "${level}" is not supported`);const formattedData=Logger.formatData(...data);return console[level](...formattedData)}static bindLogLevel(level){return(...data)=>this.logLevel(level,...data)}static log=Logger.bindLogLevel("log");static warn=Logger.bindLogLevel("warn");static error=Logger.bindLogLevel("error");static info=Logger.bindLogLevel("info")}function AutoBackupBigJunctionBeforeDelete(){const t=useTranslate(),[autoBackupPrefState]=usePreference("auto_backup"),[confirmBalloonCallback,setConfirmBalloonCallback]=(0,external_window_React_unsafeWindow_React_.useState)(null),backupBigJunction=(bigJunction,backupStrategy)=>{const snapshot=createBackupSnapshotFromBigJunction(bigJunction);backupStrategy.saveSnapshot(snapshot),Logger.info("Big Junction snapshot has been created and saved")},onBeforeActionAdded=useEventCallback(((addAction,action)=>{if(!autoBackupPrefState)return addAction(action);if(!function(action){return"DELETE_BIG_JUNCTION"===action.getActionName()}(action))return addAction(action);Logger.info("Automatic big junction backup script running...");const autoBackupStrategy=BigJunctionPropsBackupTemplate.getBackupStrategyForAutoBackup(),bigJunctionSignature=BigJunctionSignature.fromBigJunction(action.bigJunction),storedSnapshot=autoBackupStrategy.getSnapshot(),snapshotSignatureMatch=storedSnapshot&&bigJunctionSignature.compareTo(storedSnapshot.signature);storedSnapshot?snapshotSignatureMatch?(Logger.info("Big Junction and Snapshot signatures matches, skipping"),addAction(action)):(Logger.info("Asking the user to override the snapshot"),new Promise(((resolve,reject)=>{setConfirmBalloonCallback({attributes:{bigJunction:action.bigJunction},resolve,reject})})).then((()=>{Logger.info("User confirmed, overriding"),backupBigJunction(action.bigJunction,autoBackupStrategy)})).catch((()=>{Logger.info("User rejected, adding action w/o backup")})).finally((()=>{addAction(action),setConfirmBalloonCallback(null)}))):(Logger.info("Has no snapshot stored, backing up..."),backupBigJunction(action.bigJunction,autoBackupStrategy),addAction(action))})),beforeActionAddedInterceptor=(0,external_window_React_unsafeWindow_React_.useMemo)((()=>new ManualMethodInvocationInterceptor((0,get_wme_window.B)().W.model.actionManager,"add",onBeforeActionAdded)),[onBeforeActionAdded]);return(0,external_window_React_unsafeWindow_React_.useEffect)((()=>(beforeActionAddedInterceptor.enable(),()=>beforeActionAddedInterceptor.disable())),[beforeActionAddedInterceptor]),confirmBalloonCallback?React.createElement(ConfirmMapBalloon,{alarming:!0,disableDontShowAgainCheckbox:!0,mapEntity:confirmBalloonCallback.attributes.bigJunction,title:t("jb_utils.big_junction.backup_restore.confirm_overwrite_backup.title"),details:t("jb_utils.big_junction.backup_restore.confirm_overwrite_backup.details"),confirmButtonText:t("jb_utils.big_junction.backup_restore.confirm_overwrite_backup.backup_btn"),cancelButtonText:t("jb_utils.big_junction.backup_restore.confirm_overwrite_backup.ignore_btn"),onConfirmClick:confirmBalloonCallback.resolve,onCancelClick:confirmBalloonCallback.reject}):null}function BackgroundActions(){return React.createElement(React.Fragment,null,React.createElement(AutoCloneRoundaboutGeometryBackgroundAction,null),React.createElement(AutoBackupBigJunctionBeforeDelete,null))}const SelectedDataModelsContext=(0,external_window_React_unsafeWindow_React_.createContext)(null);function SelectedDataModelsContextProvider({children}){const[selection,setSelection]=(0,external_window_React_unsafeWindow_React_.useState)([]),selectionChangedCallback=useEventCallback((({detail})=>{const objects=detail.selected.map((feature=>feature._wmeObject));setSelection(objects)}));return(0,external_window_React_unsafeWindow_React_.useEffect)((()=>{const selectionManager=(0,get_wme_window.B)().W.selectionManager;return selectionManager.events.on("selectionchanged",selectionChangedCallback),()=>{selectionManager.events.off("selectionchanged",selectionChangedCallback)}}),[]),React.createElement(SelectedDataModelsContext.Provider,{value:selection},children)}function useSelectedDataModelsContext(){return(0,external_window_React_unsafeWindow_React_.useContext)(SelectedDataModelsContext)}function EditPanel(props){const selectedElements=useSelectedDataModelsContext(),selectedElementsType=function(){const selectedModels=useSelectedDataModelsContext(),[firstModel,...restModels]=selectedModels,firstModelType=firstModel?.type;return restModels.every((model=>model.type===firstModelType))?firstModelType:null}(),availableTemplatesForType=(0,external_window_React_unsafeWindow_React_.useMemo)((()=>props.templates.filter((template=>template.getSupportedElementTypes().includes(selectedElementsType)&&template.isEnabledForElements(selectedElements)))),[props.templates,selectedElements,selectedElementsType]),templates=(0,external_window_React_unsafeWindow_React_.useMemo)((()=>availableTemplatesForType.map((templateConstructor=>new templateConstructor(selectedElements)))),[availableTemplatesForType,selectedElements]),templatesRenderedInPortals=(0,external_window_React_unsafeWindow_React_.useMemo)((()=>templates.map((template=>(0,external_window_ReactDOM_unsafeWindow_ReactDOM_namespaceObject.createPortal)(template.render(),template.getTargetElement())))),[templates]);return React.createElement(React.Fragment,null,templatesRenderedInPortals)}function extends_extends(){return extends_extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},extends_extends.apply(this,arguments)}function memoize(fn){var cache=Object.create(null);return function(arg){return void 0===cache[arg]&&(cache[arg]=fn(arg)),cache[arg]}}var reactPropsRegex=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,isPropValid=memoize((function(prop){return reactPropsRegex.test(prop)||111===prop.charCodeAt(0)&&110===prop.charCodeAt(1)&&prop.charCodeAt(2)<91}));var StyleSheet=function(){function StyleSheet(options){var _this=this;this._insertTag=function(tag){var before;before=0===_this.tags.length?_this.insertionPoint?_this.insertionPoint.nextSibling:_this.prepend?_this.container.firstChild:_this.before:_this.tags[_this.tags.length-1].nextSibling,_this.container.insertBefore(tag,before),_this.tags.push(tag)},this.isSpeedy=void 0===options.speedy||options.speedy,this.tags=[],this.ctr=0,this.nonce=options.nonce,this.key=options.key,this.container=options.container,this.prepend=options.prepend,this.insertionPoint=options.insertionPoint,this.before=null}var _proto=StyleSheet.prototype;return _proto.hydrate=function(nodes){nodes.forEach(this._insertTag)},_proto.insert=function(rule){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(options){var tag=document.createElement("style");return tag.setAttribute("data-emotion",options.key),void 0!==options.nonce&&tag.setAttribute("nonce",options.nonce),tag.appendChild(document.createTextNode("")),tag.setAttribute("data-s",""),tag}(this));var tag=this.tags[this.tags.length-1];if(this.isSpeedy){var sheet=function(tag){if(tag.sheet)return tag.sheet;for(var i=0;i<document.styleSheets.length;i++)if(document.styleSheets[i].ownerNode===tag)return document.styleSheets[i]}(tag);try{sheet.insertRule(rule,sheet.cssRules.length)}catch(e){0}}else tag.appendChild(document.createTextNode(rule));this.ctr++},_proto.flush=function(){this.tags.forEach((function(tag){return tag.parentNode&&tag.parentNode.removeChild(tag)})),this.tags=[],this.ctr=0},StyleSheet}(),abs=Math.abs,Utility_from=String.fromCharCode,Utility_assign=Object.assign;function trim(value){return value.trim()}function Utility_replace(value,pattern,replacement){return value.replace(pattern,replacement)}function indexof(value,search){return value.indexOf(search)}function Utility_charat(value,index){return 0|value.charCodeAt(index)}function Utility_substr(value,begin,end){return value.slice(begin,end)}function Utility_strlen(value){return value.length}function Utility_sizeof(value){return value.length}function Utility_append(value,array){return array.push(value),value}var line=1,column=1,Tokenizer_length=0,position=0,character=0,characters="";function node(value,root,parent,type,props,children,length){return{value,root,parent,type,props,children,line,column,length,return:""}}function Tokenizer_copy(root,props){return Utility_assign(node("",null,null,"",null,null,0),root,{length:-root.length},props)}function prev(){return character=position>0?Utility_charat(characters,--position):0,column--,10===character&&(column=1,line--),character}function next(){return character=position<Tokenizer_length?Utility_charat(characters,position++):0,column++,10===character&&(column=1,line++),character}function peek(){return Utility_charat(characters,position)}function caret(){return position}function slice(begin,end){return Utility_substr(characters,begin,end)}function token(type){switch(type){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function alloc(value){return line=column=1,Tokenizer_length=Utility_strlen(characters=value),position=0,[]}function dealloc(value){return characters="",value}function delimit(type){return trim(slice(position-1,delimiter(91===type?type+2:40===type?type+1:type)))}function whitespace(type){for(;(character=peek())&&character<33;)next();return token(type)>2||token(character)>3?"":" "}function escaping(index,count){for(;--count&&next()&&!(character<48||character>102||character>57&&character<65||character>70&&character<97););return slice(index,caret()+(count<6&&32==peek()&&32==next()))}function delimiter(type){for(;next();)switch(character){case type:return position;case 34:case 39:34!==type&&39!==type&&delimiter(character);break;case 40:41===type&&delimiter(type);break;case 92:next()}return position}function commenter(type,index){for(;next()&&type+character!==57&&(type+character!==84||47!==peek()););return"/*"+slice(index,position-1)+"*"+Utility_from(47===type?type:next())}function identifier(index){for(;!token(peek());)next();return slice(index,position)}var COMMENT="comm",Enum_RULESET="rule",Enum_DECLARATION="decl";function Serializer_serialize(children,callback){for(var output="",length=Utility_sizeof(children),i=0;i<length;i++)output+=callback(children[i],i,children,callback)||"";return output}function stringify(element,index,children,callback){switch(element.type){case"@layer":if(element.children.length)break;case"@import":case Enum_DECLARATION:return element.return=element.return||element.value;case COMMENT:return"";case"@keyframes":return element.return=element.value+"{"+Serializer_serialize(element.children,callback)+"}";case Enum_RULESET:element.value=element.props.join(",")}return Utility_strlen(children=Serializer_serialize(element.children,callback))?element.return=element.value+"{"+children+"}":""}function compile(value){return dealloc(parse("",null,null,null,[""],value=alloc(value),0,[0],value))}function parse(value,root,parent,rule,rules,rulesets,pseudo,points,declarations){for(var index=0,offset=0,length=pseudo,atrule=0,property=0,previous=0,variable=1,scanning=1,ampersand=1,character=0,type="",props=rules,children=rulesets,reference=rule,characters=type;scanning;)switch(previous=character,character=next()){case 40:if(108!=previous&&58==Utility_charat(characters,length-1)){-1!=indexof(characters+=Utility_replace(delimit(character),"&","&\f"),"&\f")&&(ampersand=-1);break}case 34:case 39:case 91:characters+=delimit(character);break;case 9:case 10:case 13:case 32:characters+=whitespace(previous);break;case 92:characters+=escaping(caret()-1,7);continue;case 47:switch(peek()){case 42:case 47:Utility_append(comment(commenter(next(),caret()),root,parent),declarations);break;default:characters+="/"}break;case 123*variable:points[index++]=Utility_strlen(characters)*ampersand;case 125*variable:case 59:case 0:switch(character){case 0:case 125:scanning=0;case 59+offset:-1==ampersand&&(characters=Utility_replace(characters,/\f/g,"")),property>0&&Utility_strlen(characters)-length&&Utility_append(property>32?declaration(characters+";",rule,parent,length-1):declaration(Utility_replace(characters," ","")+";",rule,parent,length-2),declarations);break;case 59:characters+=";";default:if(Utility_append(reference=ruleset(characters,root,parent,index,offset,rules,points,type,props=[],children=[],length),rulesets),123===character)if(0===offset)parse(characters,root,reference,reference,props,rulesets,length,points,children);else switch(99===atrule&&110===Utility_charat(characters,3)?100:atrule){case 100:case 108:case 109:case 115:parse(value,reference,reference,rule&&Utility_append(ruleset(value,reference,reference,0,0,rules,points,type,rules,props=[],length),children),rules,children,length,points,rule?props:children);break;default:parse(characters,reference,reference,reference,[""],children,0,points,children)}}index=offset=property=0,variable=ampersand=1,type=characters="",length=pseudo;break;case 58:length=1+Utility_strlen(characters),property=previous;default:if(variable<1)if(123==character)--variable;else if(125==character&&0==variable++&&125==prev())continue;switch(characters+=Utility_from(character),character*variable){case 38:ampersand=offset>0?1:(characters+="\f",-1);break;case 44:points[index++]=(Utility_strlen(characters)-1)*ampersand,ampersand=1;break;case 64:45===peek()&&(characters+=delimit(next())),atrule=peek(),offset=length=Utility_strlen(type=characters+=identifier(caret())),character++;break;case 45:45===previous&&2==Utility_strlen(characters)&&(variable=0)}}return rulesets}function ruleset(value,root,parent,index,offset,rules,points,type,props,children,length){for(var post=offset-1,rule=0===offset?rules:[""],size=Utility_sizeof(rule),i=0,j=0,k=0;i<index;++i)for(var x=0,y=Utility_substr(value,post+1,post=abs(j=points[i])),z=value;x<size;++x)(z=trim(j>0?rule[x]+" "+y:Utility_replace(y,/&\f/g,rule[x])))&&(props[k++]=z);return node(value,root,parent,0===offset?Enum_RULESET:type,props,children,length)}function comment(value,root,parent){return node(value,root,parent,COMMENT,Utility_from(character),Utility_substr(value,2,-2),0)}function declaration(value,root,parent,length){return node(value,root,parent,Enum_DECLARATION,Utility_substr(value,0,length),Utility_substr(value,length+1,-1),length)}var identifierWithPointTracking=function(begin,points,index){for(var previous=0,character=0;previous=character,character=peek(),38===previous&&12===character&&(points[index]=1),!token(character);)next();return slice(begin,position)},getRules=function(value,points){return dealloc(function(parsed,points){var index=-1,character=44;do{switch(token(character)){case 0:38===character&&12===peek()&&(points[index]=1),parsed[index]+=identifierWithPointTracking(position-1,points,index);break;case 2:parsed[index]+=delimit(character);break;case 4:if(44===character){parsed[++index]=58===peek()?"&\f":"",points[index]=parsed[index].length;break}default:parsed[index]+=Utility_from(character)}}while(character=next());return parsed}(alloc(value),points))},fixedElements=new WeakMap,compat=function(element){if("rule"===element.type&&element.parent&&!(element.length<1)){for(var value=element.value,parent=element.parent,isImplicitRule=element.column===parent.column&&element.line===parent.line;"rule"!==parent.type;)if(!(parent=parent.parent))return;if((1!==element.props.length||58===value.charCodeAt(0)||fixedElements.get(parent))&&!isImplicitRule){fixedElements.set(element,!0);for(var points=[],rules=getRules(value,points),parentRules=parent.props,i=0,k=0;i<rules.length;i++)for(var j=0;j<parentRules.length;j++,k++)element.props[k]=points[i]?rules[i].replace(/&\f/g,parentRules[j]):parentRules[j]+" "+rules[i]}}},removeLabel=function(element){if("decl"===element.type){var value=element.value;108===value.charCodeAt(0)&&98===value.charCodeAt(2)&&(element.return="",element.value="")}};function emotion_cache_browser_esm_prefix(value,length){switch(function(value,length){return 45^Utility_charat(value,0)?(((length<<2^Utility_charat(value,0))<<2^Utility_charat(value,1))<<2^Utility_charat(value,2))<<2^Utility_charat(value,3):0}(value,length)){case 5103:return"-webkit-print-"+value+value;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return"-webkit-"+value+value;case 5349:case 4246:case 4810:case 6968:case 2756:return"-webkit-"+value+"-moz-"+value+"-ms-"+value+value;case 6828:case 4268:return"-webkit-"+value+"-ms-"+value+value;case 6165:return"-webkit-"+value+"-ms-flex-"+value+value;case 5187:return"-webkit-"+value+Utility_replace(value,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+value;case 5443:return"-webkit-"+value+"-ms-flex-item-"+Utility_replace(value,/flex-|-self/,"")+value;case 4675:return"-webkit-"+value+"-ms-flex-line-pack"+Utility_replace(value,/align-content|flex-|-self/,"")+value;case 5548:return"-webkit-"+value+"-ms-"+Utility_replace(value,"shrink","negative")+value;case 5292:return"-webkit-"+value+"-ms-"+Utility_replace(value,"basis","preferred-size")+value;case 6060:return"-webkit-box-"+Utility_replace(value,"-grow","")+"-webkit-"+value+"-ms-"+Utility_replace(value,"grow","positive")+value;case 4554:return"-webkit-"+Utility_replace(value,/([^-])(transform)/g,"$1-webkit-$2")+value;case 6187:return Utility_replace(Utility_replace(Utility_replace(value,/(zoom-|grab)/,"-webkit-$1"),/(image-set)/,"-webkit-$1"),value,"")+value;case 5495:case 3959:return Utility_replace(value,/(image-set\([^]*)/,"-webkit-$1$`$1");case 4968:return Utility_replace(Utility_replace(value,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+"-webkit-"+value+value;case 4095:case 3583:case 4068:case 2532:return Utility_replace(value,/(.+)-inline(.+)/,"-webkit-$1$2")+value;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Utility_strlen(value)-1-length>6)switch(Utility_charat(value,length+1)){case 109:if(45!==Utility_charat(value,length+4))break;case 102:return Utility_replace(value,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1-moz-"+(108==Utility_charat(value,length+3)?"$3":"$2-$3"))+value;case 115:return~indexof(value,"stretch")?emotion_cache_browser_esm_prefix(Utility_replace(value,"stretch","fill-available"),length)+value:value}break;case 4949:if(115!==Utility_charat(value,length+1))break;case 6444:switch(Utility_charat(value,Utility_strlen(value)-3-(~indexof(value,"!important")&&10))){case 107:return Utility_replace(value,":",":-webkit-")+value;case 101:return Utility_replace(value,/(.+:)([^;!]+)(;|!.+)?/,"$1-webkit-"+(45===Utility_charat(value,14)?"inline-":"")+"box$3$1-webkit-$2$3$1-ms-$2box$3")+value}break;case 5936:switch(Utility_charat(value,length+11)){case 114:return"-webkit-"+value+"-ms-"+Utility_replace(value,/[svh]\w+-[tblr]{2}/,"tb")+value;case 108:return"-webkit-"+value+"-ms-"+Utility_replace(value,/[svh]\w+-[tblr]{2}/,"tb-rl")+value;case 45:return"-webkit-"+value+"-ms-"+Utility_replace(value,/[svh]\w+-[tblr]{2}/,"lr")+value}return"-webkit-"+value+"-ms-"+value+value}return value}var defaultStylisPlugins=[function(element,index,children,callback){if(element.length>-1&&!element.return)switch(element.type){case Enum_DECLARATION:element.return=emotion_cache_browser_esm_prefix(element.value,element.length);break;case"@keyframes":return Serializer_serialize([Tokenizer_copy(element,{value:Utility_replace(element.value,"@","@-webkit-")})],callback);case Enum_RULESET:if(element.length)return function(array,callback){return array.map(callback).join("")}(element.props,(function(value){switch(function(value,pattern){return(value=pattern.exec(value))?value[0]:value}(value,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Serializer_serialize([Tokenizer_copy(element,{props:[Utility_replace(value,/:(read-\w+)/,":-moz-$1")]})],callback);case"::placeholder":return Serializer_serialize([Tokenizer_copy(element,{props:[Utility_replace(value,/:(plac\w+)/,":-webkit-input-$1")]}),Tokenizer_copy(element,{props:[Utility_replace(value,/:(plac\w+)/,":-moz-$1")]}),Tokenizer_copy(element,{props:[Utility_replace(value,/:(plac\w+)/,"-ms-input-$1")]})],callback)}return""}))}}],createCache=function(options){var key=options.key;if("css"===key){var ssrStyles=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(ssrStyles,(function(node){-1!==node.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(node),node.setAttribute("data-s",""))}))}var stylisPlugins=options.stylisPlugins||defaultStylisPlugins;var container,_insert,inserted={},nodesToHydrate=[];container=options.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+key+' "]'),(function(node){for(var attrib=node.getAttribute("data-emotion").split(" "),i=1;i<attrib.length;i++)inserted[attrib[i]]=!0;nodesToHydrate.push(node)}));var currentSheet,collection,length,callback,finalizingPlugins=[stringify,(callback=function(rule){currentSheet.insert(rule)},function(element){element.root||(element=element.return)&&callback(element)})],serializer=(collection=[compat,removeLabel].concat(stylisPlugins,finalizingPlugins),length=Utility_sizeof(collection),function(element,index,children,callback){for(var output="",i=0;i<length;i++)output+=collection[i](element,index,children,callback)||"";return output});_insert=function(selector,serialized,sheet,shouldCache){currentSheet=sheet,Serializer_serialize(compile(selector?selector+"{"+serialized.styles+"}":serialized.styles),serializer),shouldCache&&(cache.inserted[serialized.name]=!0)};var cache={key,sheet:new StyleSheet({key,container,nonce:options.nonce,speedy:options.speedy,prepend:options.prepend,insertionPoint:options.insertionPoint}),nonce:options.nonce,inserted,registered:{},insert:_insert};return cache.sheet.hydrate(nodesToHydrate),cache};var unitlessKeys={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},hyphenateRegex=/[A-Z]|^ms/g,animationRegex=/_EMO_([^_]+?)_([^]*?)_EMO_/g,isCustomProperty=function(property){return 45===property.charCodeAt(1)},isProcessableValue=function(value){return null!=value&&"boolean"!=typeof value},processStyleName=memoize((function(styleName){return isCustomProperty(styleName)?styleName:styleName.replace(hyphenateRegex,"-$&").toLowerCase()})),processStyleValue=function(key,value){switch(key){case"animation":case"animationName":if("string"==typeof value)return value.replace(animationRegex,(function(match,p1,p2){return cursor={name:p1,styles:p2,next:cursor},p1}))}return 1===unitlessKeys[key]||isCustomProperty(key)||"number"!=typeof value||0===value?value:value+"px"};function handleInterpolation(mergedProps,registered,interpolation){if(null==interpolation)return"";if(void 0!==interpolation.__emotion_styles)return interpolation;switch(typeof interpolation){case"boolean":return"";case"object":if(1===interpolation.anim)return cursor={name:interpolation.name,styles:interpolation.styles,next:cursor},interpolation.name;if(void 0!==interpolation.styles){var next=interpolation.next;if(void 0!==next)for(;void 0!==next;)cursor={name:next.name,styles:next.styles,next:cursor},next=next.next;return interpolation.styles+";"}return function(mergedProps,registered,obj){var string="";if(Array.isArray(obj))for(var i=0;i<obj.length;i++)string+=handleInterpolation(mergedProps,registered,obj[i])+";";else for(var _key in obj){var value=obj[_key];if("object"!=typeof value)null!=registered&&void 0!==registered[value]?string+=_key+"{"+registered[value]+"}":isProcessableValue(value)&&(string+=processStyleName(_key)+":"+processStyleValue(_key,value)+";");else if(!Array.isArray(value)||"string"!=typeof value[0]||null!=registered&&void 0!==registered[value[0]]){var interpolated=handleInterpolation(mergedProps,registered,value);switch(_key){case"animation":case"animationName":string+=processStyleName(_key)+":"+interpolated+";";break;default:string+=_key+"{"+interpolated+"}"}}else for(var _i=0;_i<value.length;_i++)isProcessableValue(value[_i])&&(string+=processStyleName(_key)+":"+processStyleValue(_key,value[_i])+";")}return string}(mergedProps,registered,interpolation);case"function":if(void 0!==mergedProps){var previousCursor=cursor,result=interpolation(mergedProps);return cursor=previousCursor,handleInterpolation(mergedProps,registered,result)}}if(null==registered)return interpolation;var cached=registered[interpolation];return void 0!==cached?cached:interpolation}var cursor,labelPattern=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var useInsertionEffect=!!external_window_React_unsafeWindow_React_.useInsertionEffect&&external_window_React_unsafeWindow_React_.useInsertionEffect,emotion_use_insertion_effect_with_fallbacks_browser_esm_useInsertionEffectAlwaysWithSyncFallback=useInsertionEffect||function(create){return create()},EmotionCacheContext=(useInsertionEffect||external_window_React_unsafeWindow_React_.useLayoutEffect,external_window_React_unsafeWindow_React_.createContext("undefined"!=typeof HTMLElement?createCache({key:"css"}):null));EmotionCacheContext.Provider;var withEmotionCache=function(func){return(0,external_window_React_unsafeWindow_React_.forwardRef)((function(props,ref){var cache=(0,external_window_React_unsafeWindow_React_.useContext)(EmotionCacheContext);return func(props,cache,ref)}))};var ThemeContext=external_window_React_unsafeWindow_React_.createContext({});var emotion_utils_browser_esm_registerStyles=function(cache,serialized,isStringTag){var className=cache.key+"-"+serialized.name;!1===isStringTag&&void 0===cache.registered[className]&&(cache.registered[className]=serialized.styles)},testOmitPropsOnStringTag=isPropValid,testOmitPropsOnComponent=function(key){return"theme"!==key},getDefaultShouldForwardProp=function(tag){return"string"==typeof tag&&tag.charCodeAt(0)>96?testOmitPropsOnStringTag:testOmitPropsOnComponent},composeShouldForwardProps=function(tag,options,isReal){var shouldForwardProp;if(options){var optionsShouldForwardProp=options.shouldForwardProp;shouldForwardProp=tag.__emotion_forwardProp&&optionsShouldForwardProp?function(propName){return tag.__emotion_forwardProp(propName)&&optionsShouldForwardProp(propName)}:optionsShouldForwardProp}return"function"!=typeof shouldForwardProp&&isReal&&(shouldForwardProp=tag.__emotion_forwardProp),shouldForwardProp},emotion_styled_base_browser_esm_Insertion=function(_ref){var cache=_ref.cache,serialized=_ref.serialized,isStringTag=_ref.isStringTag;return emotion_utils_browser_esm_registerStyles(cache,serialized,isStringTag),emotion_use_insertion_effect_with_fallbacks_browser_esm_useInsertionEffectAlwaysWithSyncFallback((function(){return function(cache,serialized,isStringTag){emotion_utils_browser_esm_registerStyles(cache,serialized,isStringTag);var className=cache.key+"-"+serialized.name;if(void 0===cache.inserted[serialized.name]){var current=serialized;do{cache.insert(serialized===current?"."+className:"",current,cache.sheet,!0),current=current.next}while(void 0!==current)}}(cache,serialized,isStringTag)})),null},createStyled=function createStyled(tag,options){var identifierName,targetClassName,isReal=tag.__emotion_real===tag,baseTag=isReal&&tag.__emotion_base||tag;void 0!==options&&(identifierName=options.label,targetClassName=options.target);var shouldForwardProp=composeShouldForwardProps(tag,options,isReal),defaultShouldForwardProp=shouldForwardProp||getDefaultShouldForwardProp(baseTag),shouldUseAs=!defaultShouldForwardProp("as");return function(){var args=arguments,styles=isReal&&void 0!==tag.__emotion_styles?tag.__emotion_styles.slice(0):[];if(void 0!==identifierName&&styles.push("label:"+identifierName+";"),null==args[0]||void 0===args[0].raw)styles.push.apply(styles,args);else{0,styles.push(args[0][0]);for(var len=args.length,i=1;i<len;i++)styles.push(args[i],args[0][i])}var Styled=withEmotionCache((function(props,cache,ref){var registered,registeredStyles,classNames,rawClassName,FinalTag=shouldUseAs&&props.as||baseTag,className="",classInterpolations=[],mergedProps=props;if(null==props.theme){for(var key in mergedProps={},props)mergedProps[key]=props[key];mergedProps.theme=external_window_React_unsafeWindow_React_.useContext(ThemeContext)}"string"==typeof props.className?(registered=cache.registered,registeredStyles=classInterpolations,classNames=props.className,rawClassName="",classNames.split(" ").forEach((function(className){void 0!==registered[className]?registeredStyles.push(registered[className]+";"):rawClassName+=className+" "})),className=rawClassName):null!=props.className&&(className=props.className+" ");var serialized=function(args,registered,mergedProps){if(1===args.length&&"object"==typeof args[0]&&null!==args[0]&&void 0!==args[0].styles)return args[0];var stringMode=!0,styles="";cursor=void 0;var strings=args[0];null==strings||void 0===strings.raw?(stringMode=!1,styles+=handleInterpolation(mergedProps,registered,strings)):styles+=strings[0];for(var i=1;i<args.length;i++)styles+=handleInterpolation(mergedProps,registered,args[i]),stringMode&&(styles+=strings[i]);labelPattern.lastIndex=0;for(var match,identifierName="";null!==(match=labelPattern.exec(styles));)identifierName+="-"+match[1];var name=function(str){for(var k,h=0,i=0,len=str.length;len>=4;++i,len-=4)k=1540483477*(65535&(k=255&str.charCodeAt(i)|(255&str.charCodeAt(++i))<<8|(255&str.charCodeAt(++i))<<16|(255&str.charCodeAt(++i))<<24))+(59797*(k>>>16)<<16),h=1540483477*(65535&(k^=k>>>24))+(59797*(k>>>16)<<16)^1540483477*(65535&h)+(59797*(h>>>16)<<16);switch(len){case 3:h^=(255&str.charCodeAt(i+2))<<16;case 2:h^=(255&str.charCodeAt(i+1))<<8;case 1:h=1540483477*(65535&(h^=255&str.charCodeAt(i)))+(59797*(h>>>16)<<16)}return(((h=1540483477*(65535&(h^=h>>>13))+(59797*(h>>>16)<<16))^h>>>15)>>>0).toString(36)}(styles)+identifierName;return{name,styles,next:cursor}}(styles.concat(classInterpolations),cache.registered,mergedProps);className+=cache.key+"-"+serialized.name,void 0!==targetClassName&&(className+=" "+targetClassName);var finalShouldForwardProp=shouldUseAs&&void 0===shouldForwardProp?getDefaultShouldForwardProp(FinalTag):defaultShouldForwardProp,newProps={};for(var _key in props)shouldUseAs&&"as"===_key||finalShouldForwardProp(_key)&&(newProps[_key]=props[_key]);return newProps.className=className,newProps.ref=ref,external_window_React_unsafeWindow_React_.createElement(external_window_React_unsafeWindow_React_.Fragment,null,external_window_React_unsafeWindow_React_.createElement(emotion_styled_base_browser_esm_Insertion,{cache,serialized,isStringTag:"string"==typeof FinalTag}),external_window_React_unsafeWindow_React_.createElement(FinalTag,newProps))}));return Styled.displayName=void 0!==identifierName?identifierName:"Styled("+("string"==typeof baseTag?baseTag:baseTag.displayName||baseTag.name||"Component")+")",Styled.defaultProps=tag.defaultProps,Styled.__emotion_real=Styled,Styled.__emotion_base=baseTag,Styled.__emotion_styles=styles,Styled.__emotion_forwardProp=shouldForwardProp,Object.defineProperty(Styled,"toString",{value:function(){return"."+targetClassName}}),Styled.withComponent=function(nextTag,nextOptions){return createStyled(nextTag,extends_extends({},options,nextOptions,{shouldForwardProp:composeShouldForwardProps(Styled,nextOptions,!0)})).apply(void 0,styles)},Styled}};class BulkSetTurnOpcodeActions extends MultiAction{actionName="BULK_SET_TURN_OPCODES";constructor(_newTurns,props){super(props),this._newTurns=_newTurns}_doSetTurnSubAction(dataModel,turnNodes,newInstruction){const turnGraph=dataModel.getTurnGraph(),previousTurn=turnGraph.getTurn(turnNodes.fromVertex,turnNodes.toVertex),previousTurnData=previousTurn.getTurnData(),newTurn=previousTurn.withTurnData(previousTurnData.withInstructionOpcode(newInstruction));this.doSubAction(dataModel,new SetTurnAction(turnGraph,newTurn))}doAction(dataModel){this._newTurns.forEach((turn=>this._doSetTurnSubAction(dataModel,turn,turn.opcode)))}generateDescription(){return this._description=(0,get_wme_window.B)().I18n.t("jb_utils.save.changes_log.actions.BulkSetTurn",{count:this._newTurns.length}),this._description}}function getRoundaboutByNode(node){const segIDs=node.getSegmentIds(),roundaboutSegment=node.model.segments.getByIds(segIDs).find((seg=>seg.isInRoundabout())),roundaboutId=roundaboutSegment.getAttribute("junctionID");return roundaboutSegment.model.junctions.getObjectById(roundaboutId)}function getBigJunctionFromSegment(segment,attributeName){const bigJunctions=segment.getAttribute(attributeName);if(!bigJunctions||!Array.isArray(bigJunctions)||0===bigJunctions.length)return null;const bigJunctionId=bigJunctions[0];if("number"!=typeof bigJunctionId)return null;return segment.model.getRepository(WazeMapEditorEntityType.BigJunction).getObjectById(bigJunctionId)}function getToBigJunctionFromSegment(segment){return getBigJunctionFromSegment(segment,"toCrossroads")}function getFromBigJunctionFromSegment(segment){return getBigJunctionFromSegment(segment,"fromCrossroads")}function getBigJunctionFromSegmentAndDirection(segment,direction){return("forward"===direction?getToBigJunctionFromSegment:getFromBigJunctionFromSegment)(segment)}function getRoundaboutExitsFrom(vertex,dataModel){const node=getJunctionNodeFromSegmentDirection(getSegmentByVertex(dataModel,vertex),"fwd"===vertex.direction?"forward":"reverse");if(node.isConnectedToBigJunction())return function(segment,direction,bigJunction=getBigJunctionFromSegmentAndDirection(segment,direction)){if(!bigJunction)return null;const segmentVertex=createVertexFromSegment(segment,direction);return bigJunction.getTurnsFrom(segmentVertex)}(getSegmentByVertex(dataModel,vertex),"fwd"===vertex.direction?"forward":"reverse");const roundabout=getRoundaboutByNode(node);if(!roundabout)throw new Error("Roundabout not found at node "+node.getAttribute("id"));const roundaboutSegIDs=roundabout.getSegmentsIds(),roundaboutSegments=roundabout.model.segments.getByIds(roundaboutSegIDs),paths=[];for(const roundaboutSegment of roundaboutSegments){const node=getSegmentDestinationNodeInTravelDirection(roundaboutSegment);if(!node)return[];const nodeSegIDs=node.getSegmentIds(),nodeSegments=node.model.segments.getByIds(nodeSegIDs);for(const segment of nodeSegments)if(!segment.isInRoundabout()){if(isSegmentDirectionAllowed(segment,"forward")){getJunctionNodeFromSegmentDirection(segment,"forward").getAttribute("id")!==node.getAttribute("id")&&paths.push({fromVertex:vertex,toVertex:createForwardVertexFromSegment(segment)})}if(isSegmentDirectionAllowed(segment,"reverse")){getJunctionNodeFromSegmentDirection(segment,"reverse").getAttribute("id")!==node.getAttribute("id")&&paths.push({fromVertex:vertex,toVertex:createReverseVertexFromSegment(segment)})}}}return paths}function getReactFiberNode(element){const keys=Object.keys(element);for(let i=0;i<keys.length;i++){const key=keys[i];if(key.startsWith("__reactFiber$"))return element[key].return}return null}function findFiberParentNode(currentFiberNode,predicate){for(;currentFiberNode;){if(predicate(currentFiberNode))return currentFiberNode;currentFiberNode=currentFiberNode.return}return null}function getDrawBigJunctionPolygonButtonFiber(){const drawPolygonButton=document.querySelector("#toolbar .toolbar-collection-component .toolbar-group-drawing wz-menu .toolbar-group-item.junction-box wz-button.polygon");return drawPolygonButton?getReactFiberNode(drawPolygonButton):null}function getDrawBigJunctionHandler(){const toolbarFiber=function(){const drawPolygonButtonFiber=getDrawBigJunctionPolygonButtonFiber();return drawPolygonButtonFiber?findFiberParentNode(drawPolygonButtonFiber.alternate??drawPolygonButtonFiber,(node=>"model"in node.memoizedProps&&"attributes"in node.memoizedProps.model&&"junction-box"===node.memoizedProps.model.attributes.toolbarMenuItemClass&&"control"in node.memoizedProps.model.attributes)):null}();return toolbarFiber.memoizedProps.model.attributes.control.drawCallback}function createAddBigJunctionAction(polygon){const actions=function(effect){const newActions=[],methodInterceptor=new BeforeMethodInvocationInterceptor((0,get_wme_window.B)().W.model.actionManager,"add",(newAction=>{newActions.push(newAction)}));return methodInterceptor.enable(),effect(),methodInterceptor.disable(),newActions}((()=>{!function(polygon){const drawAttributes=function(polygon){return{getGeometry:()=>polygon}}(polygon);getDrawBigJunctionHandler()(drawAttributes)}(polygon)}));return actions.find((action=>isAddBigJunctionAction(action)))}let TurnInstructionOpcode=function(TurnInstructionOpcode){return TurnInstructionOpcode.Continue="CONTINUE",TurnInstructionOpcode.ExitLeft="EXIT_LEFT",TurnInstructionOpcode.ExitRight="EXIT_RIGHT",TurnInstructionOpcode.KeepLeft="KEEP_LEFT",TurnInstructionOpcode.KeepRight="KEEP_RIGHT",TurnInstructionOpcode.TurnLeft="TURN_LEFT",TurnInstructionOpcode.TurnRight="TURN_RIGHT",TurnInstructionOpcode.UTurn="UTURN",TurnInstructionOpcode.CountRoundaboutExits="ROUNDABOUT_ENTER",TurnInstructionOpcode.None="None",TurnInstructionOpcode}({});function getPreferredInstructionFromTurn(turn){return function(angle){return angle>=45&&angle<135?TurnInstructionOpcode.TurnLeft:angle>=135&&angle<225?TurnInstructionOpcode.UTurn:angle>=225&&angle<315?TurnInstructionOpcode.TurnRight:TurnInstructionOpcode.Continue}(getAbsoluteTurnAngleInDegrees(turn))}const normalization_method={type:"NORMALIZATION",application:function(turns){const opcodeHashMap=new Map,hashTurnMap=new Map;return turns.forEach((turn=>{let preferredOpcode=getPreferredInstructionFromTurn(turn);if(opcodeHashMap.has(preferredOpcode)){const ambiguousTurnHash=opcodeHashMap.get(preferredOpcode);if(ambiguousTurnHash){const ambiguousTurn=hashTurnMap.get(ambiguousTurnHash);hashTurnMap.set(ambiguousTurnHash,{...ambiguousTurn,opcode:TurnInstructionOpcode.CountRoundaboutExits}),opcodeHashMap.set(preferredOpcode,null),preferredOpcode=TurnInstructionOpcode.CountRoundaboutExits}}const turnId=turn.fromVertex.getID()+turn.toVertex.getID();preferredOpcode!==TurnInstructionOpcode.CountRoundaboutExits&&opcodeHashMap.set(preferredOpcode,turnId),hashTurnMap.set(turnId,{...turn,opcode:preferredOpcode})})),Array.from(hashTurnMap.values())}},denormalization_method={type:"DE_NORMALIZATION",application:function(turns){return turns.map((turn=>({...turn,opcode:TurnInstructionOpcode.CountRoundaboutExits})))}};class UnresolvableRoundaboutTurns extends Error{static _messageFactory(vertex,reason){const header=`Unable to get available roundabuot turns for vertex ${vertex.getID()}`;return reason?`${header}. ${reason}`:header}constructor(vertex,dataModel,reason){super(UnresolvableRoundaboutTurns._messageFactory(vertex,reason)),this._dataModel,this._vertex=vertex,this._reason=reason}get segment(){return this._dataModel.segments.getById(this._vertex.getSegmentID())}get direction(){switch(this._vertex.direction){case"fwd":return"forward";case"rev":return"reverse";default:throw new Error("Unsupported direction: "+this._vertex.direction)}}get vertex(){return this._vertex}}const DEFAULT_INSTRUCTION_METHODS=[normalization_method,denormalization_method];class RoundaboutInstructionEngine{_availableInstructionMethods=[...DEFAULT_INSTRUCTION_METHODS];_instructionMethodTurnsMap=new Map;constructor(dataModel,fromSegment,fromSegmentDirection){this._dataModel=dataModel,this._fromVertex=createVertexFromSegment(fromSegment,fromSegmentDirection),this._roundaboutJunction=getRoundaboutByNode(getJunctionNodeFromSegmentDirection(fromSegment,fromSegmentDirection)),this._bigJunction=getBigJunctionFromSegmentAndDirection(fromSegment,fromSegmentDirection)}_getFromSegment(){const segmentId=this._fromVertex.getSegmentID();return this._dataModel.segments.getObjectById(segmentId)}_getFromSegmentDirection(){switch(this._fromVertex.direction){case"fwd":return"forward";case"rev":return"reverse";default:throw new Error("Unsupported direction")}}_isDrivingAllowed(){return isSegmentDirectionAllowed(this._getFromSegment(),this._getFromSegmentDirection())}_isConnectedToRoundabout(){return isSegmentConnectsToRoundabout(this._getFromSegment(),this._getFromSegmentDirection())}getAvailableInstructionMethods(){return this._availableInstructionMethods}getPopulatedInstructionMethods(){return Array.from(this._instructionMethodTurnsMap.keys(),(rimType=>this._availableInstructionMethods.find((rim=>rim.type===rimType))))}getAvailableTurnNodes(){if(!this._isDrivingAllowed())throw new UnresolvableRoundaboutTurns(this._fromVertex,this._dataModel,"Driving direction restricted");if(!this._isConnectedToRoundabout())throw new UnresolvableRoundaboutTurns(this._fromVertex,this._dataModel,"Not connected to a roundabout");return getRoundaboutExitsFrom(this._fromVertex,this._dataModel)}calcTurnsForAvailableInstructionMethods(){const turnNodes=this.getAvailableTurnNodes();turnNodes.length&&this.getAvailableInstructionMethods().forEach((method=>{this._instructionMethodTurnsMap.set(method.type,method.application(turnNodes))}))}_hasBigJunction(){const segment=this._getFromSegment();switch(this._getFromSegmentDirection()){case"forward":return segment.getAttribute("toCrossroads").length>0;case"reverse":return segment.getAttribute("fromCrossroads").length>0;default:return!1}}_createAddBigJunctionIfNotExistAction(){if(this._hasBigJunction())return null;const addBigJunctionAction=createAddBigJunctionAction(transform_scale_dist_es(extractRoundaboutPerimeterPolygon(this._roundaboutJunction),1.2));return addBigJunctionAction.__jbuSkipAutoRoundaboutize=!0,addBigJunctionAction}applyInstructionMethod(instructionMethod){const addBigJunctionAction=this._createAddBigJunctionIfNotExistAction(),turnNodesAndOpcodes=this._instructionMethodTurnsMap.get(instructionMethod.type),applyTIOsAction=new BulkSetTurnOpcodeActions(turnNodesAndOpcodes);if(addBigJunctionAction){const multiActionWrapper=new MultiAction([addBigJunctionAction,applyTIOsAction]);return multiActionWrapper.generateDescription=function(){this._description=applyTIOsAction.generateDescription()},void(0,get_wme_window.B)().W.model.actionManager.add(multiActionWrapper)}(0,get_wme_window.B)().W.model.actionManager.add(applyTIOsAction)}}function isReactProviderNode(node){return node.elementType&&"object"==typeof node.elementType&&node.elementType.hasOwnProperty("$$typeof")&&node.elementType.hasOwnProperty("_context")&&"Symbol(react.provider)"===node.elementType.$$typeof.toString()}function useTurnArrowTooltips(){const[openTurnArrows,setOpenTurnArrowContainers]=(0,external_window_React_unsafeWindow_React_.useReducer)(((_prevState,newTooltipContainers)=>newTooltipContainers.map((tooltipContainer=>{const fiberNode=getReactFiberNode(tooltipContainer);if(!fiberNode)throw new Error("Fiber node not found");const turnArrowProviderNode=findFiberParentNode(fiberNode,(node=>isReactProviderNode(node)&&"object"==typeof node.memoizedProps.value&&node.memoizedProps.value.hasOwnProperty("turnArrow")));if(!isReactProviderNode(turnArrowProviderNode))return null;return{element:tooltipContainer,turnArrow:turnArrowProviderNode.memoizedProps.value.turnArrow}}))),[]);return function(target,callback,options){const observer=(0,external_window_React_unsafeWindow_React_.useRef)(),memoizedCallback=useEventCallback(callback),observeTarget=(0,external_window_React_unsafeWindow_React_.useCallback)((()=>{observer.current&&observer.current.observe(target,options)}),[options,target]),disconnectTarget=(0,external_window_React_unsafeWindow_React_.useCallback)((()=>{observer.current&&observer.current.disconnect()}),[]);useUnmount(disconnectTarget),(0,external_window_React_unsafeWindow_React_.useEffect)((()=>{disconnectTarget(),observer.current=new MutationObserver(memoizedCallback),observeTarget()}),[memoizedCallback,disconnectTarget,observeTarget])}(document.body,(()=>{const turnArrowTooltips=document.body.querySelectorAll("& > [data-tippy-root] div.turn-arrow-tooltip");setOpenTurnArrowContainers(Array.from(turnArrowTooltips))}),{childList:!0}),openTurnArrows}function TooltipControl({label,children}){return React.createElement("div",{className:"tooltip-control"},React.createElement("label",null,label),children)}const TurnArrowTooltipButtonsRoot=createStyled("div",{target:"e155stmk0"})({name:"uwfy6e",styles:"display:flex;gap:6px;align-items:center;flex-wrap:wrap"});function RoundaboutExitInstructionNormalizationButton(props){const engine=(0,external_window_React_unsafeWindow_React_.useMemo)((()=>{const instructionEngine=new RoundaboutInstructionEngine(props.segment.model,props.segment,props.direction);return instructionEngine.calcTurnsForAvailableInstructionMethods(),instructionEngine}),[props.direction,props.segment]),t=useTranslate(),nodeLabel="forward"===props.direction?"B":"A",turnArrowTooltips=useTurnArrowTooltips(),immediateTurnArrowTooltip=(0,external_window_React_unsafeWindow_React_.useMemo)((()=>turnArrowTooltips.find((turnArrowTooltip=>!turnArrowTooltip.turnArrow.getTurn().isFarTurn()))),[turnArrowTooltips]),instructionMethodButtons=engine.getPopulatedInstructionMethods().map((rim=>React.createElement(WzButton,{key:rim.type,onClick:()=>engine.applyInstructionMethod(rim),size:"sm",color:"text"},t(`jb_utils.segment.actions.exit_instructions.${rim.type}`,{node:nodeLabel})))),turnArrowPortal=immediateTurnArrowTooltip?(0,external_window_ReactDOM_unsafeWindow_ReactDOM_namespaceObject.createPortal)(React.createElement(TooltipControl,{label:t("jb_utils.turn_tooltip.roundabout.title")},React.createElement(TurnArrowTooltipButtonsRoot,null,instructionMethodButtons.map((button=>(0,external_window_React_unsafeWindow_React_.cloneElement)(button,{color:"secondary",children:t(`jb_utils.segment.actions.exit_instructions.${button.key}_SHORT`)}))))),immediateTurnArrowTooltip.element):null;return[...instructionMethodButtons,turnArrowPortal]}class RoundaboutExitInstructionNormalizationTemplate{constructor(segments){this._segment=segments[0]}static getSupportedElementTypes(){return[WazeMapEditorEntityType.Segment]}getTargetElement(){return document.querySelector(".segment-edit-section .form-group.more-actions")}static isEnabledForElements(segments){return 1===segments.length&&isSegmentConnectsToRoundabout(segments[0])}render(){return[this.renderForDirection("reverse"),this.renderForDirection("forward")]}renderForDirection(direction){const connectsToRoundabout=isSegmentConnectsToRoundabout(this._segment,direction),drivable=isSegmentDirectionAllowed(this._segment,direction);return connectsToRoundabout&&drivable?React.createElement(RoundaboutExitInstructionNormalizationButton,{segment:this._segment,direction}):null}}function CloneRoundaboutGeometryToBigJunctionButton({bigJunction}){const t=useTranslate(),addBigJunctionAction=function(bigJunction){const latestActions=(0,get_wme_window.B)().W.model.actionManager.getActions();return(0,external_window_React_unsafeWindow_React_.useMemo)((()=>latestActions.find((action=>isAddBigJunctionAction(action)&&action.bigJunction===bigJunction))),[bigJunction,latestActions])}(bigJunction);return React.createElement(WzButton,{color:"text",disabled:!addBigJunctionAction,onClick:()=>{const dataModel=(0,get_wme_window.B)().W.model,map=(0,get_wme_window.B)().W.map,action=new UpdateBigJunctionGeometryToRoundaboutAction(addBigJunctionAction,dataModel,map);dataModel.actionManager.add(action)}},t("jb_utils.big_junction.actions.clone_roundabout_geom"))}const RoundaboutPerimeterPolygonTemplate=class{static getSupportedElementTypes(){return[WazeMapEditorEntityType.BigJunction]}static isEnabledForElements(bigJunctions){return 1===bigJunctions.length&&"INSERT"===bigJunctions[0].state&&bigJunctions[0].getShortSegments().every((segment=>segment.isInRoundabout()))}constructor(bigJunctions){this._bigJunction=bigJunctions[0]}getTargetElement(){return document.querySelector("#edit-panel .big-junction.sidebar-column .tab-content .form-group .controls.junction-actions")}render(){return external_window_React_unsafeWindow_React_default().createElement(CloneRoundaboutGeometryToBigJunctionButton,{bigJunction:this._bigJunction})}};function AutoBackupToggle(){const t=useTranslate(),[preference,setPreference]=usePreference("auto_backup"),isEnabled=!0===preference;return React.createElement("div",{className:"form-group"},React.createElement(WzCheckbox,{checked:isEnabled,onChange:e=>setPreference(e.target.checked)},t("jb_utils.user.prefs.auto_backup_on_delete")))}function DisableScriptToggle(){const[isDisabled,setIsDisabled]=usePreference("master_disable");return React.createElement(WzButton,{color:"secondary",alarming:isDisabled,onClick:()=>setIsDisabled((state=>!state))},React.createElement("i",{className:"w-icon fa fa-power-off"}))}function TogglePrefsLocationButton(){const t=useTranslate(),[prefsLocation,setPrefsLocation]=usePreference("prefs_location"),moveToLocation=function(location){switch(location){case"tab":return"wme-prefs";case"wme-prefs":return"tab";default:throw new Error("Invalid location "+location)}}(prefsLocation);return React.createElement(WzButton,{onClick:()=>{setPrefsLocation(moveToLocation)},size:"sm",color:"secondary",style:{width:"100%"}},t(`jb_utils.user.prefs.prefs_location.move_to.${moveToLocation}`))}function CloneGeometryToggle(){const t=useTranslate(),[preference,setPreference]=usePreference("roundabout.clone_geometry"),isEnabled=!0===preference,isDetermined="ask"!==preference;return external_window_React_unsafeWindow_React_default().createElement("div",{className:"form-group"},external_window_React_unsafeWindow_React_default().createElement(WzCheckbox,{checked:isEnabled&&isDetermined,indeterminate:!isDetermined,onChange:e=>setPreference(e.target.checked),style:{display:"inline-block",marginInlineEnd:"4px"}},t("jb_utils.user.prefs.roundabout.clone_geometry_toggle.label")),external_window_React_unsafeWindow_React_default().createElement("wz-basic-tooltip",{style:{"--wz-tooltip-content-width":"400px","--wz-tooltip-content-white-space":"normal"}},external_window_React_unsafeWindow_React_default().createElement("wz-tooltip-source",null,external_window_React_unsafeWindow_React_default().createElement("i",{className:"w-icon w-icon-info"})),external_window_React_unsafeWindow_React_default().createElement("wz-tooltip-target",null),external_window_React_unsafeWindow_React_default().createElement("wz-tooltip-content",null,t("jb_utils.user.prefs.roundabout.clone_geometry_toggle.help_label"))))}function PreferencesContent(){return React.createElement(React.Fragment,null,React.createElement("div",{className:"form-group",style:{display:"flex",gap:8}},React.createElement(DisableScriptToggle,null),React.createElement(TogglePrefsLocationButton,null)),React.createElement(CloneGeometryToggle,null),React.createElement(AutoBackupToggle,null))}const PreferencesPanel=createStyled("div",{target:"egi1uwd1"})({name:"1o564ty",styles:"position:absolute;top:0;left:0;width:100%;height:100%;background-color:#fff;z-index:999"}),PreferencesContentPanel=createStyled("div",{target:"egi1uwd0"})({name:"1dvcxr3",styles:"padding:1rem"});function PreferencesList(props){const t=useTranslate();return React.createElement(PreferencesPanel,null,React.createElement(WzSectionHeader,{size:"section-header2",headline:t("user.prefs.subtitle"),subtitle:"Junction Box Utils",slotIcon:React.createElement("i",{className:"w-icon w-icon-settings"}),backButton:!0,onBackClicked:props.onClosed}),React.createElement(PreferencesContentPanel,null,React.createElement(PreferencesContent,null)))}function r(e){var t,f,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=" "),n+=f)}else for(f in e)e[f]&&(n&&(n+=" "),n+=f);return n}const dist_clsx=function(){for(var e,t,f=0,n="",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=" "),n+=t);return n};function ListItemCard_extends(){return ListItemCard_extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},ListItemCard_extends.apply(this,arguments)}function ListItemCard({leftIcon,rightIcon,rightIconStyle,children,...rest}){return React.createElement(WzCard,ListItemCard_extends({elevationOnHover:4,className:"list-item-card"},rest),React.createElement("div",{className:"list-item-card-layout"},getIconElement(leftIcon),React.createElement("div",{className:"list-item-card-info"},children),getIconElement(rightIcon,rightIconStyle)))}function getIconElement(iconName,iconStyles){if(!iconName)return;const iconClassName=dist_clsx("w-icon",`w-icon-${iconName}`);return React.createElement("div",{className:"list-item-card-icon",style:iconStyles},React.createElement("i",{className:iconClassName}))}function PreferencesEntryCard({onClick}){const t=useTranslate();return React.createElement(ListItemCard,{leftIcon:"script",rightIcon:"chevron-right",rightIconStyle:{backgroundColor:"transparent",color:"var(--content_default, #202124)",justifyContent:"end",justifySelf:"end"},onClick},React.createElement("div",{className:"list-item-card-title"},"Junction Box Utils"),React.createElement(WzCaption,null,t("jb_utils.user.prefs.card_helper_text")))}function getEditorPrefsElement(){return document.querySelector("#sidepanel-prefs.tab-pane .settings")}function Preferences(){const[showPreferences,setShowPreferences]=(0,external_window_React_unsafeWindow_React_.useState)(!1),[prefsLocation]=usePreference("prefs_location"),[portal,setPortal]=(0,external_window_React_unsafeWindow_React_.useState)(getEditorPrefsElement());return(0,external_window_React_unsafeWindow_React_.useEffect)((()=>{if("wme-prefs"===prefsLocation)return setPortal(getEditorPrefsElement()),()=>{};const W=(0,get_wme_window.B)().W,scriptTab=W.userscripts.registerSidebarTab("SkY7950gTWTDjkJre4EWD");return scriptTab.tabLabel.innerText="JBU",setPortal(scriptTab.tabPane),()=>{W.userscripts.removeSidebarTab("SkY7950gTWTDjkJre4EWD")}}),[prefsLocation]),(0,external_window_ReactDOM_unsafeWindow_ReactDOM_namespaceObject.createPortal)(React.createElement(React.Fragment,null,"wme-prefs"===prefsLocation&&React.createElement(PreferencesEntryCard,{onClick:setShowPreferences.bind(null,!0)}),showPreferences&&"wme-prefs"===prefsLocation&&React.createElement(PreferencesList,{onClosed:setShowPreferences.bind(null,!1)}),"tab"===prefsLocation&&React.createElement(PreferencesContent,null)),portal)}function addNonExistingTranslationKeys(destination,additionalTranslations,currentPath=""){const appendedTranslationKeys=new Set;for(const translationsKey in additionalTranslations)if(destination.hasOwnProperty(translationsKey)){const value=destination[translationsKey],additionalTransValue=additionalTranslations[translationsKey];if("object"!=typeof value||"object"!=typeof additionalTransValue){Logger.warn(`WazeMapEditor already has the translation key "${currentPath}${translationsKey}", skipping...`);continue}addNonExistingTranslationKeys(value,additionalTransValue,`${currentPath}${translationsKey}.`)}else destination[translationsKey]=additionalTranslations[translationsKey],appendedTranslationKeys.add(translationsKey);return Array.from(appendedTranslationKeys)}function useInjectTranslations(translationsToInject){!function(effect,deps){const lastDeps=(0,external_window_React_unsafeWindow_React_.useRef)(null),cleanupFn=(0,external_window_React_unsafeWindow_React_.useRef)(null);!function(a,b){if(!a||!b)return!1;if(a.length!==b.length)return!1;for(let i=0;i<a.length;i++)if(a[i]!==b[i])return!1;return!0}(lastDeps.current,deps)&&(cleanupFn.current&&cleanupFn.current(),cleanupFn.current=effect(),lastDeps.current=deps)}((()=>{const{I18n}=(0,get_wme_window.B)(),wmeTranslations=I18n.translations[I18n.locale],appendedTranslationKeys=addNonExistingTranslationKeys(wmeTranslations,translationsToInject[I18n.currentLocale()]);return()=>{!function(translationsObject,translationKeys){for(const translationKey of translationKeys)translationsObject.hasOwnProperty(translationKey)&&delete translationsObject[translationKey]}(wmeTranslations,appendedTranslationKeys)}}),[translationsToInject])}const userscript_namespaceObject=JSON.parse('{"jb_utils":{"user":{"prefs":{"card_helper_text":"Update userscript settings","prefs_location":{"move_to":{"tab":"Move to a dedicated userscript tab","wme-prefs":"Move to the editor preferences panel"}},"roundabout":{"clone_geometry_toggle":{"label":"Apply roundabout geometry","help_label":"Select this if you want new junction boxes to have the geometry of the roundabout they are applied to"},"instruction_normalization":{"applied_instruction_badge_type":{"label":"Applied instruction badge display type","graphical":{"label":"Graphical","description":"An icon visualizing the selected instruction will be displayed"},"textual":{"label":"Textual","description":"A single letter will be displayed, determining the applied instruction"}}}},"auto_backup_on_delete":"Automatically backup junction boxes"}},"segment":{"actions":{"exit_instructions":{"NORMALIZATION":"Normalize (Node %{node})","NORMALIZATION_SHORT":"Normalize","DE_NORMALIZATION":"Denormalize (Node %{node})","DE_NORMALIZATION_SHORT":"Denormalize"}}},"big_junction":{"actions":{"clone_roundabout_geom":"Roundaboutize","backup_props":"Backup properties","restore_props":"Restore properties"},"auto_clone_roundabout_geom_confirm":{"title":"Roundaboutize Junction Boxes?","details":"Do you want to use the geometry of the roundabout for this Junction Box?"},"backup_restore":{"restoration_disabled_reasons":{"SIGNATURE_MISMATCH":"Junction box signature is incompatible with the latest Junction Box backup","BIG_JUNCTION_EDITING_DISALLOWED":"You\'re not allowed to edit this Junction Box","TURN_GUIDANCE_EDITING_DISALLOWED":"Junction Box has some turn guidance that you can not apply"},"confirm_overwrite_backup":{"title":"Override backup?","details":"You\'re about to override a Junction Box backup. This action is irreversible","backup_btn":"Yes","ignore_btn":"No"},"mistmatch_signature_snapshot_restored_alert":"Restored snapshot signature differs from Junction Box signature. Verify newly added turns before saving."}},"save":{"changes_log":{"actions":{"UpdateBigJunctionGeometryToRoundabout":"Roundabout geometry applied","UpdateBigJunction":"Update Junction Box","BulkSetTurn":"Updated %{count} turns"}}},"turn_tooltip":{"roundabout":{"title":"Roundabout"}}},"save":{"error_types":{"jbu101":{"title":"Junction Box backup hasn\'t been used","solution":"Restore the backup to avoid data loss"}}}}');function App(props){useInjectTranslations(props.translations??userscript_namespaceObject);const[isMasterDisabled]=usePreference("master_disable");return React.createElement(SelectedDataModelsContextProvider,null,React.createElement(Preferences,null),!isMasterDisabled&&React.createElement(React.Fragment,null,React.createElement(EditPanel,{templates:[RoundaboutExitInstructionNormalizationTemplate,RoundaboutPerimeterPolygonTemplate,BigJunctionPropsBackupTemplate]}),React.createElement(BackgroundActions,null)))}App.displayName="userscript(JunctionBoxUtils-SkY7950gTWTDjkJre4EWD)";const LEGACY_PREFS_LS_KEY="r0den.scripts.roundabout-jb.prefs";function migratePreferencesFromRoundaboutJB(){const legacyPrefs=localStorage.getItem(LEGACY_PREFS_LS_KEY);if(!legacyPrefs)return;const currentPrefs=function(legacyPrefs){return{roundabout:{clone_geometry:Boolean(legacyPrefs.auto_round_jb),instruction_normalization:{applied_instruction_badge_type:"icons"===legacyPrefs.normalize_badge_style?"graphical":"textual"}}}}(JSON.parse(legacyPrefs));localStorage.setItem("r0den.userscripts.jbu.prefs",JSON.stringify(currentPrefs)),localStorage.removeItem(LEGACY_PREFS_LS_KEY)}function bind_bind(fn,thisArg){return function(){return fn.apply(thisArg,arguments)}}const{toString:utils_toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(cache=Object.create(null),thing=>{const str=utils_toString.call(thing);return cache[str]||(cache[str]=str.slice(8,-1).toLowerCase())});var cache;const kindOfTest=type=>(type=type.toLowerCase(),thing=>kindOf(thing)===type),typeOfTest=type=>thing=>typeof thing===type,{isArray}=Array,isUndefined=typeOfTest("undefined");const isArrayBuffer=kindOfTest("ArrayBuffer");const isString=typeOfTest("string"),isFunction=typeOfTest("function"),utils_isNumber=typeOfTest("number"),utils_isObject=thing=>null!==thing&&"object"==typeof thing,isPlainObject=val=>{if("object"!==kindOf(val))return!1;const prototype=getPrototypeOf(val);return!(null!==prototype&&prototype!==Object.prototype&&null!==Object.getPrototypeOf(prototype)||Symbol.toStringTag in val||Symbol.iterator in val)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isURLSearchParams=kindOfTest("URLSearchParams");function forEach(obj,fn,{allOwnKeys=!1}={}){if(null==obj)return;let i,l;if("object"!=typeof obj&&(obj=[obj]),isArray(obj))for(i=0,l=obj.length;i<l;i++)fn.call(null,obj[i],i,obj);else{const keys=allOwnKeys?Object.getOwnPropertyNames(obj):Object.keys(obj),len=keys.length;let key;for(i=0;i<len;i++)key=keys[i],fn.call(null,obj[key],key,obj)}}function findKey(obj,key){key=key.toLowerCase();const keys=Object.keys(obj);let _key,i=keys.length;for(;i-- >0;)if(_key=keys[i],key===_key.toLowerCase())return _key;return null}const _global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,isContextDefined=context=>!isUndefined(context)&&context!==_global;const isTypedArray=(TypedArray="undefined"!=typeof Uint8Array&&getPrototypeOf(Uint8Array),thing=>TypedArray&&thing instanceof TypedArray);var TypedArray;const isHTMLForm=kindOfTest("HTMLFormElement"),utils_hasOwnProperty=(({hasOwnProperty})=>(obj,prop)=>hasOwnProperty.call(obj,prop))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(obj,reducer)=>{const descriptors=Object.getOwnPropertyDescriptors(obj),reducedDescriptors={};forEach(descriptors,((descriptor,name)=>{let ret;!1!==(ret=reducer(descriptor,name,obj))&&(reducedDescriptors[name]=ret||descriptor)})),Object.defineProperties(obj,reducedDescriptors)},ALPHA="abcdefghijklmnopqrstuvwxyz",ALPHABET={DIGIT:"0123456789",ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+"0123456789"};const isAsyncFn=kindOfTest("AsyncFunction"),utils={isArray,isArrayBuffer,isBuffer:function(val){return null!==val&&!isUndefined(val)&&null!==val.constructor&&!isUndefined(val.constructor)&&isFunction(val.constructor.isBuffer)&&val.constructor.isBuffer(val)},isFormData:thing=>{let kind;return thing&&("function"==typeof FormData&&thing instanceof FormData||isFunction(thing.append)&&("formdata"===(kind=kindOf(thing))||"object"===kind&&isFunction(thing.toString)&&"[object FormData]"===thing.toString()))},isArrayBufferView:function(val){let result;return result="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(val):val&&val.buffer&&isArrayBuffer(val.buffer),result},isString,isNumber:utils_isNumber,isBoolean:thing=>!0===thing||!1===thing,isObject:utils_isObject,isPlainObject,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream:val=>utils_isObject(val)&&isFunction(val.pipe),isURLSearchParams,isTypedArray,isFileList,forEach,merge:function merge(){const{caseless}=isContextDefined(this)&&this||{},result={},assignValue=(val,key)=>{const targetKey=caseless&&findKey(result,key)||key;isPlainObject(result[targetKey])&&isPlainObject(val)?result[targetKey]=merge(result[targetKey],val):isPlainObject(val)?result[targetKey]=merge({},val):isArray(val)?result[targetKey]=val.slice():result[targetKey]=val};for(let i=0,l=arguments.length;i<l;i++)arguments[i]&&forEach(arguments[i],assignValue);return result},extend:(a,b,thisArg,{allOwnKeys}={})=>(forEach(b,((val,key)=>{thisArg&&isFunction(val)?a[key]=bind_bind(val,thisArg):a[key]=val}),{allOwnKeys}),a),trim:str=>str.trim?str.trim():str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:content=>(65279===content.charCodeAt(0)&&(content=content.slice(1)),content),inherits:(constructor,superConstructor,props,descriptors)=>{constructor.prototype=Object.create(superConstructor.prototype,descriptors),constructor.prototype.constructor=constructor,Object.defineProperty(constructor,"super",{value:superConstructor.prototype}),props&&Object.assign(constructor.prototype,props)},toFlatObject:(sourceObj,destObj,filter,propFilter)=>{let props,i,prop;const merged={};if(destObj=destObj||{},null==sourceObj)return destObj;do{for(props=Object.getOwnPropertyNames(sourceObj),i=props.length;i-- >0;)prop=props[i],propFilter&&!propFilter(prop,sourceObj,destObj)||merged[prop]||(destObj[prop]=sourceObj[prop],merged[prop]=!0);sourceObj=!1!==filter&&getPrototypeOf(sourceObj)}while(sourceObj&&(!filter||filter(sourceObj,destObj))&&sourceObj!==Object.prototype);return destObj},kindOf,kindOfTest,endsWith:(str,searchString,position)=>{str=String(str),(void 0===position||position>str.length)&&(position=str.length),position-=searchString.length;const lastIndex=str.indexOf(searchString,position);return-1!==lastIndex&&lastIndex===position},toArray:thing=>{if(!thing)return null;if(isArray(thing))return thing;let i=thing.length;if(!utils_isNumber(i))return null;const arr=new Array(i);for(;i-- >0;)arr[i]=thing[i];return arr},forEachEntry:(obj,fn)=>{const iterator=(obj&&obj[Symbol.iterator]).call(obj);let result;for(;(result=iterator.next())&&!result.done;){const pair=result.value;fn.call(obj,pair[0],pair[1])}},matchAll:(regExp,str)=>{let matches;const arr=[];for(;null!==(matches=regExp.exec(str));)arr.push(matches);return arr},isHTMLForm,hasOwnProperty:utils_hasOwnProperty,hasOwnProp:utils_hasOwnProperty,reduceDescriptors,freezeMethods:obj=>{reduceDescriptors(obj,((descriptor,name)=>{if(isFunction(obj)&&-1!==["arguments","caller","callee"].indexOf(name))return!1;const value=obj[name];isFunction(value)&&(descriptor.enumerable=!1,"writable"in descriptor?descriptor.writable=!1:descriptor.set||(descriptor.set=()=>{throw Error("Can not rewrite read-only method '"+name+"'")}))}))},toObjectSet:(arrayOrString,delimiter)=>{const obj={},define=arr=>{arr.forEach((value=>{obj[value]=!0}))};return isArray(arrayOrString)?define(arrayOrString):define(String(arrayOrString).split(delimiter)),obj},toCamelCase:str=>str.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(m,p1,p2){return p1.toUpperCase()+p2})),noop:()=>{},toFiniteNumber:(value,defaultValue)=>(value=+value,Number.isFinite(value)?value:defaultValue),findKey,global:_global,isContextDefined,ALPHABET,generateString:(size=16,alphabet=ALPHABET.ALPHA_DIGIT)=>{let str="";const{length}=alphabet;for(;size--;)str+=alphabet[Math.random()*length|0];return str},isSpecCompliantForm:function(thing){return!!(thing&&isFunction(thing.append)&&"FormData"===thing[Symbol.toStringTag]&&thing[Symbol.iterator])},toJSONObject:obj=>{const stack=new Array(10),visit=(source,i)=>{if(utils_isObject(source)){if(stack.indexOf(source)>=0)return;if(!("toJSON"in source)){stack[i]=source;const target=isArray(source)?[]:{};return forEach(source,((value,key)=>{const reducedValue=visit(value,i+1);!isUndefined(reducedValue)&&(target[key]=reducedValue)})),stack[i]=void 0,target}}return source};return visit(obj,0)},isAsyncFn,isThenable:thing=>thing&&(utils_isObject(thing)||isFunction(thing))&&isFunction(thing.then)&&isFunction(thing.catch)};function AxiosError(message,code,config,request,response){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=message,this.name="AxiosError",code&&(this.code=code),config&&(this.config=config),request&&(this.request=request),response&&(this.response=response)}utils.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const AxiosError_prototype=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((code=>{descriptors[code]={value:code}})),Object.defineProperties(AxiosError,descriptors),Object.defineProperty(AxiosError_prototype,"isAxiosError",{value:!0}),AxiosError.from=(error,code,config,request,response,customProps)=>{const axiosError=Object.create(AxiosError_prototype);return utils.toFlatObject(error,axiosError,(function(obj){return obj!==Error.prototype}),(prop=>"isAxiosError"!==prop)),AxiosError.call(axiosError,error.message,code,config,request,response),axiosError.cause=error,axiosError.name=error.name,customProps&&Object.assign(axiosError,customProps),axiosError};const core_AxiosError=AxiosError;function isVisitable(thing){return utils.isPlainObject(thing)||utils.isArray(thing)}function removeBrackets(key){return utils.endsWith(key,"[]")?key.slice(0,-2):key}function renderKey(path,key,dots){return path?path.concat(key).map((function(token,i){return token=removeBrackets(token),!dots&&i?"["+token+"]":token})).join(dots?".":""):key}const predicates=utils.toFlatObject(utils,{},null,(function(prop){return/^is[A-Z]/.test(prop)}));const helpers_toFormData=function(obj,formData,options){if(!utils.isObject(obj))throw new TypeError("target must be an object");formData=formData||new FormData;const metaTokens=(options=utils.toFlatObject(options,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(option,source){return!utils.isUndefined(source[option])}))).metaTokens,visitor=options.visitor||defaultVisitor,dots=options.dots,indexes=options.indexes,useBlob=(options.Blob||"undefined"!=typeof Blob&&Blob)&&utils.isSpecCompliantForm(formData);if(!utils.isFunction(visitor))throw new TypeError("visitor must be a function");function convertValue(value){if(null===value)return"";if(utils.isDate(value))return value.toISOString();if(!useBlob&&utils.isBlob(value))throw new core_AxiosError("Blob is not supported. Use a Buffer instead.");return utils.isArrayBuffer(value)||utils.isTypedArray(value)?useBlob&&"function"==typeof Blob?new Blob([value]):Buffer.from(value):value}function defaultVisitor(value,key,path){let arr=value;if(value&&!path&&"object"==typeof value)if(utils.endsWith(key,"{}"))key=metaTokens?key:key.slice(0,-2),value=JSON.stringify(value);else if(utils.isArray(value)&&function(arr){return utils.isArray(arr)&&!arr.some(isVisitable)}(value)||(utils.isFileList(value)||utils.endsWith(key,"[]"))&&(arr=utils.toArray(value)))return key=removeBrackets(key),arr.forEach((function(el,index){!utils.isUndefined(el)&&null!==el&&formData.append(!0===indexes?renderKey([key],index,dots):null===indexes?key:key+"[]",convertValue(el))})),!1;return!!isVisitable(value)||(formData.append(renderKey(path,key,dots),convertValue(value)),!1)}const stack=[],exposedHelpers=Object.assign(predicates,{defaultVisitor,convertValue,isVisitable});if(!utils.isObject(obj))throw new TypeError("data must be an object");return function build(value,path){if(!utils.isUndefined(value)){if(-1!==stack.indexOf(value))throw Error("Circular reference detected in "+path.join("."));stack.push(value),utils.forEach(value,(function(el,key){!0===(!(utils.isUndefined(el)||null===el)&&visitor.call(formData,el,utils.isString(key)?key.trim():key,path,exposedHelpers))&&build(el,path?path.concat(key):[key])})),stack.pop()}}(obj),formData};function encode(str){const charMap={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(str).replace(/[!'()~]|%20|%00/g,(function(match){return charMap[match]}))}function AxiosURLSearchParams(params,options){this._pairs=[],params&&helpers_toFormData(params,this,options)}const AxiosURLSearchParams_prototype=AxiosURLSearchParams.prototype;AxiosURLSearchParams_prototype.append=function(name,value){this._pairs.push([name,value])},AxiosURLSearchParams_prototype.toString=function(encoder){const _encode=encoder?function(value){return encoder.call(this,value,encode)}:encode;return this._pairs.map((function(pair){return _encode(pair[0])+"="+_encode(pair[1])}),"").join("&")};const helpers_AxiosURLSearchParams=AxiosURLSearchParams;function buildURL_encode(val){return encodeURIComponent(val).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(url,params,options){if(!params)return url;const _encode=options&&options.encode||buildURL_encode,serializeFn=options&&options.serialize;let serializedParams;if(serializedParams=serializeFn?serializeFn(params,options):utils.isURLSearchParams(params)?params.toString():new helpers_AxiosURLSearchParams(params,options).toString(_encode),serializedParams){const hashmarkIndex=url.indexOf("#");-1!==hashmarkIndex&&(url=url.slice(0,hashmarkIndex)),url+=(-1===url.indexOf("?")?"?":"&")+serializedParams}return url}const core_InterceptorManager=class{constructor(){this.handlers=[]}use(fulfilled,rejected,options){return this.handlers.push({fulfilled,rejected,synchronous:!!options&&options.synchronous,runWhen:options?options.runWhen:null}),this.handlers.length-1}eject(id){this.handlers[id]&&(this.handlers[id]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(fn){utils.forEach(this.handlers,(function(h){null!==h&&fn(h)}))}},defaults_transitional={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},browser={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:helpers_AxiosURLSearchParams,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv="undefined"!=typeof window&&"undefined"!=typeof document,hasStandardBrowserEnv=(product="undefined"!=typeof navigator&&navigator.product,hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(product)<0);var product;const hasStandardBrowserWebWorkerEnv="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,platform={...common_utils_namespaceObject,...browser};const helpers_formDataToJSON=function(formData){function buildPath(path,value,target,index){let name=path[index++];if("__proto__"===name)return!0;const isNumericKey=Number.isFinite(+name),isLast=index>=path.length;if(name=!name&&utils.isArray(target)?target.length:name,isLast)return utils.hasOwnProp(target,name)?target[name]=[target[name],value]:target[name]=value,!isNumericKey;target[name]&&utils.isObject(target[name])||(target[name]=[]);return buildPath(path,value,target[name],index)&&utils.isArray(target[name])&&(target[name]=function(arr){const obj={},keys=Object.keys(arr);let i;const len=keys.length;let key;for(i=0;i<len;i++)key=keys[i],obj[key]=arr[key];return obj}(target[name])),!isNumericKey}if(utils.isFormData(formData)&&utils.isFunction(formData.entries)){const obj={};return utils.forEachEntry(formData,((name,value)=>{buildPath(function(name){return utils.matchAll(/\w+|\[(\w*)]/g,name).map((match=>"[]"===match[0]?"":match[1]||match[0]))}(name),value,obj,0)})),obj}return null};const defaults={transitional:defaults_transitional,adapter:["xhr","http"],transformRequest:[function(data,headers){const contentType=headers.getContentType()||"",hasJSONContentType=contentType.indexOf("application/json")>-1,isObjectPayload=utils.isObject(data);isObjectPayload&&utils.isHTMLForm(data)&&(data=new FormData(data));if(utils.isFormData(data))return hasJSONContentType?JSON.stringify(helpers_formDataToJSON(data)):data;if(utils.isArrayBuffer(data)||utils.isBuffer(data)||utils.isStream(data)||utils.isFile(data)||utils.isBlob(data))return data;if(utils.isArrayBufferView(data))return data.buffer;if(utils.isURLSearchParams(data))return headers.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),data.toString();let isFileList;if(isObjectPayload){if(contentType.indexOf("application/x-www-form-urlencoded")>-1)return function(data,options){return helpers_toFormData(data,new platform.classes.URLSearchParams,Object.assign({visitor:function(value,key,path,helpers){return platform.isNode&&utils.isBuffer(value)?(this.append(key,value.toString("base64")),!1):helpers.defaultVisitor.apply(this,arguments)}},options))}(data,this.formSerializer).toString();if((isFileList=utils.isFileList(data))||contentType.indexOf("multipart/form-data")>-1){const _FormData=this.env&&this.env.FormData;return helpers_toFormData(isFileList?{"files[]":data}:data,_FormData&&new _FormData,this.formSerializer)}}return isObjectPayload||hasJSONContentType?(headers.setContentType("application/json",!1),function(rawValue,parser,encoder){if(utils.isString(rawValue))try{return(parser||JSON.parse)(rawValue),utils.trim(rawValue)}catch(e){if("SyntaxError"!==e.name)throw e}return(encoder||JSON.stringify)(rawValue)}(data)):data}],transformResponse:[function(data){const transitional=this.transitional||defaults.transitional,forcedJSONParsing=transitional&&transitional.forcedJSONParsing,JSONRequested="json"===this.responseType;if(data&&utils.isString(data)&&(forcedJSONParsing&&!this.responseType||JSONRequested)){const strictJSONParsing=!(transitional&&transitional.silentJSONParsing)&&JSONRequested;try{return JSON.parse(data)}catch(e){if(strictJSONParsing){if("SyntaxError"===e.name)throw core_AxiosError.from(e,core_AxiosError.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return data}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(status){return status>=200&&status<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils.forEach(["delete","get","head","post","put","patch"],(method=>{defaults.headers[method]={}}));const lib_defaults=defaults,ignoreDuplicateOf=utils.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),$internals=Symbol("internals");function normalizeHeader(header){return header&&String(header).trim().toLowerCase()}function normalizeValue(value){return!1===value||null==value?value:utils.isArray(value)?value.map(normalizeValue):String(value)}function matchHeaderValue(context,value,header,filter,isHeaderNameFilter){return utils.isFunction(filter)?filter.call(this,value,header):(isHeaderNameFilter&&(value=header),utils.isString(value)?utils.isString(filter)?-1!==value.indexOf(filter):utils.isRegExp(filter)?filter.test(value):void 0:void 0)}class AxiosHeaders{constructor(headers){headers&&this.set(headers)}set(header,valueOrRewrite,rewrite){const self=this;function setHeader(_value,_header,_rewrite){const lHeader=normalizeHeader(_header);if(!lHeader)throw new Error("header name must be a non-empty string");const key=utils.findKey(self,lHeader);(!key||void 0===self[key]||!0===_rewrite||void 0===_rewrite&&!1!==self[key])&&(self[key||_header]=normalizeValue(_value))}const setHeaders=(headers,_rewrite)=>utils.forEach(headers,((_value,_header)=>setHeader(_value,_header,_rewrite)));return utils.isPlainObject(header)||header instanceof this.constructor?setHeaders(header,valueOrRewrite):utils.isString(header)&&(header=header.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(header.trim())?setHeaders((rawHeaders=>{const parsed={};let key,val,i;return rawHeaders&&rawHeaders.split("\n").forEach((function(line){i=line.indexOf(":"),key=line.substring(0,i).trim().toLowerCase(),val=line.substring(i+1).trim(),!key||parsed[key]&&ignoreDuplicateOf[key]||("set-cookie"===key?parsed[key]?parsed[key].push(val):parsed[key]=[val]:parsed[key]=parsed[key]?parsed[key]+", "+val:val)})),parsed})(header),valueOrRewrite):null!=header&&setHeader(valueOrRewrite,header,rewrite),this}get(header,parser){if(header=normalizeHeader(header)){const key=utils.findKey(this,header);if(key){const value=this[key];if(!parser)return value;if(!0===parser)return function(str){const tokens=Object.create(null),tokensRE=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let match;for(;match=tokensRE.exec(str);)tokens[match[1]]=match[2];return tokens}(value);if(utils.isFunction(parser))return parser.call(this,value,key);if(utils.isRegExp(parser))return parser.exec(value);throw new TypeError("parser must be boolean|regexp|function")}}}has(header,matcher){if(header=normalizeHeader(header)){const key=utils.findKey(this,header);return!(!key||void 0===this[key]||matcher&&!matchHeaderValue(0,this[key],key,matcher))}return!1}delete(header,matcher){const self=this;let deleted=!1;function deleteHeader(_header){if(_header=normalizeHeader(_header)){const key=utils.findKey(self,_header);!key||matcher&&!matchHeaderValue(0,self[key],key,matcher)||(delete self[key],deleted=!0)}}return utils.isArray(header)?header.forEach(deleteHeader):deleteHeader(header),deleted}clear(matcher){const keys=Object.keys(this);let i=keys.length,deleted=!1;for(;i--;){const key=keys[i];matcher&&!matchHeaderValue(0,this[key],key,matcher,!0)||(delete this[key],deleted=!0)}return deleted}normalize(format){const self=this,headers={};return utils.forEach(this,((value,header)=>{const key=utils.findKey(headers,header);if(key)return self[key]=normalizeValue(value),void delete self[header];const normalized=format?function(header){return header.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((w,char,str)=>char.toUpperCase()+str))}(header):String(header).trim();normalized!==header&&delete self[header],self[normalized]=normalizeValue(value),headers[normalized]=!0})),this}concat(...targets){return this.constructor.concat(this,...targets)}toJSON(asStrings){const obj=Object.create(null);return utils.forEach(this,((value,header)=>{null!=value&&!1!==value&&(obj[header]=asStrings&&utils.isArray(value)?value.join(", "):value)})),obj}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([header,value])=>header+": "+value)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(thing){return thing instanceof this?thing:new this(thing)}static concat(first,...targets){const computed=new this(first);return targets.forEach((target=>computed.set(target))),computed}static accessor(header){const accessors=(this[$internals]=this[$internals]={accessors:{}}).accessors,prototype=this.prototype;function defineAccessor(_header){const lHeader=normalizeHeader(_header);accessors[lHeader]||(!function(obj,header){const accessorName=utils.toCamelCase(" "+header);["get","set","has"].forEach((methodName=>{Object.defineProperty(obj,methodName+accessorName,{value:function(arg1,arg2,arg3){return this[methodName].call(this,header,arg1,arg2,arg3)},configurable:!0})}))}(prototype,_header),accessors[lHeader]=!0)}return utils.isArray(header)?header.forEach(defineAccessor):defineAccessor(header),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),utils.reduceDescriptors(AxiosHeaders.prototype,(({value},key)=>{let mapped=key[0].toUpperCase()+key.slice(1);return{get:()=>value,set(headerValue){this[mapped]=headerValue}}})),utils.freezeMethods(AxiosHeaders);const core_AxiosHeaders=AxiosHeaders;function transformData(fns,response){const config=this||lib_defaults,context=response||config,headers=core_AxiosHeaders.from(context.headers);let data=context.data;return utils.forEach(fns,(function(fn){data=fn.call(config,data,headers.normalize(),response?response.status:void 0)})),headers.normalize(),data}function isCancel(value){return!(!value||!value.__CANCEL__)}function CanceledError(message,config,request){core_AxiosError.call(this,null==message?"canceled":message,core_AxiosError.ERR_CANCELED,config,request),this.name="CanceledError"}utils.inherits(CanceledError,core_AxiosError,{__CANCEL__:!0});const cancel_CanceledError=CanceledError;const cookies=platform.hasStandardBrowserEnv?{write(name,value,expires,path,domain,secure){const cookie=[name+"="+encodeURIComponent(value)];utils.isNumber(expires)&&cookie.push("expires="+new Date(expires).toGMTString()),utils.isString(path)&&cookie.push("path="+path),utils.isString(domain)&&cookie.push("domain="+domain),!0===secure&&cookie.push("secure"),document.cookie=cookie.join("; ")},read(name){const match=document.cookie.match(new RegExp("(^|;\\s*)("+name+")=([^;]*)"));return match?decodeURIComponent(match[3]):null},remove(name){this.write(name,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function buildFullPath(baseURL,requestedURL){return baseURL&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(requestedURL)?function(baseURL,relativeURL){return relativeURL?baseURL.replace(/\/?\/$/,"")+"/"+relativeURL.replace(/^\/+/,""):baseURL}(baseURL,requestedURL):requestedURL}const isURLSameOrigin=platform.hasStandardBrowserEnv?function(){const msie=/(msie|trident)/i.test(navigator.userAgent),urlParsingNode=document.createElement("a");let originURL;function resolveURL(url){let href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}return originURL=resolveURL(window.location.href),function(requestURL){const parsed=utils.isString(requestURL)?resolveURL(requestURL):requestURL;return parsed.protocol===originURL.protocol&&parsed.host===originURL.host}}():function(){return!0};const helpers_speedometer=function(samplesCount,min){samplesCount=samplesCount||10;const bytes=new Array(samplesCount),timestamps=new Array(samplesCount);let firstSampleTS,head=0,tail=0;return min=void 0!==min?min:1e3,function(chunkLength){const now=Date.now(),startedAt=timestamps[tail];firstSampleTS||(firstSampleTS=now),bytes[head]=chunkLength,timestamps[head]=now;let i=tail,bytesCount=0;for(;i!==head;)bytesCount+=bytes[i++],i%=samplesCount;if(head=(head+1)%samplesCount,head===tail&&(tail=(tail+1)%samplesCount),now-firstSampleTS<min)return;const passed=startedAt&&now-startedAt;return passed?Math.round(1e3*bytesCount/passed):void 0}};function progressEventReducer(listener,isDownloadStream){let bytesNotified=0;const _speedometer=helpers_speedometer(50,250);return e=>{const loaded=e.loaded,total=e.lengthComputable?e.total:void 0,progressBytes=loaded-bytesNotified,rate=_speedometer(progressBytes);bytesNotified=loaded;const data={loaded,total,progress:total?loaded/total:void 0,bytes:progressBytes,rate:rate||void 0,estimated:rate&&total&&loaded<=total?(total-loaded)/rate:void 0,event:e};data[isDownloadStream?"download":"upload"]=!0,listener(data)}}const xhr="undefined"!=typeof XMLHttpRequest&&function(config){return new Promise((function(resolve,reject){let requestData=config.data;const requestHeaders=core_AxiosHeaders.from(config.headers).normalize();let onCanceled,contentType,{responseType,withXSRFToken}=config;function done(){config.cancelToken&&config.cancelToken.unsubscribe(onCanceled),config.signal&&config.signal.removeEventListener("abort",onCanceled)}if(utils.isFormData(requestData))if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)requestHeaders.setContentType(!1);else if(!1!==(contentType=requestHeaders.getContentType())){const[type,...tokens]=contentType?contentType.split(";").map((token=>token.trim())).filter(Boolean):[];requestHeaders.setContentType([type||"multipart/form-data",...tokens].join("; "))}let request=new XMLHttpRequest;if(config.auth){const username=config.auth.username||"",password=config.auth.password?unescape(encodeURIComponent(config.auth.password)):"";requestHeaders.set("Authorization","Basic "+btoa(username+":"+password))}const fullPath=buildFullPath(config.baseURL,config.url);function onloadend(){if(!request)return;const responseHeaders=core_AxiosHeaders.from("getAllResponseHeaders"in request&&request.getAllResponseHeaders());!function(resolve,reject,response){const validateStatus=response.config.validateStatus;response.status&&validateStatus&&!validateStatus(response.status)?reject(new core_AxiosError("Request failed with status code "+response.status,[core_AxiosError.ERR_BAD_REQUEST,core_AxiosError.ERR_BAD_RESPONSE][Math.floor(response.status/100)-4],response.config,response.request,response)):resolve(response)}((function(value){resolve(value),done()}),(function(err){reject(err),done()}),{data:responseType&&"text"!==responseType&&"json"!==responseType?request.response:request.responseText,status:request.status,statusText:request.statusText,headers:responseHeaders,config,request}),request=null}if(request.open(config.method.toUpperCase(),buildURL(fullPath,config.params,config.paramsSerializer),!0),request.timeout=config.timeout,"onloadend"in request?request.onloadend=onloadend:request.onreadystatechange=function(){request&&4===request.readyState&&(0!==request.status||request.responseURL&&0===request.responseURL.indexOf("file:"))&&setTimeout(onloadend)},request.onabort=function(){request&&(reject(new core_AxiosError("Request aborted",core_AxiosError.ECONNABORTED,config,request)),request=null)},request.onerror=function(){reject(new core_AxiosError("Network Error",core_AxiosError.ERR_NETWORK,config,request)),request=null},request.ontimeout=function(){let timeoutErrorMessage=config.timeout?"timeout of "+config.timeout+"ms exceeded":"timeout exceeded";const transitional=config.transitional||defaults_transitional;config.timeoutErrorMessage&&(timeoutErrorMessage=config.timeoutErrorMessage),reject(new core_AxiosError(timeoutErrorMessage,transitional.clarifyTimeoutError?core_AxiosError.ETIMEDOUT:core_AxiosError.ECONNABORTED,config,request)),request=null},platform.hasStandardBrowserEnv&&(withXSRFToken&&utils.isFunction(withXSRFToken)&&(withXSRFToken=withXSRFToken(config)),withXSRFToken||!1!==withXSRFToken&&isURLSameOrigin(fullPath))){const xsrfValue=config.xsrfHeaderName&&config.xsrfCookieName&&cookies.read(config.xsrfCookieName);xsrfValue&&requestHeaders.set(config.xsrfHeaderName,xsrfValue)}void 0===requestData&&requestHeaders.setContentType(null),"setRequestHeader"in request&&utils.forEach(requestHeaders.toJSON(),(function(val,key){request.setRequestHeader(key,val)})),utils.isUndefined(config.withCredentials)||(request.withCredentials=!!config.withCredentials),responseType&&"json"!==responseType&&(request.responseType=config.responseType),"function"==typeof config.onDownloadProgress&&request.addEventListener("progress",progressEventReducer(config.onDownloadProgress,!0)),"function"==typeof config.onUploadProgress&&request.upload&&request.upload.addEventListener("progress",progressEventReducer(config.onUploadProgress)),(config.cancelToken||config.signal)&&(onCanceled=cancel=>{request&&(reject(!cancel||cancel.type?new cancel_CanceledError(null,config,request):cancel),request.abort(),request=null)},config.cancelToken&&config.cancelToken.subscribe(onCanceled),config.signal&&(config.signal.aborted?onCanceled():config.signal.addEventListener("abort",onCanceled)));const protocol=function(url){const match=/^([-+\w]{1,25})(:?\/\/|:)/.exec(url);return match&&match[1]||""}(fullPath);protocol&&-1===platform.protocols.indexOf(protocol)?reject(new core_AxiosError("Unsupported protocol "+protocol+":",core_AxiosError.ERR_BAD_REQUEST,config)):request.send(requestData||null)}))},knownAdapters={http:null,xhr};utils.forEach(knownAdapters,((fn,value)=>{if(fn){try{Object.defineProperty(fn,"name",{value})}catch(e){}Object.defineProperty(fn,"adapterName",{value})}}));const renderReason=reason=>`- ${reason}`,isResolvedHandle=adapter=>utils.isFunction(adapter)||null===adapter||!1===adapter,adapters_getAdapter=adapters=>{adapters=utils.isArray(adapters)?adapters:[adapters];const{length}=adapters;let nameOrAdapter,adapter;const rejectedReasons={};for(let i=0;i<length;i++){let id;if(nameOrAdapter=adapters[i],adapter=nameOrAdapter,!isResolvedHandle(nameOrAdapter)&&(adapter=knownAdapters[(id=String(nameOrAdapter)).toLowerCase()],void 0===adapter))throw new core_AxiosError(`Unknown adapter '${id}'`);if(adapter)break;rejectedReasons[id||"#"+i]=adapter}if(!adapter){const reasons=Object.entries(rejectedReasons).map((([id,state])=>`adapter ${id} `+(!1===state?"is not supported by the environment":"is not available in the build")));let s=length?reasons.length>1?"since :\n"+reasons.map(renderReason).join("\n"):" "+renderReason(reasons[0]):"as no adapter specified";throw new core_AxiosError("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return adapter};function throwIfCancellationRequested(config){if(config.cancelToken&&config.cancelToken.throwIfRequested(),config.signal&&config.signal.aborted)throw new cancel_CanceledError(null,config)}function dispatchRequest(config){throwIfCancellationRequested(config),config.headers=core_AxiosHeaders.from(config.headers),config.data=transformData.call(config,config.transformRequest),-1!==["post","put","patch"].indexOf(config.method)&&config.headers.setContentType("application/x-www-form-urlencoded",!1);return adapters_getAdapter(config.adapter||lib_defaults.adapter)(config).then((function(response){return throwIfCancellationRequested(config),response.data=transformData.call(config,config.transformResponse,response),response.headers=core_AxiosHeaders.from(response.headers),response}),(function(reason){return isCancel(reason)||(throwIfCancellationRequested(config),reason&&reason.response&&(reason.response.data=transformData.call(config,config.transformResponse,reason.response),reason.response.headers=core_AxiosHeaders.from(reason.response.headers))),Promise.reject(reason)}))}const headersToObject=thing=>thing instanceof core_AxiosHeaders?{...thing}:thing;function mergeConfig(config1,config2){config2=config2||{};const config={};function getMergedValue(target,source,caseless){return utils.isPlainObject(target)&&utils.isPlainObject(source)?utils.merge.call({caseless},target,source):utils.isPlainObject(source)?utils.merge({},source):utils.isArray(source)?source.slice():source}function mergeDeepProperties(a,b,caseless){return utils.isUndefined(b)?utils.isUndefined(a)?void 0:getMergedValue(void 0,a,caseless):getMergedValue(a,b,caseless)}function valueFromConfig2(a,b){if(!utils.isUndefined(b))return getMergedValue(void 0,b)}function defaultToConfig2(a,b){return utils.isUndefined(b)?utils.isUndefined(a)?void 0:getMergedValue(void 0,a):getMergedValue(void 0,b)}function mergeDirectKeys(a,b,prop){return prop in config2?getMergedValue(a,b):prop in config1?getMergedValue(void 0,a):void 0}const mergeMap={url:valueFromConfig2,method:valueFromConfig2,data:valueFromConfig2,baseURL:defaultToConfig2,transformRequest:defaultToConfig2,transformResponse:defaultToConfig2,paramsSerializer:defaultToConfig2,timeout:defaultToConfig2,timeoutMessage:defaultToConfig2,withCredentials:defaultToConfig2,withXSRFToken:defaultToConfig2,adapter:defaultToConfig2,responseType:defaultToConfig2,xsrfCookieName:defaultToConfig2,xsrfHeaderName:defaultToConfig2,onUploadProgress:defaultToConfig2,onDownloadProgress:defaultToConfig2,decompress:defaultToConfig2,maxContentLength:defaultToConfig2,maxBodyLength:defaultToConfig2,beforeRedirect:defaultToConfig2,transport:defaultToConfig2,httpAgent:defaultToConfig2,httpsAgent:defaultToConfig2,cancelToken:defaultToConfig2,socketPath:defaultToConfig2,responseEncoding:defaultToConfig2,validateStatus:mergeDirectKeys,headers:(a,b)=>mergeDeepProperties(headersToObject(a),headersToObject(b),!0)};return utils.forEach(Object.keys(Object.assign({},config1,config2)),(function(prop){const merge=mergeMap[prop]||mergeDeepProperties,configValue=merge(config1[prop],config2[prop],prop);utils.isUndefined(configValue)&&merge!==mergeDirectKeys||(config[prop]=configValue)})),config}const validators={};["object","boolean","number","function","string","symbol"].forEach(((type,i)=>{validators[type]=function(thing){return typeof thing===type||"a"+(i<1?"n ":" ")+type}}));const deprecatedWarnings={};validators.transitional=function(validator,version,message){function formatMessage(opt,desc){return"[Axios v1.6.8] Transitional option '"+opt+"'"+desc+(message?". "+message:"")}return(value,opt,opts)=>{if(!1===validator)throw new core_AxiosError(formatMessage(opt," has been removed"+(version?" in "+version:"")),core_AxiosError.ERR_DEPRECATED);return version&&!deprecatedWarnings[opt]&&(deprecatedWarnings[opt]=!0,console.warn(formatMessage(opt," has been deprecated since v"+version+" and will be removed in the near future"))),!validator||validator(value,opt,opts)}};const validator={assertOptions:function(options,schema,allowUnknown){if("object"!=typeof options)throw new core_AxiosError("options must be an object",core_AxiosError.ERR_BAD_OPTION_VALUE);const keys=Object.keys(options);let i=keys.length;for(;i-- >0;){const opt=keys[i],validator=schema[opt];if(validator){const value=options[opt],result=void 0===value||validator(value,opt,options);if(!0!==result)throw new core_AxiosError("option "+opt+" must be "+result,core_AxiosError.ERR_BAD_OPTION_VALUE)}else if(!0!==allowUnknown)throw new core_AxiosError("Unknown option "+opt,core_AxiosError.ERR_BAD_OPTION)}},validators},Axios_validators=validator.validators;class Axios{constructor(instanceConfig){this.defaults=instanceConfig,this.interceptors={request:new core_InterceptorManager,response:new core_InterceptorManager}}async request(configOrUrl,config){try{return await this._request(configOrUrl,config)}catch(err){if(err instanceof Error){let dummy;Error.captureStackTrace?Error.captureStackTrace(dummy={}):dummy=new Error;const stack=dummy.stack?dummy.stack.replace(/^.+\n/,""):"";err.stack?stack&&!String(err.stack).endsWith(stack.replace(/^.+\n.+\n/,""))&&(err.stack+="\n"+stack):err.stack=stack}throw err}}_request(configOrUrl,config){"string"==typeof configOrUrl?(config=config||{}).url=configOrUrl:config=configOrUrl||{},config=mergeConfig(this.defaults,config);const{transitional,paramsSerializer,headers}=config;void 0!==transitional&&validator.assertOptions(transitional,{silentJSONParsing:Axios_validators.transitional(Axios_validators.boolean),forcedJSONParsing:Axios_validators.transitional(Axios_validators.boolean),clarifyTimeoutError:Axios_validators.transitional(Axios_validators.boolean)},!1),null!=paramsSerializer&&(utils.isFunction(paramsSerializer)?config.paramsSerializer={serialize:paramsSerializer}:validator.assertOptions(paramsSerializer,{encode:Axios_validators.function,serialize:Axios_validators.function},!0)),config.method=(config.method||this.defaults.method||"get").toLowerCase();let contextHeaders=headers&&utils.merge(headers.common,headers[config.method]);headers&&utils.forEach(["delete","get","head","post","put","patch","common"],(method=>{delete headers[method]})),config.headers=core_AxiosHeaders.concat(contextHeaders,headers);const requestInterceptorChain=[];let synchronousRequestInterceptors=!0;this.interceptors.request.forEach((function(interceptor){"function"==typeof interceptor.runWhen&&!1===interceptor.runWhen(config)||(synchronousRequestInterceptors=synchronousRequestInterceptors&&interceptor.synchronous,requestInterceptorChain.unshift(interceptor.fulfilled,interceptor.rejected))}));const responseInterceptorChain=[];let promise;this.interceptors.response.forEach((function(interceptor){responseInterceptorChain.push(interceptor.fulfilled,interceptor.rejected)}));let len,i=0;if(!synchronousRequestInterceptors){const chain=[dispatchRequest.bind(this),void 0];for(chain.unshift.apply(chain,requestInterceptorChain),chain.push.apply(chain,responseInterceptorChain),len=chain.length,promise=Promise.resolve(config);i<len;)promise=promise.then(chain[i++],chain[i++]);return promise}len=requestInterceptorChain.length;let newConfig=config;for(i=0;i<len;){const onFulfilled=requestInterceptorChain[i++],onRejected=requestInterceptorChain[i++];try{newConfig=onFulfilled(newConfig)}catch(error){onRejected.call(this,error);break}}try{promise=dispatchRequest.call(this,newConfig)}catch(error){return Promise.reject(error)}for(i=0,len=responseInterceptorChain.length;i<len;)promise=promise.then(responseInterceptorChain[i++],responseInterceptorChain[i++]);return promise}getUri(config){return buildURL(buildFullPath((config=mergeConfig(this.defaults,config)).baseURL,config.url),config.params,config.paramsSerializer)}}utils.forEach(["delete","get","head","options"],(function(method){Axios.prototype[method]=function(url,config){return this.request(mergeConfig(config||{},{method,url,data:(config||{}).data}))}})),utils.forEach(["post","put","patch"],(function(method){function generateHTTPMethod(isForm){return function(url,data,config){return this.request(mergeConfig(config||{},{method,headers:isForm?{"Content-Type":"multipart/form-data"}:{},url,data}))}}Axios.prototype[method]=generateHTTPMethod(),Axios.prototype[method+"Form"]=generateHTTPMethod(!0)}));const core_Axios=Axios;class CancelToken{constructor(executor){if("function"!=typeof executor)throw new TypeError("executor must be a function.");let resolvePromise;this.promise=new Promise((function(resolve){resolvePromise=resolve}));const token=this;this.promise.then((cancel=>{if(!token._listeners)return;let i=token._listeners.length;for(;i-- >0;)token._listeners[i](cancel);token._listeners=null})),this.promise.then=onfulfilled=>{let _resolve;const promise=new Promise((resolve=>{token.subscribe(resolve),_resolve=resolve})).then(onfulfilled);return promise.cancel=function(){token.unsubscribe(_resolve)},promise},executor((function(message,config,request){token.reason||(token.reason=new cancel_CanceledError(message,config,request),resolvePromise(token.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(listener){this.reason?listener(this.reason):this._listeners?this._listeners.push(listener):this._listeners=[listener]}unsubscribe(listener){if(!this._listeners)return;const index=this._listeners.indexOf(listener);-1!==index&&this._listeners.splice(index,1)}static source(){let cancel;return{token:new CancelToken((function(c){cancel=c})),cancel}}}const cancel_CancelToken=CancelToken;const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach((([key,value])=>{HttpStatusCode[value]=key}));const helpers_HttpStatusCode=HttpStatusCode;const axios=function createInstance(defaultConfig){const context=new core_Axios(defaultConfig),instance=bind_bind(core_Axios.prototype.request,context);return utils.extend(instance,core_Axios.prototype,context,{allOwnKeys:!0}),utils.extend(instance,context,null,{allOwnKeys:!0}),instance.create=function(instanceConfig){return createInstance(mergeConfig(defaultConfig,instanceConfig))},instance}(lib_defaults);axios.Axios=core_Axios,axios.CanceledError=cancel_CanceledError,axios.CancelToken=cancel_CancelToken,axios.isCancel=isCancel,axios.VERSION="1.6.8",axios.toFormData=helpers_toFormData,axios.AxiosError=core_AxiosError,axios.Cancel=axios.CanceledError,axios.all=function(promises){return Promise.all(promises)},axios.spread=function(callback){return function(arr){return callback.apply(null,arr)}},axios.isAxiosError=function(payload){return utils.isObject(payload)&&!0===payload.isAxiosError},axios.mergeConfig=mergeConfig,axios.AxiosHeaders=core_AxiosHeaders,axios.formToJSON=thing=>helpers_formDataToJSON(utils.isHTMLForm(thing)?new FormData(thing):thing),axios.getAdapter=adapters_getAdapter,axios.HttpStatusCode=helpers_HttpStatusCode,axios.default=axios;const lib_axios=axios;function gmxhr(){this.type=null,this.url=null,this.async=null,this.username=null,this.password=null,this.status=null,this.headers={},this.readyState=null}gmxhr.prototype.abort=function(){this.readyState=0},gmxhr.prototype.getAllResponseHeaders=function(){return 4!=this.readyState?"":this.responseHeaders},gmxhr.prototype.getResponseHeader=function(header){var value=null;if(this.responseHeaders){for(var regex=new RegExp("^"+header+": (.*)$","igm"),match=regex.exec(this.responseHeaders),result=[];null!=match;)result.push(match[1]),match=regex.exec(this.responseHeaders);result.length>0&&(value=result.join(", "))}return value},gmxhr.prototype.open=function(type,url,async,username,password){this.type=type||null,this.url=url||null,this.async=async||null,this.username=username||null,this.password=password||null,this.readyState=1},gmxhr.prototype.setRequestHeader=function(name,value){this.headers[name]=value},gmxhr.prototype.send=function(data){this.data=data;var that=this;("undefined"==typeof GM_xmlhttpRequest?GM.xmlHttpRequest:GM_xmlhttpRequest)({method:this.type,url:this.url,headers:this.headers,data:this.data,onload:function(rsp){var responseKeys=["readyState","responseHeaders","finalUrl","status","statusText","response","responseText"];for(var k in responseKeys)responseKeys[k]in rsp&&(that[responseKeys[k]]=rsp[responseKeys[k]]);that.onreadystatechange()},onerror:function(rsp){var responseKeys=["readyState","responseHeaders","finalUrl","status","statusText","response","responseText"];for(var k in responseKeys)responseKeys[k]in rsp&&(that[responseKeys[k]]=rsp[responseKeys[k]]);that.onreadystatechange()}})};const tampermonkey_gmxhr=gmxhr;var axios_gmxhr_adapter_utils_toString=Object.prototype.toString;function utils_isArray(val){return"[object Array]"===axios_gmxhr_adapter_utils_toString.call(val)}function utils_isString(val){return"string"==typeof val}function axios_gmxhr_adapter_utils_isObject(val){return null!==val&&"object"==typeof val}function axios_gmxhr_adapter_utils_trim(str){return str.replace(/^\s*/,"").replace(/\s*$/,"")}function isStandardBrowserEnv(){return"undefined"!=typeof window&&"undefined"!=typeof document&&"function"==typeof document.createElement}function utils_forEach(obj,fn){if(null!=obj)if("object"==typeof obj||utils_isArray(obj)||(obj=[obj]),utils_isArray(obj))for(var i=0,l=obj.length;i<l;i++)fn.call(null,obj[i],i,obj);else for(var key in obj)obj.hasOwnProperty(key)&&fn.call(null,obj[key],key,obj)}function createError(message,config,code,response){return function(error,config,code,response){return error.config=config,code&&(error.code=code),error.response=response,error}(new Error(message),config,code,response)}function helpers_buildURL_encode(val){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL_buildURL(url,params,paramsSerializer){if(!params)return url;var serializedParams,val;if(paramsSerializer)serializedParams=paramsSerializer(params);else if(val=params,"undefined"!=typeof URLSearchParams&&val instanceof URLSearchParams)serializedParams=params.toString();else{var parts=[];utils_forEach(params,(function(val,key){null!=val&&(utils_isArray(val)&&(key+="[]"),utils_isArray(val)||(val=[val]),utils_forEach(val,(function(v){!function(val){return"[object Date]"===axios_gmxhr_adapter_utils_toString.call(val)}(v)?axios_gmxhr_adapter_utils_isObject(v)&&(v=JSON.stringify(v)):v=v.toISOString(),parts.push(helpers_buildURL_encode(key)+"="+helpers_buildURL_encode(v))})))})),serializedParams=parts.join("&")}return serializedParams&&(url+=(-1===url.indexOf("?")?"?":"&")+serializedParams),url}const helpers_cookies=isStandardBrowserEnv()?{write:function(name,value,expires,path,domain,secure){var cookie=[];cookie.push(name+"="+encodeURIComponent(value)),"number"==typeof expires&&cookie.push("expires="+new Date(expires).toGMTString()),utils_isString(path)&&cookie.push("path="+path),utils_isString(domain)&&cookie.push("domain="+domain),!0===secure&&cookie.push("secure"),document.cookie=cookie.join("; ")},read:function(name){var match=document.cookie.match(new RegExp("(^|;\\s*)("+name+")=([^;]*)"));return match?decodeURIComponent(match[3]):null},remove:function(name){this.write(name,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};const helpers_isURLSameOrigin=isStandardBrowserEnv()?function(){var originURL,msie=/(msie|trident)/i.test(navigator.userAgent),urlParsingNode=document.createElement("a");function resolveURL(url){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}return originURL=resolveURL(window.location.href),function(requestURL){var parsed=utils_isString(requestURL)?resolveURL(requestURL):requestURL;return parsed.protocol===originURL.protocol&&parsed.host===originURL.host}}():function(){return!0};function E(){this.message="String contains an invalid character"}E.prototype=new Error,E.prototype.code=5,E.prototype.name="InvalidCharacterError";const helpers_btoa=function(input){for(var block,charCode,str=String(input),output="",idx=0,map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";str.charAt(0|idx)||(map="=",idx%1);output+=map.charAt(63&block>>8-idx%1*8)){if((charCode=str.charCodeAt(idx+=3/4))>255)throw new E;block=block<<8|charCode}return output},adapter_btoa=void 0!==typeof window&&window.btoa&&window.btoa.bind(window)||helpers_btoa;function axiosGmXhrAdapter(config){return new Promise((function(resolve,reject){var val,requestData=config.data,requestHeaders=config.headers;val=requestData,"undefined"!=typeof FormData&&val instanceof FormData&&delete requestHeaders["Content-Type"];var request=new tampermonkey_gmxhr,loadEvent="onreadystatechange",xDomain=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in request||helpers_isURLSameOrigin(config.url)||(request=new window.XDomainRequest,loadEvent="onload",xDomain=!0,request.onprogress=function(){},request.ontimeout=function(){}),config.auth){var username=config.auth.username||"",password=config.auth.password||"";requestHeaders.Authorization="Basic "+adapter_btoa(username+":"+password)}if(request.open(config.method.toUpperCase(),buildURL_buildURL(config.url,config.params,config.paramsSerializer),!0),request.timeout=config.timeout,request[loadEvent]=function(){if(request&&(4===request.readyState||xDomain)&&(0!==request.status||request.responseURL&&0===request.responseURL.indexOf("file:"))){var responseHeaders="getAllResponseHeaders"in request?function(headers){var key,val,i,parsed={};return headers?(utils_forEach(headers.split("\n"),(function(line){i=line.indexOf(":"),key=axios_gmxhr_adapter_utils_trim(line.substr(0,i)).toLowerCase(),val=axios_gmxhr_adapter_utils_trim(line.substr(i+1)),key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)})),parsed):parsed}(request.getAllResponseHeaders()):null,response={data:config.responseType&&"text"!==config.responseType?request.response:request.responseText,status:1223===request.status?204:request.status,statusText:1223===request.status?"No Content":request.statusText,headers:responseHeaders,config,request};!function(resolve,reject,response){var validateStatus=response.config.validateStatus;response.status&&validateStatus&&!validateStatus(response.status)?reject(createError("Request failed with status code "+response.status,response.config,null,response)):resolve(response)}(resolve,reject,response),request=null}},request.onerror=function(){reject(createError("Network Error",config)),request=null},request.ontimeout=function(){reject(createError("timeout of "+config.timeout+"ms exceeded",config,"ECONNABORTED")),request=null},isStandardBrowserEnv()){var xsrfValue=(config.withCredentials||helpers_isURLSameOrigin(config.url))&&config.xsrfCookieName?helpers_cookies.read(config.xsrfCookieName):void 0;xsrfValue&&(requestHeaders[config.xsrfHeaderName]=xsrfValue)}if("setRequestHeader"in request&&utils_forEach(requestHeaders,(function(val,key){void 0===requestData&&"content-type"===key.toLowerCase()?delete requestHeaders[key]:request.setRequestHeader(key,val)})),config.withCredentials&&(request.withCredentials=!0),config.responseType)try{request.responseType=config.responseType}catch(e){if("json"!==request.responseType)throw e}"function"==typeof config.onDownloadProgress&&request.addEventListener("progress",config.onDownloadProgress),"function"==typeof config.onUploadProgress&&request.upload&&request.upload.addEventListener("progress",config.onUploadProgress),config.cancelToken&&config.cancelToken.promise.then((function(cancel){request&&(request.abort(),reject(cancel),request=null)})),void 0===requestData&&(requestData=null),request.send(requestData)}))}function isJsonFile(file){const extension=(file??"").split(".").pop();return"json"===extension?.toLocaleLowerCase()}function strings_mergeDeep(targetObj,sourceObj){const target=targetObj??{},source=sourceObj??{};return Object.keys(source).forEach((key=>{var value;(value=source[key])&&"object"==typeof value&&!Array.isArray(value)?target[key]=key in target?strings_mergeDeep(target[key],source[key]):source[key]:target[key]=source[key]})),target}class OtaClient{static BASE_URL="https://distributions.crowdin.net";disableManifestCache=!1;stringsCache={};disableStringsCache=!1;disableJsonDeepMerge=!1;constructor(distributionHash,config){this.distributionHash=distributionHash,this.httpClient=config?.httpClient||function(){const crowdinAxiosClient=lib_axios.create();return{get:async url=>(await crowdinAxiosClient.get(url)).data}}(),this.disableManifestCache=!!config?.disableManifestCache,this.locale=config?.languageCode,this.disableStringsCache=!!config?.disableStringsCache,this.disableJsonDeepMerge=!!config?.disableJsonDeepMerge}getHash(){return this.distributionHash}setCurrentLocale(languageCode){this.locale=languageCode}getCurrentLocale(){return this.locale}async getManifestTimestamp(){return(await this.manifest).timestamp}async getContent(){return(await this.manifest).content}async getLanguageContent(languageCode){const language=this.getLanguageCode(languageCode);return(await this.getContent())[language]}async listLanguages(){return Object.keys(await this.getContent())}async getTranslations(){const languages=await this.listLanguages(),translations={};return await Promise.all(languages.map((async language=>{translations[language]=await this.getLanguageTranslations(language)}))),translations}async getLanguageTranslations(languageCode){const language=this.getLanguageCode(languageCode),files=(await this.getContent())[language]||[];return Promise.all(files.map((async file=>({content:await this.getFileTranslations(file),file}))))}async getFileTranslations(file){const content=await this.getContent();if(!Object.values(content).some((files=>files.includes(file))))throw new Error(`File ${file} does not exists in manifest content`);const timestamp=await this.getManifestTimestamp(),url=`${OtaClient.BASE_URL}/${this.distributionHash}${file}?timestamp=${timestamp}`;return this.httpClient.get(url).catch((()=>null))}async getStrings(){const content=await this.getJsonFiles(),res={};return await Promise.all(Object.entries(content).map((async([lang,files])=>{res[lang]=await this.getStringsByFilesAndLocale(files)}))),res}async getStringsByLocale(languageCode){const language=this.getLanguageCode(languageCode),content=await this.getJsonFiles();return this.getStringsByFilesAndLocale(content[language]||[])}async getStringByKey(key,languageCode){const strings=await this.getStringsByLocale(languageCode),path=Array.isArray(key)?key:[key],firstKey=path.shift();if(!firstKey)return;let res=strings[firstKey];for(const keyPart of path)res=res?.[keyPart];return res}clearStringsCache(){this.stringsCache={}}async getStringsByFilesAndLocale(files){let strings={};for(const filePath of files){let content;this.stringsCache[filePath]||this.disableStringsCache||(this.stringsCache[filePath]=this.getFileTranslations(filePath)),content=await this.stringsCache[filePath],this.disableJsonDeepMerge?strings={...strings,...content}:strings_mergeDeep(strings,content)}return strings}get manifest(){return this.manifestHolder&&!this.disableManifestCache||(this.manifestHolder=this.httpClient.get(`${OtaClient.BASE_URL}/${this.distributionHash}/manifest.json`).then((manifest=>(manifest.language_mapping&&Object.keys(manifest.language_mapping).forEach((crowdinLangCode=>{const mapping=manifest.language_mapping[crowdinLangCode];mapping.hasOwnProperty("locale")&&manifest.content.hasOwnProperty(crowdinLangCode)&&(manifest.content[mapping.locale]=manifest.content[crowdinLangCode],delete manifest.content[crowdinLangCode])})),manifest)))),this.manifestHolder}getLanguageCode(lang){const languageCode=lang||this.getCurrentLocale();if(languageCode)return languageCode;throw new Error('Language code should be either provided through input arguments or by "setCurrentLocale" method')}async getJsonFiles(){const content=await this.getContent(),res={};return Object.entries(content).forEach((([lang,files])=>res[lang]=files.filter(isJsonFile))),res}}async function bootstrap(){lib_axios.defaults.adapter=axiosGmXhrAdapter;const currentLocale=(0,get_wme_window.B)().I18n.currentLocale(),translations=await new OtaClient("d1b4fd3a44adaf1825a0668031c").getStringsByLocale(currentLocale);migratePreferencesFromRoundaboutJB(),external_window_ReactDOM_unsafeWindow_ReactDOM_default().render(React.createElement(App,{translations:{[currentLocale]:translations}}),document.createElement("div"))}},334:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function getWazeMapEditorWindow(){return"unsafeWindow"in window?window.unsafeWindow:window}__webpack_require__.d(__webpack_exports__,{B:()=>getWazeMapEditorWindow})},271:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var RBush=__webpack_require__(777),Queue=__webpack_require__(734),pointInPolygon=__webpack_require__(693),orient=__webpack_require__(985).orient2d;function concaveman(points,concavity,lengthThreshold){concavity=Math.max(0,void 0===concavity?2:concavity),lengthThreshold=lengthThreshold||0;var hull=function(points){for(var left=points[0],top=points[0],right=points[0],bottom=points[0],i=0;i<points.length;i++){var p=points[i];p[0]<left[0]&&(left=p),p[0]>right[0]&&(right=p),p[1]<top[1]&&(top=p),p[1]>bottom[1]&&(bottom=p)}var cull=[left,top,right,bottom],filtered=cull.slice();for(i=0;i<points.length;i++)pointInPolygon(points[i],cull)||filtered.push(points[i]);return function(points){points.sort(compareByX);for(var lower=[],i=0;i<points.length;i++){for(;lower.length>=2&&cross(lower[lower.length-2],lower[lower.length-1],points[i])<=0;)lower.pop();lower.push(points[i])}for(var upper=[],ii=points.length-1;ii>=0;ii--){for(;upper.length>=2&&cross(upper[upper.length-2],upper[upper.length-1],points[ii])<=0;)upper.pop();upper.push(points[ii])}return upper.pop(),lower.pop(),lower.concat(upper)}(filtered)}(points),tree=new RBush(16);tree.toBBox=function(a){return{minX:a[0],minY:a[1],maxX:a[0],maxY:a[1]}},tree.compareMinX=function(a,b){return a[0]-b[0]},tree.compareMinY=function(a,b){return a[1]-b[1]},tree.load(points);for(var last,queue=[],i=0;i<hull.length;i++){var p=hull[i];tree.remove(p),last=insertNode(p,last),queue.push(last)}var segTree=new RBush(16);for(i=0;i<queue.length;i++)segTree.insert(updateBBox(queue[i]));for(var sqConcavity=concavity*concavity,sqLenThreshold=lengthThreshold*lengthThreshold;queue.length;){var node=queue.shift(),a=node.p,b=node.next.p,sqLen=getSqDist(a,b);if(!(sqLen<sqLenThreshold)){var maxSqLen=sqLen/sqConcavity;(p=findCandidate(tree,node.prev.p,a,b,node.next.next.p,maxSqLen,segTree))&&Math.min(getSqDist(p,a),getSqDist(p,b))<=maxSqLen&&(queue.push(node),queue.push(insertNode(p,node)),tree.remove(p),segTree.remove(node),segTree.insert(updateBBox(node)),segTree.insert(updateBBox(node.next)))}}node=last;var concave=[];do{concave.push(node.p),node=node.next}while(node!==last);return concave.push(node.p),concave}function findCandidate(tree,a,b,c,d,maxDist,segTree){for(var queue=new Queue([],compareDist),node=tree.data;node;){for(var i=0;i<node.children.length;i++){var child=node.children[i],dist=node.leaf?sqSegDist(child,b,c):sqSegBoxDist(b,c,child);dist>maxDist||queue.push({node:child,dist})}for(;queue.length&&!queue.peek().node.children;){var item=queue.pop(),p=item.node,d0=sqSegDist(p,a,b),d1=sqSegDist(p,c,d);if(item.dist<d0&&item.dist<d1&&noIntersections(b,p,segTree)&&noIntersections(c,p,segTree))return p}(node=queue.pop())&&(node=node.node)}return null}function compareDist(a,b){return a.dist-b.dist}function sqSegBoxDist(a,b,bbox){if(inside(a,bbox)||inside(b,bbox))return 0;var d1=sqSegSegDist(a[0],a[1],b[0],b[1],bbox.minX,bbox.minY,bbox.maxX,bbox.minY);if(0===d1)return 0;var d2=sqSegSegDist(a[0],a[1],b[0],b[1],bbox.minX,bbox.minY,bbox.minX,bbox.maxY);if(0===d2)return 0;var d3=sqSegSegDist(a[0],a[1],b[0],b[1],bbox.maxX,bbox.minY,bbox.maxX,bbox.maxY);if(0===d3)return 0;var d4=sqSegSegDist(a[0],a[1],b[0],b[1],bbox.minX,bbox.maxY,bbox.maxX,bbox.maxY);return 0===d4?0:Math.min(d1,d2,d3,d4)}function inside(a,bbox){return a[0]>=bbox.minX&&a[0]<=bbox.maxX&&a[1]>=bbox.minY&&a[1]<=bbox.maxY}function noIntersections(a,b,segTree){for(var p1,q1,p2,q2,minX=Math.min(a[0],b[0]),minY=Math.min(a[1],b[1]),maxX=Math.max(a[0],b[0]),maxY=Math.max(a[1],b[1]),edges=segTree.search({minX,minY,maxX,maxY}),i=0;i<edges.length;i++)if(p1=edges[i].p,q1=edges[i].next.p,p2=a,p1!==(q2=b)&&q1!==p2&&cross(p1,q1,p2)>0!=cross(p1,q1,q2)>0&&cross(p2,q2,p1)>0!=cross(p2,q2,q1)>0)return!1;return!0}function cross(p1,p2,p3){return orient(p1[0],p1[1],p2[0],p2[1],p3[0],p3[1])}function updateBBox(node){var p1=node.p,p2=node.next.p;return node.minX=Math.min(p1[0],p2[0]),node.minY=Math.min(p1[1],p2[1]),node.maxX=Math.max(p1[0],p2[0]),node.maxY=Math.max(p1[1],p2[1]),node}function insertNode(p,prev){var node={p,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return prev?(node.next=prev.next,node.prev=prev,prev.next.prev=node,prev.next=node):(node.prev=node,node.next=node),node}function getSqDist(p1,p2){var dx=p1[0]-p2[0],dy=p1[1]-p2[1];return dx*dx+dy*dy}function sqSegDist(p,p1,p2){var x=p1[0],y=p1[1],dx=p2[0]-x,dy=p2[1]-y;if(0!==dx||0!==dy){var t=((p[0]-x)*dx+(p[1]-y)*dy)/(dx*dx+dy*dy);t>1?(x=p2[0],y=p2[1]):t>0&&(x+=dx*t,y+=dy*t)}return(dx=p[0]-x)*dx+(dy=p[1]-y)*dy}function sqSegSegDist(x0,y0,x1,y1,x2,y2,x3,y3){var sc,sN,tc,tN,ux=x1-x0,uy=y1-y0,vx=x3-x2,vy=y3-y2,wx=x0-x2,wy=y0-y2,a=ux*ux+uy*uy,b=ux*vx+uy*vy,c=vx*vx+vy*vy,d=ux*wx+uy*wy,e=vx*wx+vy*wy,D=a*c-b*b,sD=D,tD=D;0===D?(sN=0,sD=1,tN=e,tD=c):(tN=a*e-b*d,(sN=b*e-c*d)<0?(sN=0,tN=e,tD=c):sN>sD&&(sN=sD,tN=e+b,tD=c)),tN<0?(tN=0,-d<0?sN=0:-d>a?sN=sD:(sN=-d,sD=a)):tN>tD&&(tN=tD,-d+b<0?sN=0:-d+b>a?sN=sD:(sN=-d+b,sD=a));var dx=(1-(tc=0===tN?0:tN/tD))*x2+tc*x3-((1-(sc=0===sN?0:sN/sD))*x0+sc*x1),dy=(1-tc)*y2+tc*y3-((1-sc)*y0+sc*y1);return dx*dx+dy*dy}function compareByX(a,b){return a[0]===b[0]?a[1]-b[1]:a[0]-b[0]}Queue.default&&(Queue=Queue.default),module.exports=concaveman,module.exports.default=concaveman},889:(module,__unused_webpack_exports,__webpack_require__)=>{var NAN=NaN,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal="object"==typeof __webpack_require__.g&&__webpack_require__.g&&__webpack_require__.g.Object===Object&&__webpack_require__.g,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectToString=Object.prototype.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root.Date.now()};function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function toNumber(value){if("number"==typeof value)return value;if(function(value){return"symbol"==typeof value||function(value){return!!value&&"object"==typeof value}(value)&&objectToString.call(value)==symbolTag}(value))return NAN;if(isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=value.replace(reTrim,"");var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NAN:+value}module.exports=function(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=void 0,lastInvokeTime=time,result=func.apply(thisArg,args)}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return void 0===lastCallTime||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&time-lastInvokeTime>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function(time){var result=wait-(time-lastCallTime);return maxing?nativeMin(result,maxWait-(time-lastInvokeTime)):result}(time))}function trailingEdge(time){return timerId=void 0,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=void 0,result)}function debounced(){var time=now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(void 0===timerId)return function(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}(lastCallTime);if(maxing)return timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return void 0===timerId&&(timerId=setTimeout(timerExpired,wait)),result}return wait=toNumber(wait)||0,isObject(options)&&(leading=!!options.leading,maxWait=(maxing="maxWait"in options)?nativeMax(toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function(){void 0!==timerId&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=void 0},debounced.flush=function(){return void 0===timerId?result:trailingEdge(now())},debounced}},130:module=>{module.exports=function(point,vs,start,end){var x=point[0],y=point[1],inside=!1;void 0===start&&(start=0),void 0===end&&(end=vs.length);for(var len=(end-start)/2,i=0,j=len-1;i<len;j=i++){var xi=vs[start+2*i+0],yi=vs[start+2*i+1],xj=vs[start+2*j+0],yj=vs[start+2*j+1];yi>y!=yj>y&&x<(xj-xi)*(y-yi)/(yj-yi)+xi&&(inside=!inside)}return inside}},693:(module,__unused_webpack_exports,__webpack_require__)=>{var pointInPolygonFlat=__webpack_require__(130),pointInPolygonNested=__webpack_require__(906);module.exports=function(point,vs,start,end){return vs.length>0&&Array.isArray(vs[0])?pointInPolygonNested(point,vs,start,end):pointInPolygonFlat(point,vs,start,end)},module.exports.nested=pointInPolygonNested,module.exports.flat=pointInPolygonFlat},906:module=>{module.exports=function(point,vs,start,end){var x=point[0],y=point[1],inside=!1;void 0===start&&(start=0),void 0===end&&(end=vs.length);for(var len=end-start,i=0,j=len-1;i<len;j=i++){var xi=vs[i+start][0],yi=vs[i+start][1],xj=vs[j+start][0],yj=vs[j+start][1];yi>y!=yj>y&&x<(xj-xi)*(y-yi)/(yj-yi)+xi&&(inside=!inside)}return inside}},777:function(module){module.exports=function(){"use strict";function t(t,r,e,a,h){!function t(n,r,e,a,h){for(;a>e;){if(a-e>600){var o=a-e+1,s=r-e+1,l=Math.log(o),f=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*f*(o-f)/o)*(s-o/2<0?-1:1);t(n,r,Math.max(e,Math.floor(r-s*f/o+u)),Math.min(a,Math.floor(r+(o-s)*f/o+u)),h)}var p=n[r],d=e,x=a;for(i(n,e,r),h(n[a],p)>0&&i(n,e,a);d<x;){for(i(n,d,x),d++,x--;h(n[d],p)<0;)d++;for(;h(n[x],p)>0;)x--}0===h(n[e],p)?i(n,e,x):i(n,++x,a),x<=r&&(e=x+1),r<=x&&(a=x-1)}}(t,r,e||0,a||t.length-1,h||n)}function i(t,i,n){var r=t[i];t[i]=t[n],t[n]=r}function n(t,i){return t<i?-1:t>i?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function e(t,i,n){if(!n)return i.indexOf(t);for(var r=0;r<i.length;r++)if(n(t,i[r]))return r;return-1}function a(t,i){h(t,0,t.children.length,i,t)}function h(t,i,n,r,e){e||(e=p(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var a=i;a<n;a++){var h=t.children[a];o(e,t.leaf?r(h):h)}return e}function o(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function s(t,i){return t.minX-i.minX}function l(t,i){return t.minY-i.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function m(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function c(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,n,r,e,a){for(var h=[n,r];h.length;)if(!((r=h.pop())-(n=h.pop())<=e)){var o=n+Math.ceil((r-n)/e/2)*e;t(i,o,n,r,a),h.push(n,o,o,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var i=this.data,n=[];if(!c(t,i))return n;for(var r=this.toBBox,e=[];i;){for(var a=0;a<i.children.length;a++){var h=i.children[a],o=i.leaf?r(h):h;c(t,o)&&(i.leaf?n.push(h):m(t,o)?this._all(h,n):e.push(h))}i=e.pop()}return n},r.prototype.collides=function(t){var i=this.data;if(!c(t,i))return!1;for(var n=[];i;){for(var r=0;r<i.children.length;r++){var e=i.children[r],a=i.leaf?this.toBBox(e):e;if(c(t,a)){if(i.leaf||m(t,a))return!0;n.push(e)}}i=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0;i<t.length;i++)this.insert(t[i]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=p([]),this},r.prototype.remove=function(t,i){if(!t)return this;for(var n,r,a,h=this.data,o=this.toBBox(t),s=[],l=[];h||s.length;){if(h||(h=s.pop(),r=s[s.length-1],n=l.pop(),a=!0),h.leaf){var f=e(t,h.children,i);if(-1!==f)return h.children.splice(f,1),s.push(h),this._condense(s),this}a||h.leaf||!m(h,o)?r?(n++,h=r.children[n],a=!1):h=null:(s.push(h),l.push(n),n=0,r=h,h=h.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,i){return t.minX-i.minX},r.prototype.compareMinY=function(t,i){return t.minY-i.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},r.prototype._build=function(t,i,n,r){var e,h=n-i+1,o=this._maxEntries;if(h<=o)return a(e=p(t.slice(i,n+1)),this.toBBox),e;r||(r=Math.ceil(Math.log(h)/Math.log(o)),o=Math.ceil(h/Math.pow(o,r-1))),(e=p([])).leaf=!1,e.height=r;var s=Math.ceil(h/o),l=s*Math.ceil(Math.sqrt(o));d(t,i,n,l,this.compareMinX);for(var f=i;f<=n;f+=l){var u=Math.min(f+l-1,n);d(t,f,u,s,this.compareMinY);for(var m=f;m<=u;m+=s){var c=Math.min(m+s-1,u);e.children.push(this._build(t,m,c,r-1))}}return a(e,this.toBBox),e},r.prototype._chooseSubtree=function(t,i,n,r){for(;r.push(i),!i.leaf&&r.length-1!==n;){for(var e=1/0,a=1/0,h=void 0,o=0;o<i.children.length;o++){var s=i.children[o],l=f(s),u=(m=t,c=s,(Math.max(c.maxX,m.maxX)-Math.min(c.minX,m.minX))*(Math.max(c.maxY,m.maxY)-Math.min(c.minY,m.minY))-l);u<a?(a=u,e=l<e?l:e,h=s):u===a&&l<e&&(e=l,h=s)}i=h||i.children[0]}var m,c;return i},r.prototype._insert=function(t,i,n){var r=n?t:this.toBBox(t),e=[],a=this._chooseSubtree(r,this.data,i,e);for(a.children.push(t),o(a,r);i>=0&&e[i].children.length>this._maxEntries;)this._split(e,i),i--;this._adjustParentBBoxes(r,e,i)},r.prototype._split=function(t,i){var n=t[i],r=n.children.length,e=this._minEntries;this._chooseSplitAxis(n,e,r);var h=this._chooseSplitIndex(n,e,r),o=p(n.children.splice(h,n.children.length-h));o.height=n.height,o.leaf=n.leaf,a(n,this.toBBox),a(o,this.toBBox),i?t[i-1].children.push(o):this._splitRoot(n,o)},r.prototype._splitRoot=function(t,i){this.data=p([t,i]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,i,n){for(var r,e,a,o,s,l,u,m=1/0,c=1/0,p=i;p<=n-i;p++){var d=h(t,0,p,this.toBBox),x=h(t,p,n,this.toBBox),v=(e=d,a=x,o=void 0,s=void 0,l=void 0,u=void 0,o=Math.max(e.minX,a.minX),s=Math.max(e.minY,a.minY),l=Math.min(e.maxX,a.maxX),u=Math.min(e.maxY,a.maxY),Math.max(0,l-o)*Math.max(0,u-s)),M=f(d)+f(x);v<m?(m=v,r=p,c=M<c?M:c):v===m&&M<c&&(c=M,r=p)}return r||n-i},r.prototype._chooseSplitAxis=function(t,i,n){var r=t.leaf?this.compareMinX:s,e=t.leaf?this.compareMinY:l;this._allDistMargin(t,i,n,r)<this._allDistMargin(t,i,n,e)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,i,n,r){t.children.sort(r);for(var e=this.toBBox,a=h(t,0,i,e),s=h(t,n-i,n,e),l=u(a)+u(s),f=i;f<n-i;f++){var m=t.children[f];o(a,t.leaf?e(m):m),l+=u(a)}for(var c=n-i-1;c>=i;c--){var p=t.children[c];o(s,t.leaf?e(p):p),l+=u(s)}return l},r.prototype._adjustParentBBoxes=function(t,i,n){for(var r=n;r>=0;r--)o(i[r],t)},r.prototype._condense=function(t){for(var i=t.length-1,n=void 0;i>=0;i--)0===t[i].children.length?i>0?(n=t[i-1].children).splice(n.indexOf(t[i]),1):this.clear():a(t[i],this.toBBox)},r}()},34:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var f=__webpack_require__(149),k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function q(c,a,g){var b,d={},e=null,h=null;for(b in void 0!==g&&(e=""+g),void 0!==a.key&&(e=""+a.key),void 0!==a.ref&&(h=a.ref),a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l,exports.jsx=q,exports.jsxs=q},274:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__(34)},985:function(__unused_webpack_module,exports){!function(t){"use strict";const e=134217729,n=33306690738754706e-32;function r(t,e,n,r,o){let f,i,u,c,s=e[0],a=r[0],d=0,l=0;a>s==a>-s?(f=s,s=e[++d]):(f=a,a=r[++l]);let p=0;if(d<t&&l<n)for(a>s==a>-s?(u=f-((i=s+f)-s),s=e[++d]):(u=f-((i=a+f)-a),a=r[++l]),f=i,0!==u&&(o[p++]=u);d<t&&l<n;)a>s==a>-s?(u=f-((i=f+s)-(c=i-f))+(s-c),s=e[++d]):(u=f-((i=f+a)-(c=i-f))+(a-c),a=r[++l]),f=i,0!==u&&(o[p++]=u);for(;d<t;)u=f-((i=f+s)-(c=i-f))+(s-c),s=e[++d],f=i,0!==u&&(o[p++]=u);for(;l<n;)u=f-((i=f+a)-(c=i-f))+(a-c),a=r[++l],f=i,0!==u&&(o[p++]=u);return 0===f&&0!==p||(o[p++]=f),p}function o(t){return new Float64Array(t)}const f=33306690738754716e-32,i=22204460492503146e-32,u=11093356479670487e-47,c=o(4),s=o(8),a=o(12),d=o(16),l=o(4);t.orient2d=function(t,o,p,b,y,h){const M=(o-h)*(p-y),x=(t-y)*(b-h),j=M-x;if(0===M||0===x||M>0!=x>0)return j;const m=Math.abs(M+x);return Math.abs(j)>=f*m?j:-function(t,o,f,p,b,y,h){let M,x,j,m,_,v,w,A,F,O,P,g,k,q,z,B,C,D;const E=t-b,G=f-b,H=o-y,I=p-y;_=(z=(A=E-(w=(v=e*E)-(v-E)))*(O=I-(F=(v=e*I)-(v-I)))-((q=E*I)-w*F-A*F-w*O))-(P=z-(C=(A=H-(w=(v=e*H)-(v-H)))*(O=G-(F=(v=e*G)-(v-G)))-((B=H*G)-w*F-A*F-w*O))),c[0]=z-(P+_)+(_-C),_=(k=q-((g=q+P)-(_=g-q))+(P-_))-(P=k-B),c[1]=k-(P+_)+(_-B),_=(D=g+P)-g,c[2]=g-(D-_)+(P-_),c[3]=D;let J=function(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}(4,c),K=i*h;if(J>=K||-J>=K)return J;if(M=t-(E+(_=t-E))+(_-b),j=f-(G+(_=f-G))+(_-b),x=o-(H+(_=o-H))+(_-y),m=p-(I+(_=p-I))+(_-y),0===M&&0===x&&0===j&&0===m)return J;if(K=u*h+n*Math.abs(J),(J+=E*m+I*M-(H*j+G*x))>=K||-J>=K)return J;_=(z=(A=M-(w=(v=e*M)-(v-M)))*(O=I-(F=(v=e*I)-(v-I)))-((q=M*I)-w*F-A*F-w*O))-(P=z-(C=(A=x-(w=(v=e*x)-(v-x)))*(O=G-(F=(v=e*G)-(v-G)))-((B=x*G)-w*F-A*F-w*O))),l[0]=z-(P+_)+(_-C),_=(k=q-((g=q+P)-(_=g-q))+(P-_))-(P=k-B),l[1]=k-(P+_)+(_-B),_=(D=g+P)-g,l[2]=g-(D-_)+(P-_),l[3]=D;const L=r(4,c,4,l,s);_=(z=(A=E-(w=(v=e*E)-(v-E)))*(O=m-(F=(v=e*m)-(v-m)))-((q=E*m)-w*F-A*F-w*O))-(P=z-(C=(A=H-(w=(v=e*H)-(v-H)))*(O=j-(F=(v=e*j)-(v-j)))-((B=H*j)-w*F-A*F-w*O))),l[0]=z-(P+_)+(_-C),_=(k=q-((g=q+P)-(_=g-q))+(P-_))-(P=k-B),l[1]=k-(P+_)+(_-B),_=(D=g+P)-g,l[2]=g-(D-_)+(P-_),l[3]=D;const N=r(L,s,4,l,a);_=(z=(A=M-(w=(v=e*M)-(v-M)))*(O=m-(F=(v=e*m)-(v-m)))-((q=M*m)-w*F-A*F-w*O))-(P=z-(C=(A=x-(w=(v=e*x)-(v-x)))*(O=j-(F=(v=e*j)-(v-j)))-((B=x*j)-w*F-A*F-w*O))),l[0]=z-(P+_)+(_-C),_=(k=q-((g=q+P)-(_=g-q))+(P-_))-(P=k-B),l[1]=k-(P+_)+(_-B),_=(D=g+P)-g,l[2]=g-(D-_)+(P-_),l[3]=D;const Q=r(N,a,4,l,d);return d[Q-1]}(t,o,p,b,y,h,m)},t.orient2dfast=function(t,e,n,r,o,f){return(e-f)*(n-o)-(t-o)*(r-f)},Object.defineProperty(t,"__esModule",{value:!0})}(exports)},734:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>TinyQueue});class TinyQueue{constructor(data=[],compare=defaultCompare){if(this.data=data,this.length=this.data.length,this.compare=compare,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(item){this.data.push(item),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const top=this.data[0],bottom=this.data.pop();return this.length--,this.length>0&&(this.data[0]=bottom,this._down(0)),top}peek(){return this.data[0]}_up(pos){const{data,compare}=this,item=data[pos];for(;pos>0;){const parent=pos-1>>1,current=data[parent];if(compare(item,current)>=0)break;data[pos]=current,pos=parent}data[pos]=item}_down(pos){const{data,compare}=this,halfLength=this.length>>1,item=data[pos];for(;pos<halfLength;){let left=1+(pos<<1),best=data[left];const right=left+1;if(right<this.length&&compare(data[right],best)<0&&(left=right,best=data[right]),compare(best,item)>=0)break;data[pos]=best,pos=left}data[pos]=item}}function defaultCompare(a,b){return a<b?-1:a>b?1:0}},149:module=>{"use strict";module.exports=window.React||unsafeWindow.React},783:(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var Reflect;!function(Reflect){!function(factory){var root="object"==typeof globalThis?globalThis:"object"==typeof __webpack_require__.g?__webpack_require__.g:"object"==typeof self?self:"object"==typeof this?this:function(){try{return Function("return this;")()}catch(_){}}()||function(){try{return(0,eval)("(function() { return this; })()")}catch(_){}}(),exporter=makeExporter(Reflect);function makeExporter(target,previous){return function(key,value){Object.defineProperty(target,key,{configurable:!0,writable:!0,value}),previous&&previous(key,value)}}void 0!==root.Reflect&&(exporter=makeExporter(root.Reflect,exporter)),function(exporter,root){var hasOwn=Object.prototype.hasOwnProperty,supportsSymbol="function"==typeof Symbol,toPrimitiveSymbol=supportsSymbol&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",iteratorSymbol=supportsSymbol&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",supportsCreate="function"==typeof Object.create,supportsProto={__proto__:[]}instanceof Array,downLevel=!supportsCreate&&!supportsProto,HashMap={create:supportsCreate?function(){return MakeDictionary(Object.create(null))}:supportsProto?function(){return MakeDictionary({__proto__:null})}:function(){return MakeDictionary({})},has:downLevel?function(map,key){return hasOwn.call(map,key)}:function(map,key){return key in map},get:downLevel?function(map,key){return hasOwn.call(map,key)?map[key]:void 0}:function(map,key){return map[key]}},functionPrototype=Object.getPrototypeOf(Function),_Map="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:CreateMapPolyfill(),_Set="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:CreateSetPolyfill(),_WeakMap="function"==typeof WeakMap?WeakMap:CreateWeakMapPolyfill(),registrySymbol=supportsSymbol?Symbol.for("@reflect-metadata:registry"):void 0,metadataRegistry=GetOrCreateMetadataRegistry(),metadataProvider=CreateMetadataProvider(metadataRegistry);function decorate(decorators,target,propertyKey,attributes){if(IsUndefined(propertyKey)){if(!IsArray(decorators))throw new TypeError;if(!IsConstructor(target))throw new TypeError;return DecorateConstructor(decorators,target)}if(!IsArray(decorators))throw new TypeError;if(!IsObject(target))throw new TypeError;if(!IsObject(attributes)&&!IsUndefined(attributes)&&!IsNull(attributes))throw new TypeError;return IsNull(attributes)&&(attributes=void 0),DecorateProperty(decorators,target,propertyKey=ToPropertyKey(propertyKey),attributes)}function metadata(metadataKey,metadataValue){function decorator(target,propertyKey){if(!IsObject(target))throw new TypeError;if(!IsUndefined(propertyKey)&&!IsPropertyKey(propertyKey))throw new TypeError;OrdinaryDefineOwnMetadata(metadataKey,metadataValue,target,propertyKey)}return decorator}function defineMetadata(metadataKey,metadataValue,target,propertyKey){if(!IsObject(target))throw new TypeError;return IsUndefined(propertyKey)||(propertyKey=ToPropertyKey(propertyKey)),OrdinaryDefineOwnMetadata(metadataKey,metadataValue,target,propertyKey)}function hasMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;return IsUndefined(propertyKey)||(propertyKey=ToPropertyKey(propertyKey)),OrdinaryHasMetadata(metadataKey,target,propertyKey)}function hasOwnMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;return IsUndefined(propertyKey)||(propertyKey=ToPropertyKey(propertyKey)),OrdinaryHasOwnMetadata(metadataKey,target,propertyKey)}function getMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;return IsUndefined(propertyKey)||(propertyKey=ToPropertyKey(propertyKey)),OrdinaryGetMetadata(metadataKey,target,propertyKey)}function getOwnMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;return IsUndefined(propertyKey)||(propertyKey=ToPropertyKey(propertyKey)),OrdinaryGetOwnMetadata(metadataKey,target,propertyKey)}function getMetadataKeys(target,propertyKey){if(!IsObject(target))throw new TypeError;return IsUndefined(propertyKey)||(propertyKey=ToPropertyKey(propertyKey)),OrdinaryMetadataKeys(target,propertyKey)}function getOwnMetadataKeys(target,propertyKey){if(!IsObject(target))throw new TypeError;return IsUndefined(propertyKey)||(propertyKey=ToPropertyKey(propertyKey)),OrdinaryOwnMetadataKeys(target,propertyKey)}function deleteMetadata(metadataKey,target,propertyKey){if(!IsObject(target))throw new TypeError;if(IsUndefined(propertyKey)||(propertyKey=ToPropertyKey(propertyKey)),!IsObject(target))throw new TypeError;IsUndefined(propertyKey)||(propertyKey=ToPropertyKey(propertyKey));var provider=GetMetadataProvider(target,propertyKey,!1);return!IsUndefined(provider)&&provider.OrdinaryDeleteMetadata(metadataKey,target,propertyKey)}function DecorateConstructor(decorators,target){for(var i=decorators.length-1;i>=0;--i){var decorated=(0,decorators[i])(target);if(!IsUndefined(decorated)&&!IsNull(decorated)){if(!IsConstructor(decorated))throw new TypeError;target=decorated}}return target}function DecorateProperty(decorators,target,propertyKey,descriptor){for(var i=decorators.length-1;i>=0;--i){var decorated=(0,decorators[i])(target,propertyKey,descriptor);if(!IsUndefined(decorated)&&!IsNull(decorated)){if(!IsObject(decorated))throw new TypeError;descriptor=decorated}}return descriptor}function OrdinaryHasMetadata(MetadataKey,O,P){if(OrdinaryHasOwnMetadata(MetadataKey,O,P))return!0;var parent=OrdinaryGetPrototypeOf(O);return!IsNull(parent)&&OrdinaryHasMetadata(MetadataKey,parent,P)}function OrdinaryHasOwnMetadata(MetadataKey,O,P){var provider=GetMetadataProvider(O,P,!1);return!IsUndefined(provider)&&ToBoolean(provider.OrdinaryHasOwnMetadata(MetadataKey,O,P))}function OrdinaryGetMetadata(MetadataKey,O,P){if(OrdinaryHasOwnMetadata(MetadataKey,O,P))return OrdinaryGetOwnMetadata(MetadataKey,O,P);var parent=OrdinaryGetPrototypeOf(O);return IsNull(parent)?void 0:OrdinaryGetMetadata(MetadataKey,parent,P)}function OrdinaryGetOwnMetadata(MetadataKey,O,P){var provider=GetMetadataProvider(O,P,!1);if(!IsUndefined(provider))return provider.OrdinaryGetOwnMetadata(MetadataKey,O,P)}function OrdinaryDefineOwnMetadata(MetadataKey,MetadataValue,O,P){GetMetadataProvider(O,P,!0).OrdinaryDefineOwnMetadata(MetadataKey,MetadataValue,O,P)}function OrdinaryMetadataKeys(O,P){var ownKeys=OrdinaryOwnMetadataKeys(O,P),parent=OrdinaryGetPrototypeOf(O);if(null===parent)return ownKeys;var parentKeys=OrdinaryMetadataKeys(parent,P);if(parentKeys.length<=0)return ownKeys;if(ownKeys.length<=0)return parentKeys;for(var set=new _Set,keys=[],_i=0,ownKeys_1=ownKeys;_i<ownKeys_1.length;_i++){var key=ownKeys_1[_i];set.has(key)||(set.add(key),keys.push(key))}for(var _a=0,parentKeys_1=parentKeys;_a<parentKeys_1.length;_a++){key=parentKeys_1[_a];set.has(key)||(set.add(key),keys.push(key))}return keys}function OrdinaryOwnMetadataKeys(O,P){var provider=GetMetadataProvider(O,P,!1);return provider?provider.OrdinaryOwnMetadataKeys(O,P):[]}function Type(x){if(null===x)return 1;switch(typeof x){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===x?1:6;default:return 6}}function IsUndefined(x){return void 0===x}function IsNull(x){return null===x}function IsSymbol(x){return"symbol"==typeof x}function IsObject(x){return"object"==typeof x?null!==x:"function"==typeof x}function ToPrimitive(input,PreferredType){switch(Type(input)){case 0:case 1:case 2:case 3:case 4:case 5:return input}var hint=3===PreferredType?"string":5===PreferredType?"number":"default",exoticToPrim=GetMethod(input,toPrimitiveSymbol);if(void 0!==exoticToPrim){var result=exoticToPrim.call(input,hint);if(IsObject(result))throw new TypeError;return result}return OrdinaryToPrimitive(input,"default"===hint?"number":hint)}function OrdinaryToPrimitive(O,hint){if("string"===hint){var toString_1=O.toString;if(IsCallable(toString_1))if(!IsObject(result=toString_1.call(O)))return result;if(IsCallable(valueOf=O.valueOf))if(!IsObject(result=valueOf.call(O)))return result}else{var valueOf;if(IsCallable(valueOf=O.valueOf))if(!IsObject(result=valueOf.call(O)))return result;var result,toString_2=O.toString;if(IsCallable(toString_2))if(!IsObject(result=toString_2.call(O)))return result}throw new TypeError}function ToBoolean(argument){return!!argument}function ToString(argument){return""+argument}function ToPropertyKey(argument){var key=ToPrimitive(argument,3);return IsSymbol(key)?key:ToString(key)}function IsArray(argument){return Array.isArray?Array.isArray(argument):argument instanceof Object?argument instanceof Array:"[object Array]"===Object.prototype.toString.call(argument)}function IsCallable(argument){return"function"==typeof argument}function IsConstructor(argument){return"function"==typeof argument}function IsPropertyKey(argument){switch(Type(argument)){case 3:case 4:return!0;default:return!1}}function SameValueZero(x,y){return x===y||x!=x&&y!=y}function GetMethod(V,P){var func=V[P];if(null!=func){if(!IsCallable(func))throw new TypeError;return func}}function GetIterator(obj){var method=GetMethod(obj,iteratorSymbol);if(!IsCallable(method))throw new TypeError;var iterator=method.call(obj);if(!IsObject(iterator))throw new TypeError;return iterator}function IteratorValue(iterResult){return iterResult.value}function IteratorStep(iterator){var result=iterator.next();return!result.done&&result}function IteratorClose(iterator){var f=iterator.return;f&&f.call(iterator)}function OrdinaryGetPrototypeOf(O){var proto=Object.getPrototypeOf(O);if("function"!=typeof O||O===functionPrototype)return proto;if(proto!==functionPrototype)return proto;var prototype=O.prototype,prototypeProto=prototype&&Object.getPrototypeOf(prototype);if(null==prototypeProto||prototypeProto===Object.prototype)return proto;var constructor=prototypeProto.constructor;return"function"!=typeof constructor||constructor===O?proto:constructor}function CreateMetadataRegistry(){var fallback,first,second,rest;IsUndefined(registrySymbol)||void 0===root.Reflect||registrySymbol in root.Reflect||"function"!=typeof root.Reflect.defineMetadata||(fallback=CreateFallbackProvider(root.Reflect));var targetProviderMap=new _WeakMap,registry={registerProvider,getProvider,setProvider};return registry;function registerProvider(provider){if(!Object.isExtensible(registry))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case fallback===provider:break;case IsUndefined(first):first=provider;break;case first===provider:break;case IsUndefined(second):second=provider;break;case second===provider:break;default:void 0===rest&&(rest=new _Set),rest.add(provider)}}function getProviderNoCache(O,P){if(!IsUndefined(first)){if(first.isProviderFor(O,P))return first;if(!IsUndefined(second)){if(second.isProviderFor(O,P))return first;if(!IsUndefined(rest))for(var iterator=GetIterator(rest);;){var next=IteratorStep(iterator);if(!next)return;var provider=IteratorValue(next);if(provider.isProviderFor(O,P))return IteratorClose(iterator),provider}}}if(!IsUndefined(fallback)&&fallback.isProviderFor(O,P))return fallback}function getProvider(O,P){var provider,providerMap=targetProviderMap.get(O);return IsUndefined(providerMap)||(provider=providerMap.get(P)),IsUndefined(provider)?(IsUndefined(provider=getProviderNoCache(O,P))||(IsUndefined(providerMap)&&(providerMap=new _Map,targetProviderMap.set(O,providerMap)),providerMap.set(P,provider)),provider):provider}function hasProvider(provider){if(IsUndefined(provider))throw new TypeError;return first===provider||second===provider||!IsUndefined(rest)&&rest.has(provider)}function setProvider(O,P,provider){if(!hasProvider(provider))throw new Error("Metadata provider not registered.");var existingProvider=getProvider(O,P);if(existingProvider!==provider){if(!IsUndefined(existingProvider))return!1;var providerMap=targetProviderMap.get(O);IsUndefined(providerMap)&&(providerMap=new _Map,targetProviderMap.set(O,providerMap)),providerMap.set(P,provider)}return!0}}function GetOrCreateMetadataRegistry(){var metadataRegistry;return!IsUndefined(registrySymbol)&&IsObject(root.Reflect)&&Object.isExtensible(root.Reflect)&&(metadataRegistry=root.Reflect[registrySymbol]),IsUndefined(metadataRegistry)&&(metadataRegistry=CreateMetadataRegistry()),!IsUndefined(registrySymbol)&&IsObject(root.Reflect)&&Object.isExtensible(root.Reflect)&&Object.defineProperty(root.Reflect,registrySymbol,{enumerable:!1,configurable:!1,writable:!1,value:metadataRegistry}),metadataRegistry}function CreateMetadataProvider(registry){var metadata=new _WeakMap,provider={isProviderFor:function(O,P){var targetMetadata=metadata.get(O);return!IsUndefined(targetMetadata)&&targetMetadata.has(P)},OrdinaryDefineOwnMetadata,OrdinaryHasOwnMetadata,OrdinaryGetOwnMetadata,OrdinaryOwnMetadataKeys,OrdinaryDeleteMetadata};return metadataRegistry.registerProvider(provider),provider;function GetOrCreateMetadataMap(O,P,Create){var targetMetadata=metadata.get(O),createdTargetMetadata=!1;if(IsUndefined(targetMetadata)){if(!Create)return;targetMetadata=new _Map,metadata.set(O,targetMetadata),createdTargetMetadata=!0}var metadataMap=targetMetadata.get(P);if(IsUndefined(metadataMap)){if(!Create)return;if(metadataMap=new _Map,targetMetadata.set(P,metadataMap),!registry.setProvider(O,P,provider))throw targetMetadata.delete(P),createdTargetMetadata&&metadata.delete(O),new Error("Wrong provider for target.")}return metadataMap}function OrdinaryHasOwnMetadata(MetadataKey,O,P){var metadataMap=GetOrCreateMetadataMap(O,P,!1);return!IsUndefined(metadataMap)&&ToBoolean(metadataMap.has(MetadataKey))}function OrdinaryGetOwnMetadata(MetadataKey,O,P){var metadataMap=GetOrCreateMetadataMap(O,P,!1);if(!IsUndefined(metadataMap))return metadataMap.get(MetadataKey)}function OrdinaryDefineOwnMetadata(MetadataKey,MetadataValue,O,P){GetOrCreateMetadataMap(O,P,!0).set(MetadataKey,MetadataValue)}function OrdinaryOwnMetadataKeys(O,P){var keys=[],metadataMap=GetOrCreateMetadataMap(O,P,!1);if(IsUndefined(metadataMap))return keys;for(var iterator=GetIterator(metadataMap.keys()),k=0;;){var next=IteratorStep(iterator);if(!next)return keys.length=k,keys;var nextValue=IteratorValue(next);try{keys[k]=nextValue}catch(e){try{IteratorClose(iterator)}finally{throw e}}k++}}function OrdinaryDeleteMetadata(MetadataKey,O,P){var metadataMap=GetOrCreateMetadataMap(O,P,!1);if(IsUndefined(metadataMap))return!1;if(!metadataMap.delete(MetadataKey))return!1;if(0===metadataMap.size){var targetMetadata=metadata.get(O);IsUndefined(targetMetadata)||(targetMetadata.delete(P),0===targetMetadata.size&&metadata.delete(targetMetadata))}return!0}}function CreateFallbackProvider(reflect){var defineMetadata=reflect.defineMetadata,hasOwnMetadata=reflect.hasOwnMetadata,getOwnMetadata=reflect.getOwnMetadata,getOwnMetadataKeys=reflect.getOwnMetadataKeys,deleteMetadata=reflect.deleteMetadata,metadataOwner=new _WeakMap;return{isProviderFor:function(O,P){var metadataPropertySet=metadataOwner.get(O);return!(IsUndefined(metadataPropertySet)||!metadataPropertySet.has(P))||!!getOwnMetadataKeys(O,P).length&&(IsUndefined(metadataPropertySet)&&(metadataPropertySet=new _Set,metadataOwner.set(O,metadataPropertySet)),metadataPropertySet.add(P),!0)},OrdinaryDefineOwnMetadata:defineMetadata,OrdinaryHasOwnMetadata:hasOwnMetadata,OrdinaryGetOwnMetadata:getOwnMetadata,OrdinaryOwnMetadataKeys:getOwnMetadataKeys,OrdinaryDeleteMetadata:deleteMetadata}}function GetMetadataProvider(O,P,Create){var registeredProvider=metadataRegistry.getProvider(O,P);if(!IsUndefined(registeredProvider))return registeredProvider;if(Create){if(metadataRegistry.setProvider(O,P,metadataProvider))return metadataProvider;throw new Error("Illegal state.")}}function CreateMapPolyfill(){var cacheSentinel={},arraySentinel=[],MapIterator=function(){function MapIterator(keys,values,selector){this._index=0,this._keys=keys,this._values=values,this._selector=selector}return MapIterator.prototype["@@iterator"]=function(){return this},MapIterator.prototype[iteratorSymbol]=function(){return this},MapIterator.prototype.next=function(){var index=this._index;if(index>=0&&index<this._keys.length){var result=this._selector(this._keys[index],this._values[index]);return index+1>=this._keys.length?(this._index=-1,this._keys=arraySentinel,this._values=arraySentinel):this._index++,{value:result,done:!1}}return{value:void 0,done:!0}},MapIterator.prototype.throw=function(error){throw this._index>=0&&(this._index=-1,this._keys=arraySentinel,this._values=arraySentinel),error},MapIterator.prototype.return=function(value){return this._index>=0&&(this._index=-1,this._keys=arraySentinel,this._values=arraySentinel),{value,done:!0}},MapIterator}();return function(){function Map(){this._keys=[],this._values=[],this._cacheKey=cacheSentinel,this._cacheIndex=-2}return Object.defineProperty(Map.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Map.prototype.has=function(key){return this._find(key,!1)>=0},Map.prototype.get=function(key){var index=this._find(key,!1);return index>=0?this._values[index]:void 0},Map.prototype.set=function(key,value){var index=this._find(key,!0);return this._values[index]=value,this},Map.prototype.delete=function(key){var index=this._find(key,!1);if(index>=0){for(var size=this._keys.length,i=index+1;i<size;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,SameValueZero(key,this._cacheKey)&&(this._cacheKey=cacheSentinel,this._cacheIndex=-2),!0}return!1},Map.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=cacheSentinel,this._cacheIndex=-2},Map.prototype.keys=function(){return new MapIterator(this._keys,this._values,getKey)},Map.prototype.values=function(){return new MapIterator(this._keys,this._values,getValue)},Map.prototype.entries=function(){return new MapIterator(this._keys,this._values,getEntry)},Map.prototype["@@iterator"]=function(){return this.entries()},Map.prototype[iteratorSymbol]=function(){return this.entries()},Map.prototype._find=function(key,insert){if(!SameValueZero(this._cacheKey,key)){this._cacheIndex=-1;for(var i=0;i<this._keys.length;i++)if(SameValueZero(this._keys[i],key)){this._cacheIndex=i;break}}return this._cacheIndex<0&&insert&&(this._cacheIndex=this._keys.length,this._keys.push(key),this._values.push(void 0)),this._cacheIndex},Map}();function getKey(key,_){return key}function getValue(_,value){return value}function getEntry(key,value){return[key,value]}}function CreateSetPolyfill(){return function(){function Set(){this._map=new _Map}return Object.defineProperty(Set.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Set.prototype.has=function(value){return this._map.has(value)},Set.prototype.add=function(value){return this._map.set(value,value),this},Set.prototype.delete=function(value){return this._map.delete(value)},Set.prototype.clear=function(){this._map.clear()},Set.prototype.keys=function(){return this._map.keys()},Set.prototype.values=function(){return this._map.keys()},Set.prototype.entries=function(){return this._map.entries()},Set.prototype["@@iterator"]=function(){return this.keys()},Set.prototype[iteratorSymbol]=function(){return this.keys()},Set}()}function CreateWeakMapPolyfill(){var UUID_SIZE=16,keys=HashMap.create(),rootKey=CreateUniqueKey();return function(){function WeakMap(){this._key=CreateUniqueKey()}return WeakMap.prototype.has=function(target){var table=GetOrCreateWeakMapTable(target,!1);return void 0!==table&&HashMap.has(table,this._key)},WeakMap.prototype.get=function(target){var table=GetOrCreateWeakMapTable(target,!1);return void 0!==table?HashMap.get(table,this._key):void 0},WeakMap.prototype.set=function(target,value){return GetOrCreateWeakMapTable(target,!0)[this._key]=value,this},WeakMap.prototype.delete=function(target){var table=GetOrCreateWeakMapTable(target,!1);return void 0!==table&&delete table[this._key]},WeakMap.prototype.clear=function(){this._key=CreateUniqueKey()},WeakMap}();function CreateUniqueKey(){var key;do{key="@@WeakMap@@"+CreateUUID()}while(HashMap.has(keys,key));return keys[key]=!0,key}function GetOrCreateWeakMapTable(target,create){if(!hasOwn.call(target,rootKey)){if(!create)return;Object.defineProperty(target,rootKey,{value:HashMap.create()})}return target[rootKey]}function FillRandomBytes(buffer,size){for(var i=0;i<size;++i)buffer[i]=255*Math.random()|0;return buffer}function GenRandomBytes(size){if("function"==typeof Uint8Array){var array=new Uint8Array(size);return"undefined"!=typeof crypto?crypto.getRandomValues(array):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(array):FillRandomBytes(array,size),array}return FillRandomBytes(new Array(size),size)}function CreateUUID(){var data=GenRandomBytes(UUID_SIZE);data[6]=79&data[6]|64,data[8]=191&data[8]|128;for(var result="",offset=0;offset<UUID_SIZE;++offset){var byte=data[offset];4!==offset&&6!==offset&&8!==offset||(result+="-"),byte<16&&(result+="0"),result+=byte.toString(16).toLowerCase()}return result}}function MakeDictionary(obj){return obj.__=void 0,delete obj.__,obj}exporter("decorate",decorate),exporter("metadata",metadata),exporter("defineMetadata",defineMetadata),exporter("hasMetadata",hasMetadata),exporter("hasOwnMetadata",hasOwnMetadata),exporter("getMetadata",getMetadata),exporter("getOwnMetadata",getOwnMetadata),exporter("getMetadataKeys",getMetadataKeys),exporter("getOwnMetadataKeys",getOwnMetadataKeys),exporter("deleteMetadata",deleteMetadata)}(exporter,root),void 0===root.Reflect&&(root.Reflect=Reflect)}()}(Reflect||(Reflect={}))}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.exports}webpackQueues="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",webpackExports="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",webpackError="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",resolveQueue=queue=>{queue&&queue.d<1&&(queue.d=1,queue.forEach((fn=>fn.r--)),queue.forEach((fn=>fn.r--?fn.r++:fn())))},__webpack_require__.a=(module,body,hasAwait)=>{var queue;hasAwait&&((queue=[]).d=-1);var currentDeps,outerResolve,reject,depQueues=new Set,exports=module.exports,promise=new Promise(((resolve,rej)=>{reject=rej,outerResolve=resolve}));promise[webpackExports]=exports,promise[webpackQueues]=fn=>(queue&&fn(queue),depQueues.forEach(fn),promise.catch((x=>{}))),module.exports=promise,body((deps=>{var fn;currentDeps=(deps=>deps.map((dep=>{if(null!==dep&&"object"==typeof dep){if(dep[webpackQueues])return dep;if(dep.then){var queue=[];queue.d=0,dep.then((r=>{obj[webpackExports]=r,resolveQueue(queue)}),(e=>{obj[webpackError]=e,resolveQueue(queue)}));var obj={};return obj[webpackQueues]=fn=>fn(queue),obj}}var ret={};return ret[webpackQueues]=x=>{},ret[webpackExports]=dep,ret})))(deps);var getResult=()=>currentDeps.map((d=>{if(d[webpackError])throw d[webpackError];return d[webpackExports]})),promise=new Promise((resolve=>{(fn=()=>resolve(getResult)).r=0;var fnQueue=q=>q!==queue&&!depQueues.has(q)&&(depQueues.add(q),q&&!q.d&&(fn.r++,q.push(fn)));currentDeps.map((dep=>dep[webpackQueues](fnQueue)))}));return fn.r?promise:getResult()}),(err=>(err?reject(promise[webpackError]=err):outerResolve(exports),resolveQueue(queue)))),queue&&queue.d<0&&(queue.d=0)},__webpack_require__.n=module=>{var getter=module&&module.__esModule?()=>module.default:()=>module;return __webpack_require__.d(getter,{a:getter}),getter},__webpack_require__.d=(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop),__webpack_require__.r=exports=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})};__webpack_require__(73)})();
