this.WS=this.WS||{},this.WS.SDKHooks=this.WS.SDKHooks||{},this.WS.SDKHooks.permanentHazardsHook=function(){var t;!function(t){t[t.SpeedBump=1]="SpeedBump",t[t.Topes=2]="Topes",t[t.TollBooth=3]="TollBooth",t[t.DangerousCurve=4]="DangerousCurve",t[t.DangerousIntersection=5]="DangerousIntersection",t[t.DangerousMerge=7]="DangerousMerge",t[t.PedestrianCrossing=8]="PedestrianCrossing",t[t.SchoolZone=9]="SchoolZone"}(t||(t={}));class n{constructor(t,n,e){this.t=t,this.o=n,this.i=e,this.u=!1,this.h=this.l()}l(){if(this.u)return this.h;const t=this.t[this.o];if("function"!=typeof t)throw new Error("Unable to refresh the original function, type of property is incompatible ("+typeof t+")");return t}p(){if(!this.u)return;const t=this.t[this.o];if("function"!=typeof t)throw new Error("Unable to restore original function, type of property is incompatible ("+typeof t+")");this.t[this.o]=this.h}enable(){this.u||(this.h=this.l(),this.t[this.o]=this.m.bind(this),this.u=!0)}disable(){this.u&&(this.p(),this.u=!1)}get isEnabled(){return this.u}_(...t){return this.h.apply(this.t,t)}A(...t){return this.i.apply(this.t,t)}}class e extends n{constructor(t,n,e){super(t,n,e)}static P(t){return t===e.CONTINUE_EXECUTION}static O(t){return!!Array.isArray(t)&&this.P(t[0])}m(...t){const n=this.A(...t);if(!e.O(n)&&!e.P(n))return n;if(e.O(n)){const[,...t]=n;return this._(...t)}return this._(...t)}}function r(){return"unsafeWindow"in window?window.unsafeWindow:window}e.CONTINUE_EXECUTION=Symbol("__CONTINUE_EXECUTION__");const o=new Map;function i(){const t=function(t){const n=Object.keys(t);for(let e=0;e<n.length;e++){const r=n[e];if(r.startsWith("__reactFiber$"))return t[r].return}return null}(function(){const t=document.getElementById("drawer").querySelector("[class^=menu] wz-menu-item:has(wz-icon[name=school-zone])");if(!t)throw new Error("DrawSchoolZone menu item is not found");return t}());if(!t)throw new Error("DrawBigJunction menu-item fiber is not available");return t}function s(t,n){return function(t,n){return"object"==typeof t&&t.hasOwnProperty("current")&&n(t.current)}(t,n)?[!0,t.current]:function(t,n){return Array.isArray(t)&&2===t.length&&Array.isArray(t[1])&&n(t[0])}(t,n)?[!0,t[0]]:n(t)?[!0,t]:[!1,null]}function c(t){let n=t.memoizedState;for(;n;){const t=n.memoizedState,[e,r]=s(t,(t=>"object"==typeof t&&t.__proto__.hasOwnProperty("CLASS_NAME")&&"Waze.Control.DrawFeature"===t.__proto__.CLASS_NAME&&"function"==typeof t.drawCallback));if(e)return r;n=n.next}return null}new e(r(),"fetch",(t=>{const n=function(t){const n=new URL(t);return n.search="",n.toString()}(function(t){if(t instanceof URL)return t;const n="string"==typeof t?t:t.url;return new URL(n,location.toString())}(t));if(o.has(n)){const t=o.get(n);return o.delete(n),Promise.resolve(t)}return e.CONTINUE_EXECUTION}));const u=[function(){const t=function(t,n){for(;t;){if(n(t))return t;t=t.return}return null}(i(),(t=>!!c(t)));if(!t)throw new Error("DrawSchoolZone HOC fiber is not available");return c(t).drawCallback}];function a(t){const n=function(t){return{getGeometry:()=>t}}(t);(function(){for(const t of u)try{return t()}catch(t){}throw new Error("Neither of the provided getters was able to resolve to a BigJunction drawCallback")})()(n)}r().require("Waze/Action/UpdateObject").__proto__,r().require("Waze/Action/CreateObject");const h=r().require("Waze/Action/MultiAction");function f(t){return function(t){const n=[],o=new e(r().W.model.actionManager,"add",(t=>{n.push(t)}));return o.enable(),t(),o.disable(),n}((()=>{a(t)})).find((t=>function(t){return"ADD_PERMANENT_HAZARD"===t.actionName}(t)))}h.Base=h.__proto__,r().require("Waze/Action/UpdateObject");let l=null,d=null;function w(){if(l&&d)return{PermanentHazard:l,AddPermanentHazard:d};const t=f(function(t,n,e={}){for(const n of t){if(n.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(n[n.length-1].length!==n[0].length)throw new Error("First and last Position are not equivalent.");for(let t=0;t<n[n.length-1].length;t++)if(n[n.length-1][t]!==n[0][t])throw new Error("First and last Position are not equivalent.")}return function(t,n,e={}){const r={type:"Feature"};return(0===e.id||e.id)&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.properties={},r.geometry=t,r}({type:"Polygon",coordinates:t},0,e)}([[[0,0],[0,1],[1,1],[1,0],[0,0]]]).geometry);return d=t.constructor,l=t.object.constructor,{PermanentHazard:l,AddPermanentHazard:d}}class p{constructor(t,n,e){this.v=new Map,this.S=t,this.H=n,this.k=Object.assign(Object.assign({},p.defaultOptions),e)}C(t){const n=this.S.split(".");n.pop();let e=t;for(const t of n)e=e[t];return Object.getPrototypeOf(e)||e}install(t){var n;const e=this.C(t),r=this.S.split(".").pop(),o=e[r];(null===(n=this.k)||void 0===n?void 0:n.onlyIfNotExists)&&o||(e[r]=this.H,this.v.set(t,o))}uninstall(t){const n=this.C(t),e=this.S.split(".").pop(),r=this.v.get(t);r&&(n[e]=r)}}p.defaultOptions={onlyIfNotExists:!0};const m=new class{constructor(){this.D=[],this.j=[]}F(t){return this.j.some((n=>n.sdk===t))}N(t){this.F(t)||(this.D.forEach((n=>n.install(t))),this.j.push({sdk:t,hooks:this.D}))}R(t){const n=this.j.find((n=>n.sdk===t));n&&n.hooks.forEach((n=>n.uninstall(t)))}U(t){this.D.push(t)}M(t){const n=this.D.indexOf(t);-1!==n&&this.D.splice(n,1)}};return m.U(new p("DataModel.PermanentHazards.addSchoolZone",(function(n){return async function(t,n=r().W.model){const{PermanentHazard:e,AddPermanentHazard:o}=w(),i=new o(new e(t),n.permanentHazards);n.actionManager.add(i)}({geoJSONGeometry:n.geometry,type:t.SchoolZone,name:n.name,speedLimit:n.speedLimit,excludedRoadTypes:n.excludedRoadTypes})}))),function(t){m.N(t)}}();
